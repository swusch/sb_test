#Estate Privilege on_action effects are in 01_scripted_effects_for_estates.txt

anb_initialize_schools_effect = { #Used in on_startup on_action
	if = {
		limit = { NOT = { has_global_flag = anb_schools_initiated } }
		set_global_flag = anb_schools_initiated
		#Unbroken Claw vs Radiant Sun
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = unbroken_claw_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = radiant_sun_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = radiant_sun_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = unbroken_claw_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Radiant Sun vs Starry Eye
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = radiant_sun_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = starry_eye_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = starry_eye_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = radiant_sun_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Orange Sash vs Radiant Sun
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = orange_sash_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = radiant_sun_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = radiant_sun_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = orange_sash_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Golden Palace vs Silk Turban
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = golden_palace_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = silk_turban_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = silk_turban_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = golden_palace_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Orange Sash vs Silk Turban
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = orange_sash_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = silk_turban_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = silk_turban_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = orange_sash_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Ascendant Soul vs Silk Turban
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = ascendant_soul_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = silk_turban_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = silk_turban_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = ascendant_soul_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Ascendant Soul vs Golden Palace
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = ascendant_soul_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = golden_palace_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = golden_palace_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = ascendant_soul_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Ascendant Soul vs Starry Eye
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = ascendant_soul_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = starry_eye_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = raheni
					school = starry_eye_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = raheni
						school = ascendant_soul_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
		
		#Lizardfolk Religion
		
		#Sculptors of Being vs Sculptors of Fate
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = fate_sculptors_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = being_sculptors_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = being_sculptors_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = fate_sculptors_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Sculptors of Fate vs Blade and Needle
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = fate_sculptors_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = blade_and_needle_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = blade_and_needle_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = fate_sculptors_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Sculptors of Fate vs Great Cycle
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = fate_sculptors_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = great_cycle_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = great_cycle_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = fate_sculptors_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Sculptors of Fate vs Humble Zeal
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = humble_zeal_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = fate_sculptors_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = fate_sculptors_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = humble_zeal_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Sculptors of Fate vs Soul-Song
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = fate_sculptors_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = soul_song_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = soul_song_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = fate_sculptors_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Sculptors of Being vs Blade and Needle
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = being_sculptors_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = blade_and_needle_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = blade_and_needle_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = being_sculptors_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Sculptors of Being vs Great Cycle
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = being_sculptors_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = great_cycle_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = great_cycle_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = being_sculptors_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Sculptors of Being vs Humble Zeal
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = humble_zeal_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = being_sculptors_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = being_sculptors_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = humble_zeal_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Sculptors of Being vs Soul-Song
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = being_sculptors_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = soul_song_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		random_country = { 
			limit = {
				religious_school = {
					group = lizardfolk_religion
					school = soul_song_school
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = lizardfolk_religion
						school = being_sculptors_school
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Demons of the Sorrow VS Demonic Shamans
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = demons_of_the_sorrow_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = demonic_shamans_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
		#Demons of the Sorrow VS Umbral Bargains
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = demons_of_the_sorrow_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = umbral_bargains_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Monstrous Pedigrees VS Demons of the Sorrow
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = monstrous_pedigrees_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = demons_of_the_sorrow_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
		#Monstrous Pedigrees VS Kult of the Packmother
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = monstrous_pedigrees_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = kult_of_the_packmother_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Children of Goxma VS Demonic Shamans
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = children_of_goxma_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = demonic_shamans_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
		#Children of Goxma VS Way of Bones
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = children_of_goxma_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = way_of_bones_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Kult of the Packmother VS Way of Iron
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = kult_of_the_packmother_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = way_of_iron_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
		#Kult of the Packmother VS Demonic Shamans
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = kult_of_the_packmother_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = demonic_shamans_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Kult of the Packmother VS Monstrous Pedigrees
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = kult_of_the_packmother_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = monstrous_pedigrees_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Demonic Shamans VS Umbral Bargains
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = demonic_shamans_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = umbral_bargains_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
		#Demonic Shamans VS Demons of the Sorrow
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = demonic_shamans_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = demons_of_the_sorrow_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
		#Demonic Shamans VS Children of Goxma
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = demonic_shamans_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = children_of_goxma_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
		#Demonic Shamans VS Way of Iron
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = demonic_shamans_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = way_of_iron_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Demonic Shamans VS Umbral Bargains
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = demonic_shamans_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = kult_of_the_packmother_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Umbral Bargains VS Demonic Shamans
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = umbral_bargains_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = demonic_shamans_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
		#Umbral Bargains VS Way of Iron
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = umbral_bargains_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = way_of_iron_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Umbral Bargains VS Demons of the Sorrow
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = umbral_bargains_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = demons_of_the_sorrow_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Way of Iron VS Kult of the Packmother
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = way_of_iron_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = kult_of_the_packmother_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
		#Way of Iron VS Way of Bones
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = way_of_iron_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = way_of_bones_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
		#Way of Iron VS Demonic Shamans
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = way_of_iron_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = demonic_shamans_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Way of Iron VS Umbral Bargains
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = way_of_iron_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = umbral_bargains_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
		#Way of Bones VS Way of Iron
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = way_of_bones_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = way_of_iron_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = 1
				}
			}
		}
		#Way of Bones VS Children of Goxma
		random_country = { 
			limit = {
				religious_school = {
					group = gnollish
					school = way_of_bones_tradition
				}
			}
			random_country = {
				limit = {
					religious_school = {
						group = gnollish
						school = children_of_goxma_tradition
					}
				}
				set_school_opinion = {
					who = PREV
					opinion = -1
				}
			}
		}
	}
}

on_new_monarch_effect = { #1.35
	if = {
		limit = {
			has_consort_regency = no
			any_owned_province = {
				has_province_modifier = domain_of_spouses_family
			}
		}
		every_owned_province = {
			limit = { has_province_modifier = domain_of_spouses_family }
			remove_province_modifier = domain_of_spouses_family
		}
	}
	if = {
		limit = {
			has_consort_regency = no
			any_owned_province = {
				has_province_modifier = home_of_consort
			}
		}
		every_owned_province = {
			limit = { has_province_modifier = home_of_consort }
			remove_province_modifier = home_of_consort
		}
	}
	if = {
		limit = { has_any_heir_cult_active = yes }
		remove_heir_cult = yes
	}
	#if = {
	#	limit = { 
	#		has_government_attribute = kalmar_union_succession
	#		has_regency = no
	#		has_consort_regency = no
	#	}
	#	if = {
	#		limit = { has_country_flag = dan_new_elected_ruler }
	#		clr_country_flag = dan_new_elected_ruler
	#	}
	#	else = {
	#		country_event = {
	#			id = kalmar_union_events.1	# A new king of the Kalmar Union
	#		}
	#	}
	#}
	if = {
		limit = { has_government_attribute = absolutism_reduction_on_ruler_death }
		add_absolutism = -60
	}
	if = {
		limit = {
			has_government_attribute = civil_war_on_every_new_ruler 
			NOT = { has_ruler_flag = civil_war_exempt } #Konstantinos
		}
		if = {
			limit = {
				NOT = { total_development = 100 }
			}
			capital_scope = {
				spawn_rebels = {
					type = pretender_rebels
					size = 1
				}
			}
		}
	}
	if = {
		limit = {
			has_government_attribute = theocratic_monarchy_mechanic
		}
		#Setting it to 0
		change_statists_vs_orangists = -10
		change_statists_vs_orangists = 1
		if = {
			limit = { has_ruler_flag = monarchistic_heir }
			change_statists_vs_orangists = 0.25
		}
		if = {
			limit = { has_ruler_flag = theocratic_heir }
			change_statists_vs_orangists = -0.25
		}
		if = {
			limit = {
				has_government_attribute = theocratic_monarchy_mechanic
			}
			country_event = {
				id = flavor_sca.2
			}
			country_event = {
				id = theocracy.1
				days = 3
			}
		}
	}
	if = {
		limit = {
			OR = {
				has_government_attribute = absolutism_reduction_on_ruler_death
				has_government_attribute = has_limited_terms
			}
		}
		set_variable = {
			which = election_term
			value = 1
		}
	}

	#ruler optimization
	update_ruler_racial_flag = yes

	country_event = { id = anb_ruler.102 days = 1 } # long lived ruler flag

	#Patrons On Succession
	if = {
		limit = {
			OR = {
				AND = { tag = Y26 NOT = { has_ruler_flag = is_holi } NOT = { has_ruler_flag = is_sado } }
				AND = { 
					mission_completed = Y26_the_dakini
					OR = {
						has_ruler_flag = is_holi
						has_ruler_flag = is_sado
					} 
				}
			}
			OR = { #Avoid patron trial the first time sado elected
				NOT = { has_country_flag = Y26_sado_elected_once }
				had_country_flag = {
					flag = Y26_sado_elected_once
					days = 5
				}
			}
		}
		country_event = { id = patrons_on_action.0 }
	}
	
	succession_culture_religion_effect = yes

	if = {
		limit = { is_year = 1445 }
		country_event = { id = great_conqueror.0 days = 35 }
	}
	if = {
		limit = { religion = the_jadd has_global_flag = the_jadd_is_the_true_faith NOT = { has_country_modifier = jaddari_the_true_faith } }
		add_country_modifier = {
			name = jaddari_the_true_faith
			duration = -1
		}
	}

	# Adenica new ruler pick chivalric virtue to follow
	if = {
		limit = {
			has_country_flag = formed_adenica_flag
			OR = {
				has_country_modifier = adenica_knight
				has_country_modifier = adenica_mortal_paragon
			}
		}
		country_event = {
			id = flavor_adenica.20
		}
	}

	if = {
		limit = {
			tag = G32
			OR = {
				has_reform = malacnar_monarchy
				has_reform = malacnar_monarchy_reformed
				has_reform = malacnar_republic_reform
			}
		}
		add_ruler_modifier = {	#Two years and a half
			name = g32_battleking_grace_period
			duration = 155
			hidden = yes
		}
		country_event = { id = flavor_malacnar.4 days = 1 }
	}

	# Y51 Bim Lau Entombment flags
	if = {
		limit = {
			owns_core_province = 4565
			controls = 4565
			OR = {
				tag = Y51
				capital_scope = { region = bomdan_region }
			}
			NOT = {
				OR = {
					adm = 2
					dip = 2
					mil = 2
				}
			}
			OR = {
				religion = high_philosophy
				religion = accretive_path
				religion = transmutative_path
				religion = devouring_path
				religion = mystic_accord
			}
			NOT = { has_country_flag = bim_lau_weak_spirit }
		}
		set_country_flag = bim_lau_weak_spirit
	}
	if = {
		limit = {
			owns_core_province = 4565
			controls = 4565
			OR = {
				tag = Y51
				capital_scope = { region = bomdan_region }
			}
			OR = {
				adm = 6
				dip = 6
				mil = 6
			}
			OR = {
				religion = high_philosophy
				religion = accretive_path
				religion = transmutative_path
				religion = devouring_path
				religion = mystic_accord
			}
			NOT = { has_country_flag = bim_lau_talented_spirit }
		}
		set_country_flag = bim_lau_talented_spirit
	}
	if = {
		limit = {
			owns_core_province = 4565
			controls = 4565
			OR = {
				tag = Y51
				capital_scope = { region = bomdan_region }
			}
			adm = 5
			dip = 5
			mil = 5
			OR = {
				religion = high_philosophy
				religion = accretive_path
				religion = transmutative_path
				religion = devouring_path
				religion = mystic_accord
			}
			NOT = { has_country_flag = bim_lau_exceptional_spirit }
		}
		set_country_flag = bim_lau_exceptional_spirit
	}

	country_event = { id = flavor_malacnar.4 days = 1 }

	#NSC effects
	refresh_nsc_incidents_ui = yes
	update_nsc_level_secondary_effects = yes
	if = { limit = { religion = bulwari_sun_cult }
		set_variable = { which = battlesWonBySunElfRuler value = 0 }
	}

	#Ynn Worship set deity
	if = {
		limit = {
			OR = {
				religion = ynn_river_worship
				religion = ynn_river_reformed
			}
		}
		country_event = { id = ynn_zodiac.3 }
		if = {
			limit = {
				has_regency = no
			}
			ruler_ynn_zodiac = yes
		}
	}

	#Ynn Worship Begga-style
	if = {
		limit = {
			tag = H45
			has_country_flag = beggaston_ynnic_syncretism
		}
		ruler_ynn_zodiac = yes
	}

	#Raj Vizier
	if = { limit = { is_subject_of_type = vizier_vassal }
		overlord = {
			set_country_flag = raj_vizier_just_died
			country_event = { id = rahenraj.2100 days = 1 }
		}
	}

	if = {
		limit = {
			ruler_is_harpy = yes
			is_female = no
		}
		define_ruler = {
			female = yes
		}
	}
	#event for Bianfang to change tyranny value based on new ruler's trait
	if = {
		limit = {
			OR = {
				tag = Y09
				AND = {
					tag = Z66
					was_tag = Y09
				}
			}
			has_regency = no
		}
		country_event = { id = bianfang.1000 days = 50 }
	}

	#Wesdam/Madelaire succession
	if = {
		limit = {
			tag = A04
			has_regency = no
			NOT = { has_country_flag = wesdam_succession_crisis }
			has_country_flag = wesdam_first_succession
		}
		clr_country_flag = wesdam_first_succession
		set_country_flag = wesdam_succession_crisis
		country_event = { id = flavor_wesdam.11 }
	}
	if = {
		limit = {
			tag = A04
			has_regency = no
			NOT = { has_country_flag = wesdam_succession_crisis }
		}
		set_country_flag = wesdam_first_succession
	}
	if = {
		limit = {
			tag = H85
			has_reform = truedagger_intrigue_court
		}
		country_event = {
			id = flavor_truedagger.11
		}
	}

	#ynnic iosahar mald about republics
	if = {
		limit = {
			culture_group = ynnic_ruinborn_elf
			government = republic
			ynnic_iosahar = 1
		}
		random_list = {
			2 = {
				country_event = {
					id = ynn_authority_events.301
					days = 5
					random = 5
				}
			}
			8 = {
				#nothing
			}
		}
	}
	
	#Spiritual Lapidary, Chien Binhrung 
	if = {
		limit = {
			OR = {
				tag = Y72
				was_tag = Y72
			}
			OR = {
				has_country_flag = chien_spirit_queens_1
				has_country_flag = chien_spirit_queens_2
				has_country_flag = chien_spirit_queens_3
				has_country_flag = chien_spirit_queens_4
			}
			has_regency = no			
		}
		country_event = { id = flavor_chien.12 days = 1 }
	}
	
	#Gotiriei Religious Aspects Wipe
	if = {
		limit = {
			religion = gotiriei
			has_regency = no			
		}
		country_event = { id = gotiriei_pilgrimage.15 days = 1 }
	}

	# Vels Fadhecai ruler death stuff
	if = {
		limit = {
			AND = {
				OR = {
					tag = G38
					was_tag = G38
				}
				NOT = {
					has_ruler_flag = vf_fatecutter_flg
				}
				has_country_flag = vf_mitrenya_in_power_flg
			}
		}
		country_event = { 
			id = flavour_velsfadhecai.98
			days = 1
		}
	}

	if = {  #taychendi.13
		limit = { 
			AND = {
				has_ruler_flag = had_birth_ceremony
				religion = gods_of_the_taychend_reformed
			}
		}	
		if = {
			limit = { has_ruler_flag = birth_ceremony_battlefield }
			add_ruler_modifier = {
				name = birth_ceremony_battlefield_mod
			}
		}
		else_if = {
			limit = { has_ruler_flag = birth_ceremony_field }
			add_ruler_modifier = {
				name = birth_ceremony_field_mod
			}
		}
		else_if = {
			limit = { has_ruler_flag = birth_ceremony_sea }
			add_ruler_modifier = {
				name = birth_ceremony_sea_mod
			}
		}
		else_if = {
			limit = { has_ruler_flag = birth_ceremony_palace }
			add_ruler_modifier = {
				name = birth_ceremony_palace_mod
			}
		}
	}

	#if = { #Fangaulan Pantheon
	#	limit = {
	#		religion = fangaulan_pantheon
	#		OR = {
	#			NOT = { government = republic }
	#			has_government_attribute = election_on_death
	#		}
	#	}
	#	country_event = { id = fangaulan_pantheon.1 }
	#}

	if = {
		limit = {
			OR = {
				AND = {
					tag = J72
					has_ruler_flag = gophira_heir
					G74 = { has_ruler_flag = gophira_heir }
				}
				AND = {
					tag = G74
					has_ruler_flag = gophira_heir
					J72 = { has_ruler_flag = gophira_heir }
				}
			}
		}
		G74 = { country_event = { id = gophira.9 } }
	}

	#Sri Baginda
	if = {
		limit = { 
			is_sri_baginda = yes
		}
		if = {
			limit = { ruler_total_stats = { stats = 9 } }
			add_sri_baginda_power = { value = 10 }
		}
		else_if = {
			limit = { NOT = { ruler_total_stats = { stats = 6 } } }
			add_sri_baginda_power = { value = -10 }
		}
	}

	#Pashaine
	if = {
		limit = {
			has_country_flag = unlocked_aegis_of_the_state_mod
			is_or_was_tag = { tag = B59 } #Pashaine
		}
		set_variable = {
			which = ruler_aegis_battle_count
			value = 0
		}
	}
	
	if = { #Parahechend
		limit = {
			dynasty = "Rakulacan"
			is_subject = yes
			overlord = { is_or_was_tag = { tag = J81 } } #Parahechend
		}
		if = {
			limit = {
				overlord = {
					mission_completed = J81_3_5_the_empire_of_blood
				}
			}
			add_ruler_modifier = {
				name = J81_rakulacan_tyranny
				duration = -1
			}
		}
		else_if = {
			limit = {
				overlord = {
					mission_completed = J81_2_2_keeping_it_in_the_family
				}
			}
			add_ruler_modifier = {
				name = J81_rakulacan_rule
				duration = -1
			}
		}
	}

	
	#celmaldor merc sponsors
	if = {
		limit = { OR = { tag = Z22 was_tag = Z22 } }
		if = {
			limit = { has_estate_privilege = z22_clan_levies_privilege }
			z22_check_merc_modifier = yes
		}
	}
	
	#Konolkhatep
	if = {
		limit = {
			is_subject_of_type = medasi_subject
			overlord = { tag = F66 }
			empire_of_china_reform_passed = medasi_disciples_horutep_reform
			ruler_is_not_powerful_mage = yes
		}
		define_powerful_mage = { type = ruler }
	}

	#Fangaula Pantheon
	if = {
		limit = { religion = fangaulan_pantheon }
		fangaulan_pantheon_apply_holy_site_bonus = yes 
	} 
}

anb_scripted_effects_for_ruler_death  = {
	#Gilly's Death Events(tm)
	#Death of Rogier
	if = {
		limit = {
			or = {
				tag = B07
				tag = B37
			}
			not = { has_ruler_flag = rogieria_rogier_alive }
		}
		country_event = { id = flavor_rogieria.30 days = 1 }
	}

	#Death of the Young Owl
	if = {
		limit = {
			tag = B37
			NOT = { has_ruler = "Rogier 'Young Owl'" }
			NOT = { has_ruler_flag = rogieria_young_owl_alive }
		}
		country_event = { id = flavor_rogieria.31 days = 1 }
	}

	#Jaddar death event
	if = {
		limit = {
			ai = no
			OR = {
				tag = F46
				was_tag = F46
			}
			NOT = { has_ruler_flag = is_jaddar }
		}
		country_event = { id = jaddari_missions.1002 days = 1 }
	}

	#Death of Uman
	if = {
		limit = {
			tag = F26
			AI = no
			OR = {
				has_ruler_flag = is_allaniwiya
				has_heir_flag = is_allaniwiya
			} 
			NOT = { has_ruler_flag = is_uman }
		}
		country_event = { id = flavour_gelkalis.27 days = 1 }
	}

	#Atlas Death Events
	#Death of Delian
	if = {
		limit = {
			tag = A77
			NOT = { has_ruler = "Delian" }
			has_country_flag = delian_tries
		}
		country_event = { id = flavor_orda_aldresia.12 days = 1 }
		clr_country_flag = delian_tries
	}

	#Death of Oberon
	if = {
		limit = {
			ai = no
			OR = {
				tag = I30
				was_tag = I30
			}
			NOT = { has_ruler_flag = oberon_is_ruling }
			has_country_flag = oberon_no_longer_immortal
		}
		country_event = { id = flavor_salla_fealgarn.26 days = 1 }
		clr_country_flag = oberon_no_longer_immortal
	}
	
	# If your guy dies during the whaling expedition
	if = {
		limit = { has_country_modifier = feiten_active_whaling_expedition }
		country_event = { id = flavor_feiten.7 }
	}

	# Vels Fadhecai ruler death stuff
	if = {
		limit = {
			AND = {
				OR = {
					tag = G38
					was_tag = G38
				}
				NOT = {
					has_ruler_flag = vf_celadil_flg 
				}
			}
		}
		country_event = { 
			id = flavour_velsfadhecai.5
			days = 1
		}
	}

	#Lorent Succesion Events
	if = {
		limit = {
			AND = {
				OR = {
					tag = B72
					tag = A01
				}
			}
			A01 = { has_ruler_flag = kylian_siloriel_flag }
			B72 = { has_ruler_flag = kylian_siloriel_flag }
		}
		A01 = {
			country_event = {
				id = flavor_lorent.16
				days = 1
			}
		}
	}
	if = {
		limit = {
			AND = {
				OR = { 
					tag = B68
					tag = A01
				}
			}
			A01 = { has_ruler_flag = ruben_siloriel_flag }
			B68 = { has_ruler_flag = ruben_siloriel_flag }
		}
		A01 = {
			country_event = {
				id = flavor_lorent.17
				days = 1
			}
		}
	}


	#Mother Akasik set deity
	if = {
		limit = { religion = mother_akasik }
		country_event = { id = mother_akasik.3 }
	}

	#Ynn Worship set deity
	if = {
		limit = {
			OR = {
				religion = ynn_river_worship
				religion = ynn_river_reformed
			}
		}
		country_event = { id = ynn_zodiac.3 }
	}

	#Hrenvyr (Arverynn)
	if = {
		limit = {
			tag = G86
			has_ruler_flag = G35_stanyrhrada_ward_flag
			is_subject = yes
			overlord = {
				OR = {
					tag = G35
					was_tag = G35
				}
			}
		}
		country_event = { id = flavor_arverynn.52 } #Hrenvyr
	}

	#Aelnar
	if = {
		limit = {
			has_reform = godhood_reform
			NOT = { has_country_flag = elven_constellation_done }
		}
		country_event = { id = aelnar.65 days = 10 }
	}

	#Vels bacar
	if = {
		limit = { 
			AND = { 
				OR = {
					tag = G84
					was_tag = G84
					tag = H25
				}
				has_country_flag = vels_bacar_stenur_princess
			} 
		}
		1138 = {
			owner = {
				if = { 
					limit = { overlord_of = H25 }
					country_event = {
						id = flavor_vels_bacar.20
					}
				}
			}
		}
	}

	#No stability loss
	if = {
		limit = {
			OR = {
				has_country_flag = no_stab_hit_on_ruler_death
				has_a_primary_cult_selected = yes
			}
			OR = {
				government = tribal
				government = monarchy
			}
			ruler_is_not_lich = yes
		}
		add_stability = 1
	}

	#Necropolis stuff
	if = {
		limit = {
			owns_core_province = 4565
			controls = 4565
			OR = {
				tag = Y51
				capital_scope = { region = bomdan_region }
			}
			OR = {
				religion_group = halessi
				religion_group = raheni
			}
		}
		country_event = { id = bim_lau_flavour.5 days = 3 } #Bim Lau Great Necropolis Entombment
	}

	#Oni ruler stuff
	if = {
		limit = {
			has_reform = tagharoghi_reform
		}
		clr_country_flag = oni_ruler_shinukhorchi
		clr_country_flag = oni_ruler_chumijemoya
		clr_country_flag = oni_ruler_ajgriijarul
		clr_country_flag = oni_ruler_kabiurgarko
		clr_country_flag = oni_ruler_khelorvalshi
		if = {
			limit = {
				has_country_flag = oni_heir_shinukhorchi
			}
			clr_country_flag = oni_heir_shinukhorchi
			set_country_flag = oni_ruler_shinukhorchi
		}
		else_if = {
			limit = {
				has_country_flag = oni_heir_chumijemoya
			}
			clr_country_flag = oni_heir_chumijemoya
			set_country_flag = oni_ruler_chumijemoya
		}
		else_if = {
			limit = {
				has_country_flag = oni_heir_ajgriijarul
			}
			clr_country_flag = oni_heir_ajgriijarul
			set_country_flag = oni_ruler_ajgriijarul
		}
		else_if = {
			limit = {
				has_country_flag = oni_heir_kabiurgarko
			}
			clr_country_flag = oni_heir_kabiurgarko
			set_country_flag = oni_ruler_kabiurgarko
		}
		else_if = {
			limit = {
				has_country_flag = oni_heir_khelorvalshi
			}
			clr_country_flag = oni_heir_khelorvalshi
			set_country_flag = oni_ruler_khelorvalshi
		}
	}

	#Death of Indranayar
	if = { 
		limit = { tag = R51 }
		country_event = { id = rahenraj.90 }
	}

	#A Diamond in the Rough
	if = {
		limit = {
			tag = H76
			has_country_modifier = H76_oppositionist
		}
		country_event = {
			id = flavour_ordstun.38
		}
	}

	#Thangoya Mya coup
	if = {
		limit = { 
			tag = Y58 
			has_country_flag = thangoya_mya_coup 
		}
		Z62 = { country_event = { id = thangoya_event.7 } }
	}

	#Ikrorzik extended legacy
	if = {
		limit = { tag = F69 has_country_flag = irkorzik_extend_irkorziks_legacy }
		add_country_modifier = { name = irkorzik_legacy duration = 9125 }
	}

	#Fangaula Pantheon
	if = {
		limit = {
			religion = fangaulan_pantheon
			OR = {
				government = monarchy
				government = tribal
			}
			owns = 5863 #Gamyi
		}
		random_list = {
			50 = {}
			50 = {
				country_event = { id = fangaulan_pantheon.2 }
			}
		}
	}

	#Larankar, Sibling's War Start Event
	if = {
		limit = {
			OR = {
				tag = G64 #Larankar
				was_tag = G64 #Larankar
			}
		}
		country_event = {
			id = larankar_events.100 #The Heirs of RULER
			days = 365 #1 year
		}
		if = {
			limit = { has_country_flag = G64_erankar_dead_flag }
			country_event = {
				id = larankar_events.101 #RULER Assassinated!
			}
		}
	}
	if = {
		limit = {
			ai = no
		}
		export_to_variable = { # Export end dev
			which = monarch_reign_end_dev
			value = total_development
			who = ROOT
		}
		subtract_variable = { # End dev now stores difference
			which = monarch_reign_end_dev
			which = monarch_reign_start_dev
		}
		export_to_variable = { # Restart for new monarch.
			which = monarch_reign_start_dev
			value = total_development
			who = ROOT
		}
		country_event = { id = spirits.1003 }
	}

	#Sri Baginda - If they die with less than 50 prestige, title goes to someone else
	if = {
		limit = {
			is_sri_baginda = yes
			NOT = { prestige = 50 }
		}
		country_event = { id = lupulan_events.1003 }
	}

	#Zokka
	if = {
		limit = { tag = F29 }
		if = {
			limit = { has_country_flag = zokka_zokka_heir_of_zokka_flag }
			country_event = { id = flavour_zokka.22 }
		}
	}
	
	country_event = { id = flavor_shelokmengi.14 days = 1 } #Shelokmengi

	if = { #Tiboktsamo ruler death
		limit = { is_or_was_tag = { tag = L53 } }
		country_event = { id = flavour_tiboktsamo.14 }
	}

	if = {
		limit = {
			tag = H74
			ruler_is_not_lich = yes #Dak died and wasn't a lich
		}
		country_event = { id = flavor_chaingrasper.101 }
	}

	magic_on_ruler_death = yes #For lichdom etc.
}

succession_culture_religion_effect = {
	if = {
		limit = {
			NOT = { has_reform = elective_monarchy }
			NOT = { has_reform = polish_elective_monarchy }
			NOT = { has_reform = racial_tolerance_reform }
			has_regency = no
			NOT = { has_country_flag = had_culture_religion_reaction_event_flag }
			# NOT = { has_reform = mamluk_government }
			NOT = { has_reform = winged_menkaunswt_reform } #duwarkani MT specific reform
			OR = {
				NOT = { ruler_culture = ROOT }
				NOT = { ruler_religion = ROOT }
			}
		}
		set_country_flag = had_culture_religion_reaction_event_flag #Note: Cleared in the event below, all future effects from ruler culture/religion are gated behind this flag being cleared.
		country_event = { id = culture_religion_events.2 days = 75 random = 7 }
	}
}

on_province_owner_change_government_effect = {
	if = {
		limit = {
			OR = {
				has_province_modifier = wine_bonus_prod
				has_province_modifier = grain_bonus_prod
			}
			FROM = { has_reform = monastic_breweries_reform }
			NOT = { owner = { has_reform = monastic_breweries_reform } }
		}
		remove_province_modifier = wine_bonus_prod
		remove_province_modifier = grain_bonus_prod
	}
	if = {
		limit = {
			NOT = {
				OR = {
					has_province_modifier = wine_bonus_prod
					has_province_modifier = grain_bonus_prod
				}
			}
			owner = { has_reform = monastic_breweries_reform }
			NOT = { FROM = { has_reform = monastic_breweries_reform } }
		}
		hidden_effect = {
			if = {
				limit = {
					trade_goods = wine
				}
				add_province_modifier = { 
					name = wine_bonus_prod
					duration = -1
					hidden = yes
				}
			}
			if = {
				limit = {
					trade_goods = grain
				}
				add_province_modifier = { 
					name = grain_bonus_prod
					duration = -1
					hidden = yes
				}
			}
		}
	}
	if = {
		limit = {
			has_province_modifier = protection_of_foreign_traders_reform_modifier
			FROM = { has_reform = protection_of_foreign_traders_reform }
			NOT = { owner = { has_reform = protection_of_foreign_traders_reform } }
		}
		remove_province_modifier = protection_of_foreign_traders_reform_modifier
	}
	if = {
		limit = {
			NOT = { has_province_modifier = protection_of_foreign_traders_reform_modifier }
			owner = { has_government_attribute = protection_of_foreign_traders_reform }
			NOT = { FROM = { has_government_attribute = protection_of_foreign_traders_reform } }
			province_has_center_of_trade_of_level = 1
		}
		hidden_effect = {
			add_province_modifier = { 
				name = protection_of_foreign_traders_reform_modifier
				duration = -1
			}
		}
	}
	if = {
		limit = {
			has_province_modifier = grain_vodka_bonus_prod
			FROM = { has_government_attribute = extra_trade_goods_from_grain }
			NOT = { owner = { has_government_attribute = extra_trade_goods_from_grain } }
		}
		remove_province_modifier = grain_vodka_bonus_prod
	}
	if = {
		limit = {
			NOT = { has_province_modifier = grain_vodka_bonus_prod }
			owner = { has_government_attribute = extra_trade_goods_from_grain }
			NOT = { FROM = { has_government_attribute = extra_trade_goods_from_grain } }
			trade_goods = grain
		}
		hidden_effect = {
			add_province_modifier = { 
				name = grain_vodka_bonus_prod
				duration = -1
				hidden = yes
			}
		}
	}
	if = {
		limit = {
			has_province_modifier = naval_supplies_bonus_prod
			FROM = { has_government_attribute = extra_trade_goods_from_naval_supplies }
			NOT = { owner = { has_government_attribute = extra_trade_goods_from_naval_supplies } }
		}
		remove_province_modifier = naval_supplies_bonus_prod
	}
	if = {
		limit = {
			NOT = { has_province_modifier = naval_supplies_bonus_prod }
			owner = { has_government_attribute = extra_trade_goods_from_naval_supplies }
			NOT = { FROM = { has_government_attribute = extra_trade_goods_from_naval_supplies } }
		}
		hidden_effect = {
			if = {
				limit = {
					trade_goods = naval_supplies
				}
				add_province_modifier = { 
					name = naval_supplies_bonus_prod
					duration = -1
					hidden = yes
				}
			}
		}
	}
	if = {
		limit = {
			has_province_modifier = swe_support_of_the_peasantry_prov
			FROM = { has_country_modifier = swe_support_of_the_peasantry }
			NOT = { owner = { has_country_modifier = swe_support_of_the_peasantry } }
		}
		remove_province_modifier = swe_support_of_the_peasantry_prov
	}
	if = {
		limit = {
			NOT = { has_province_modifier = swe_support_of_the_peasantry_prov }
			owner = { has_country_modifier = swe_support_of_the_peasantry }
			NOT = { FROM = { has_country_modifier = swe_support_of_the_peasantry } }
		}
		hidden_effect = {
			if = {
				limit = {
					OR = {
						trade_goods = grain
						trade_goods = livestock
						trade_goods = fish
					}
				}
				add_province_modifier = { 
					name = swe_support_of_the_peasantry_prov
					duration = -1
					hidden = yes
				}
			}
		}
	}
	if = {
		limit = {
			owner = { has_government_attribute = temples_modifier }
			has_tax_building_trigger = yes
		}
		add_province_modifier = {
			name = gov_expanded_temple_rights_mod
			duration = -1
		}
	}
	if = { #1.35
		limit = {
			owner = { has_government_attribute = more_25_tax_in_true_faith_provinces }
			has_owner_religion = yes
		}
		add_province_modifier = {
			name = ottoman_siyasah_tax_reform_tax
			duration = -1
		}
	}
	if = {
		limit = {
			owner = { has_government_attribute = more_15_manpower_in_heathen_provinces }
			NOT = { religion_group = owner }
		}
		add_province_modifier = {
			name = ottoman_siyasah_tax_reform_manpower
			duration = -1
		}
	}
	if = {
		limit = {
			owner = { has_government_attribute = improved_military_buildings }
		}
		if = {
			limit = { has_building = barracks }
			add_province_modifier = {
				name = wei_suo_system_reform_barracks_modifier
				duration = -1
				hidden = yes
			}
		}
		if = {
			limit = { has_building = training_fields }
			add_province_modifier = {
				name = wei_suo_system_reform_training_fields_modifier
				duration = -1
				hidden = yes
			}
		}
		if = {
			limit = { has_building = regimental_camp }
			add_province_modifier = {
				name = wei_suo_system_reform_regimental_camp_modifier
				duration = -1
				hidden = yes
			}
		}
		if = {
			limit = { has_building = conscription_center }
			add_province_modifier = {
				name = wei_suo_system_reform_conscription_center_modifier
				duration = -1
				hidden = yes
			}
		}
		if = {
			limit = { has_building = soldier_households }
			add_province_modifier = {
				name = wei_suo_system_reform_soldier_households_modifier
				duration = -1
				hidden = yes
			}
		}
	}
	if = {
		limit = {
			has_port = yes
			owner = {
				has_government_attribute = cheaper_coastal_province_core
			}
		}
		add_province_modifier = {
			name = gov_coastal_government
			duration = -1
		}
	}
	if = {
		limit = {
			culture_group = goblin
			owner = { has_government_attribute = cheaper_goblin_governance }
			NOT = { has_province_modifier = goblin_citizens }
		}
		add_province_modifier = {
			name = goblin_citizens
			duration = -1
		}
	}
	if = {
		limit = {
			has_province_modifier = goblin_citizens
			owner = { NOT = { has_government_attribute = cheaper_goblin_governance } }
		}
		remove_province_modifier = goblin_citizens
	}
	if = {
		limit = {
			owner = { has_government_attribute = command_tiger_elevation_modifier }
			has_building = cathedral
		}
		add_province_modifier = {
			name = commmand_tiger_temple_buff
			duration = -1
		}
	}
	if = {
		limit = {
			owner = { has_government_attribute = command_elephant_elevation_modifier }
			has_fort_building_trigger = yes
		}
		add_province_modifier = {
			name = command_elephant_fort_buff
			duration = -1
		}
	}

	#sponsored adventurers
	if = {
		limit = {
			owner = { has_government_attribute = reform_progress_from_conquest }
			NOT = { has_province_flag = reform_progress_from_conquest_granted }
		}
		owner = {
			change_government_reform_progress = 10
		}
		set_province_flag = reform_progress_from_conquest_granted
	}
	if = {
        limit = {
            owner = { has_reform = bloodwine_temple }
            trade_goods = wine
        }

        add_province_modifier = { 
            name = bloodwine_temple_wine
            duration = -1
            hidden = yes
        }
    }
}

on_province_religion_changed_effect = {
	on_province_religion_converted_estate_privileges_effect = yes
	
	if = {
		limit = {
			owner = { has_country_flag = jaddari_the_western_beacon_flag }
			has_province_modifier = jaddari_the_western_beacon
			religion = the_jadd
		}
		hidden_effect = {
			remove_province_modifier = jaddari_the_western_beacon
		}
	}
	#Ameion
	if = {
		limit = { owner = { has_country_flag = ameion_fotistrepei_flag } }
		ameion_fotistrepei_effect_prov = yes
	}
	if = {
		limit = {
			owner = { has_country_flag = ameion_kheionization }
			OR = {
				superregion = taychend_superregion
				region = chendhya_region
				region = mteibas_valley_region
			}
		}
		owner = { country_event = { id = flavor_ameion.810 } }
	}
	# Yinquan
	if = {
		limit = { owner = { tag = Y26 religion = accretive_path } }
		set_province_flag = Y26_converted_province
	}
	#Deepwoods cultivated goods
	if = {	
		limit = {
			province_group = fey_abundant_goods_provinces
			NOT = { owner = { mission_completed = Z54_turn_their_magic_against_them } } # Karakhanbar
		}
		if = {	#If you're friends with the fey you get good stuff
			limit = {			
				is_fey_attuned_culture = yes
				NOT = { owner = { has_country_flag = abundant_goods_improved } }
			}
			remove_province_modifier = fey_dummy_goods
			remove_province_modifier = fey_abundant_goods_improved
			add_permanent_province_modifier = {
				name = fey_abundant_goods
				duration = -1
			}
		}
		else_if = {	#If you've improved your abundant goods in mission tree you get this
			limit = {
				is_fey_attuned_culture = yes
				owner = { has_country_flag = abundant_goods_improved }
			}
			remove_province_modifier = fey_dummy_goods
			remove_province_modifier = fey_abundant_goods
			add_permanent_province_modifier = {
				name = fey_abundant_goods_improved
				duration = -1
			}
		}
		else_if = {	#If you're not friends with the fey you get nothing
			limit = {
				province_group = fey_abundant_goods_provinces
				is_fey_attuned_culture = no
			}
			remove_province_modifier = fey_abundant_goods
			remove_province_modifier = fey_abundant_goods_improved
			add_permanent_province_modifier = {
				name = fey_dummy_goods
				duration = -1
			}
		}
	}
		
	# Plumstead
	if = {
		limit = { religion = ravelian culture = epednar owner = { tag = H61 religion = ravelian } }
		owner = {
			country_event = {
				id = flavour_plumstead.75
				days = 365
				random = 730
			}
		}
	}
	if = {
		limit = {
			owner = { religion = high_philosophy }
			is_capital = yes
			religion = suhans_praxis
		}
		owner = { country_event = { id = rahen.13 } }
	}
	if = {
		limit = {
			owner = { has_estate_privilege = estate_church_dictate_understanding }
			has_province_flag = bulwar_evil_religion_xhazobkult
		}
		change_religion = kvangahga
		clr_province_flag = bulwar_evil_religion_xhazobkult
	}
	if = {
		limit = {
			owner = { has_estate_privilege = estate_church_dictate_understanding }
			has_province_flag = bulwar_evil_religion_devouring_path
		}
		change_religion = accretive_path
		clr_province_flag = bulwar_evil_religion_devouring_path
	}
	if = {
		limit = {
			owner = { has_estate_privilege = estate_church_dictate_understanding }
			has_province_flag = bulwar_evil_religion_effelai
		}
		change_religion = orwaii
		clr_province_flag = bulwar_evil_religion_effelai
	}
	#Command Post-Edict-of-X Laws of Ninun
	if = {
		limit = {
			owner = { tag = R62 has_global_flag = R62_the_edict_of_x_flag }
			NOT = { has_province_modifier = command_not_yet_wuhyunized_mod }
			command_not_yet_wuhyunized = yes
			NOT = { continent = serpentspine }
		}
		add_province_modifier = {
			name = command_not_yet_wuhyunized_mod
			duration = -1
		}
	}
	else_if = {
		limit = {
			has_province_modifier = command_not_yet_wuhyunized_mod
			command_not_yet_wuhyunized = no
		}
		remove_province_modifier = command_not_yet_wuhyunized_mod
	}
	#Azkabar - Removing the cleansing modifier on conversion
	if = {
		limit = {
			owner = { tag = F35 }
			has_province_modifier = F35_state_instituted_cleansing
			religion = bulwari_sun_cult
		}
		remove_province_modifier = F35_state_instituted_cleansing
	}
	if = {
		limit = { religion = oren_nayiru }
		set_province_flag = oren_nayiru_province
		2502 = { #Uesrennu
			change_variable = {
				which = oren_nayiru_provinces
				value = 1
			}
		}
		if = {
			limit = { superregion = taychend_superregion }
			2502 = {
				change_variable = {
					which = taychend_oren_nayiru_provinces
					value = 1
				}
			}
		}
	}
	if = {
		limit = { 
			has_province_flag = oren_nayiru_province
			NOT = { religion = oren_nayiru } 
		}
		clr_province_flag = oren_nayiru_province
		2502 = { #Uesrennu
			change_variable = {
				which = oren_nayiru_provinces
				value = -1
			}
		}
		if = {
			limit = { superregion = taychend_superregion }
			2502 = {
				change_variable = {
					which = taychend_oren_nayiru_provinces
					value = -1
				}
			}
		}
	}
	if = {
		limit = {
			religion = oren_nayiru
			U39 = { #Orenvalyam
				OR = {
					has_country_flag = allow_kamrayakvals_war_modifier
					has_country_modifier = on_kamrayakvals_war_4
					has_country_modifier = on_kamrayakvals_war_3
					has_country_modifier = on_kamrayakvals_war_2
					has_country_modifier = on_kamrayakvals_war_1
				}
			}
		}
		U39 = { update_kamrayakvals_war_modifier = yes }
	}
	if = {
		limit = {
			province_group = fey_abundant_goods_provinces
			culture = forest_goblin  #for now religion is only relevant for the gobbos
			NOT = { owner = { mission_completed = Z54_turn_their_magic_against_them } } # Karakhanbar
		}
		if = {	#If you're friends with the fey you get good stuff
			limit = {			
				is_fey_attuned_culture = yes
				NOT = { owner = { has_country_flag = abundant_goods_improved } }
			}
			remove_province_modifier = fey_dummy_goods
			remove_province_modifier = fey_abundant_goods_improved
			add_permanent_province_modifier = {
				name = fey_abundant_goods
				duration = -1
			}
		}
		else_if = {	#If you've improved your abundant goods in mission tree you get this
			limit = {
				is_fey_attuned_culture = yes
				owner = { has_country_flag = abundant_goods_improved }
			}
			remove_province_modifier = fey_dummy_goods
			remove_province_modifier = fey_abundant_goods
			add_permanent_province_modifier = {
				name = fey_abundant_goods_improved
				duration = -1
			}
		}
		else_if = {	#If you're not friends with the fey you get nothing
			limit = {
				province_group = fey_abundant_goods_provinces
				is_fey_attuned_culture = no
			}
			remove_province_modifier = fey_abundant_goods
			remove_province_modifier = fey_abundant_goods_improved
			add_permanent_province_modifier = {
				name = fey_dummy_goods
				duration = -1
			}
		}
	}
	if = { #Bhuvauri HP path
		limit = {
			religion = suhans_praxis
			R38 = { mission_completed = R38_four_men_elephant }
		}
		remove_province_modifier = religious_zeal_at_conv
	}

	if = {
		limit = {
			religion = devouring_path
			has_province_modifier = corrupted_temple_complex_inactive
			owner = { religion = devouring_path }
		}
		remove_province_modifier = corrupted_temple_complex_inactive
		add_permanent_province_modifier = { name = corrupted_temple_complex duration = -1 }
	}
	else_if = {
		limit = {
			has_province_modifier = corrupted_temple_complex
			NOT = { religion = devouring_path }
		}
		remove_province_modifier = corrupted_temple_complex
		add_permanent_province_modifier = { name = corrupted_temple_complex_inactive duration = -1 }
	}
	if = { #Strenghten Elven Privilleges reform
		limit = { owner = { has_reform = strengthen_elves_privileges } }
		if = {
	    	limit = { religion = elven_forebears }
			add_province_modifier = {
				name = gov_moon_elven_religion_tolerance
				duration = -1
			}	 
		}
		else_if = {
	    	limit = { has_province_modifier = gov_moon_elven_religion_tolerance }
			remove_province_modifier = gov_moon_elven_religion_tolerance
		}
	}	
	#Ties with Anbennarian Nobility
	if = { 
		limit = { owner = { has_reform = ties_with_anbennarian_nobility } } 
		if = {
	    	limit = { 
				has_owner_religion = no
				is_anbennarian_imperial_culture = yes
				NOT = { has_province_modifier = gov_empire_heretic } 
			}
			add_province_modifier = {
				name = gov_empire_heretic
				duration = -1
			} 
		}
		else_if = { 
	    	limit = { 
				has_province_modifier = gov_empire_heretic
				has_owner_religion = yes 
			}
			remove_province_modifier = gov_empire_heretic
		}
	}	
	if = { #Taychendi Empire
		limit = {
			owner = { 
				has_country_flag = J84_ravelianism_tolerated_flag 
				religion = ravelian
			}
			religion = ravelian
		}
		add_province_modifier = {
			name = J84_ravelianism_tolerated
			duration = -1
		}
	}
	if = {
		limit = {
			has_province_modifier = J84_ravelianism_tolerated
			NOT = { religion = ravelian }
		}
		remove_province_modifier = J84_ravelianism_tolerated
	}
	
	if = {
		limit = { province_group = infernal_court_temples }
		infernal_deity_upgrade_effect = yes
	}

	#Rezankand
	if = {
		limit = {
			religion = oren_nayiru
			owner = { is_incident_active = incident_one_sun }
		}
		if = {
			limit = {
				owner = { has_country_flag = rezankand_supported_on }
			}
			add_province_modifier = {
				name = rezankand_supporting_oren_prov_mod
				duration = -1
			}
		}
		else_if = {
			limit = {
				owner = { has_country_flag = rezankand_stomping_on }
			}
			add_province_modifier = {
				name = rezankand_stomping_oren_prov_mod
				duration = -1
			}
		}
	}

	if = {
		limit = {
			NOT = { religion = oren_nayiru }
		}
		if = {
			limit = { has_province_modifier = rezankand_stomping_oren_prov_mod }
			remove_province_modifier = rezankand_stomping_oren_prov_mod
		}
		else_if = {
			limit = { has_province_modifier = rezankand_supporting_oren_prov_mod }
			remove_province_modifier = rezankand_supporting_oren_prov_mod
		}
	}

	if = {
		limit = { has_province_modifier = yuanszi_smiling_men NOT = { religion = devouring_path } }
		remove_province_modifier = yuanszi_smiling_men
	}
	else_if = {
		limit = { religion = devouring_path has_global_flag = yuanszi_smiling_men_flag }
		add_permanent_province_modifier = { name = yuanszi_smiling_men duration = -1 }
	}

	#sponsored adventurers
	if = {
		limit = {
			has_owner_religion = yes
			owner = {
				has_government_attribute = reform_progress_from_conversion
			}
			NOT = { has_province_flag = reform_progress_from_religion_conversion }
		}
		owner = {
			change_government_reform_progress = 10
		}
		set_province_flag = reform_progress_from_religion_conversion
	}

	#Drozma Tur
	if = {
		limit = {
			owner = {
				religion = drozma_tur
				has_church_aspect = spirit_introspection_aspect
			}
		}
		if = {
			limit = {
				owner = {
					NOT = {
						has_church_aspect = community_triumph_aspect_dip
					}
				}
				religion = drozma_tur
			}
			set_province_flag = dt_province_converted_flag
		}
		else_if = {
			limit = {
				owner = {
					has_church_aspect = community_triumph_aspect_dip
				}
				NOT = {
					has_province_modifier = dt_community_triumph_buff
				}
				religion = drozma_tur
			}
			add_province_modifier = {
				name = dt_community_triumph_buff
				duration = -1
			}
		}
	}

	#Verne
	if = {
		limit = {
			country_or_subject_holds = A33
		}
		if = {
			limit = {
				region = akasik_region
				owner = { accepted_culture = dovesworn_gnoll }
				religion = corinite
				culture_is_gnollish = yes
			}
			change_culture = dovesworn_gnoll
		}
		if = {
			limit = {
				OR = {
					religion = oren_nayiru
					religion = oren_nayiru_reformed
				}
				A33 = { has_country_flag = verne_corinite_synchretism_flag }
			}
			add_province_modifier = {
				name = verne_corinite_synchretism
				duration = -1
			}
		}
		if = {
			limit = {
				has_province_modifier = verne_corinite_synchretism
				NOT = { religion = oren_nayiru }
				NOT = { religion = oren_nayiru_reformed }
			}
			remove_province_modifier = verne_corinite_synchretism
		}
		if = {
			limit = {
				has_province_modifier = verne_trade_company_conversion_modifier
				religion = corinite
			}
			remove_province_modifier = verne_trade_company_conversion_modifier
		}
	}
	
	if = {
		limit = { owner = { has_reform = F66_words_of_horutep } }
		remove_province_modifier = konolkhatep_voice_horutep_nirakhetist
		remove_province_modifier = konolkhatep_voice_horutep_elikhetist
		if = {
			limit = {
				owner = { religion = elikhetist }
				religion = nirakhetist
			}
			add_province_modifier = { name = konolkhatep_voice_horutep_nirakhetist duration = -1 }
		}
		if = {
			limit = {
				owner = { religion = nirakhetist }
				religion = elikhetist
			}
			add_province_modifier = { name = konolkhatep_voice_horutep_elikhetist duration = -1 }
		}
	}

	if = {
		limit = { has_province_modifier = inactive_levaajan_monastery religion = levaajan }
		remove_province_modifier = inactive_levaajan_monastery
		add_permanent_province_modifier = { name = levaajan_monastery duration = -1 }
	}
	else_if = {
		limit = { has_province_modifier = levaajan_monastery NOT = { religion = levaajan } }
		remove_province_modifier = levaajan_monastery
		add_permanent_province_modifier = { name = inactive_levaajan_monastery duration = -1 }
	}

	# Two Rulers, One Country - Regent Court
	if = {
		limit = { owner = { has_government_attribute = two_rulers_one_people_rc } }

		if = {
			limit = { religion = corinite }
			add_province_modifier = {
				name = two_rulers_one_people_modifier
				duration = -1
			}
		}
		else = {
			remove_province_modifier = two_rulers_one_people_modifier
		}
	}

	# Two Rulers, One Country - Corinite
	if = {
		limit = { owner = { has_government_attribute = two_rulers_one_people_cor } }

		if = {
			limit = { religion = regent_court }
			add_province_modifier = {
				name = two_rulers_one_people_modifier
				duration = -1
			}
		}
		else = {
			remove_province_modifier = two_rulers_one_people_modifier
		}
	}
}

on_province_religion_converted_effect = {
	if = {
		limit = { owner = { has_government_attribute = gain_devotion_from_conversions } }
		owner = { add_devotion = 0.2 }
	}
	if = {
		limit = { owner = { has_government_attribute = theocratic_monarchy_mechanic } }
		owner = { change_statists_vs_orangists = -0.01 }
	}
	if = {
		limit = {
			owner = {
				has_country_modifier = fangaulan_pantheon_kanhati_missionary
			}
		}
		owner = {
			add_war_exhaustion = -0.01
		}
	}
}

on_trade_good_changed_government_effect = {
	if = {
		limit = {
			owner = { has_reform = monastic_breweries_reform }
		}
		if = {
			limit = {
				trade_goods = grain
			}
			remove_province_modifier = wine_bonus_prod
			add_province_modifier = { 
				name = grain_bonus_prod
				duration = -1
				hidden = yes
			}
		}
		else_if = {
			limit = {
				trade_goods = wine
			}
			remove_province_modifier = wine_bonus_prod
			add_province_modifier = { 
				name = grain_bonus_prod
				duration = -1
				hidden = yes
			}
		}
		else = {
			remove_province_modifier = wine_bonus_prod
			remove_province_modifier = grain_bonus_prod
		}
	}
	else = {
		remove_province_modifier = wine_bonus_prod
		remove_province_modifier = grain_bonus_prod
	}
	if = {
		limit = { owner = { has_government_attribute = extra_trade_goods_from_grain } }
		if = {
			limit = { trade_goods = grain }
			add_province_modifier = { 
				name = grain_vodka_bonus_prod
				duration = -1
				hidden = yes
			}
		}
		else = { remove_province_modifier = grain_vodka_bonus_prod }
	}
	else = { remove_province_modifier = grain_vodka_bonus_prod }
	if = {
		limit = {
			owner = { has_government_attribute = extra_trade_goods_from_naval_supplies }
		}
		if = {
			limit = {
				trade_goods = naval_supplies
			}
			add_province_modifier = { 
				name = naval_supplies_bonus_prod
				duration = -1
				hidden = yes
			}
		}
		else = {
			remove_province_modifier = naval_supplies_bonus_prod
		}
	}
	else = {
		remove_province_modifier = naval_supplies_bonus_prod
	}
	if = {
		limit = {
			owner = { has_country_modifier = swe_support_of_the_peasantry }
		}
		if = {
			limit = {
				OR = {
					trade_goods = grain
					trade_goods = fish
					trade_goods = livestock
				}
			}
			add_province_modifier = { 
				name = swe_support_of_the_peasantry_prov
				duration = -1
				hidden = yes
			}
		}
		else = {
			remove_province_modifier = swe_support_of_the_peasantry_prov
		}
	}
	else = {
		remove_province_modifier = swe_support_of_the_peasantry_prov
	}
}
#1.35
on_battle_won_unit_effect = {
	if = {
		limit = {
			unit_owner = {
				has_government_attribute = winning_battles_increases_legitimacy
			}
			is_ruler_commanding_unit = yes
		}
		unit_owner = {
			add_legitimacy = 0.5
			add_devotion = 0.5
			add_republican_tradition = 0.1
			add_revolutionary_zeal_or_absolutism = { amount = 0.1 }
		}
	}

    if = {
        limit = {
            unit_owner = {
                tag = G32
				OR = {
					has_reform = malacnar_monarchy
					has_reform = malacnar_monarchy_reformed
					has_reform = malacnar_republic_reform
				}
            }
            is_ruler_commanding_unit = yes
			enemy_unit = {
				unit_owner = {
					NOT = { tag = NAT }
				}
			}
        }
        G32 = {
			country_event = { id = flavor_malacnar.6 }
		}
    }

	if = {
		limit = {
			unit_owner = {
				tag = I30
				has_reform = the_great_salla
			}
			general_with_name = "Oberon Fealgarn"
			if = { # This to prevent multiple armies in battle counting as multiple victories
				limit = { I30 = { has_country_flag = battleCooldownOberon } }
				I30 = {
					had_country_flag = {
						flag = battleCooldownOberon
						days = 5
					}
				}
			}
		}
		unit_owner = {
			change_variable = { which = oberon_popularity value = 1 }
			change_government_reform_progress = -2
			clr_country_flag = battleCooldownOberon
			set_country_flag = battleCooldownOberon
		}
	}
	if = {
		limit = {
			location = {
				has_province_flag = drozma_last_stand_prov_flag
			}
			unit_owner = {
				has_country_flag = drozma_fighting_last_stand
			}
			enemy_unit = {
				unit_owner = {
					tag = REB
				}
			}
		}
		if = {
			limit = {
				is_ruler_commanding_unit = yes
				NOT = {
					unit_owner = { ruler_has_personality = craven_personality }
				}
			}
			unit_owner = { set_country_flag = drozma_leader_v_dragon }
		}
		unit_owner = { country_event = { id = ynn_events.25 } }
	}
	if = {	# Edhardrachon battles
		limit = {
			unit_owner = { tag = B61 }
			is_ruler_commanding_unit = yes
			if = { # This to prevent multiple armies in battle counting as multiple victories
				limit = { B61 = { has_country_flag = battleCooldownPatricianCastan } }
				B61 = {
					had_country_flag = {
						flag = battleCooldownPatricianCastan
						days = 5
					}
				}
			}
		}
		B61 = {
			change_variable = {
				which = patricianCastanBattlesWon
				value = 1
			}
			clr_country_flag = battleCooldownPatricianCastan
			set_country_flag = battleCooldownPatricianCastan
		}
	}
	if = {
		limit = {
			unit_owner = { tag = B32 }
			enemy_unit = { unit_owner = { tag = B61 } }
		}
		if = {
			limit = {
				enemy_unit = { is_ruler_commanding_unit = yes }
				if = {
					limit = { B32 = { has_country_flag = battleCooldownAgainstPatricianCastan } }
					B32 = {
						had_country_flag = {
							flag = battleCooldownAgainstPatricianCastan
							days = 5
						}
					}
				}
			}
			B32 = {
				change_variable = { which = battlesWonAgainstPatricianCastan value = 1 }
				clr_country_flag = battleCooldownAgainstPatricianCastan
				set_country_flag = battleCooldownAgainstPatricianCastan
			}
		}
		if = {
			limit = {
				enemy_unit = { general_with_name = "Elecast, the Burnished Wing" }
				if = {
					limit = { B32 = { has_country_flag = battleCooldownAgainstElecast } }
					B32 = {
						had_country_flag = {
							flag = battleCooldownAgainstElecast
							days = 5
						}
					}
				}
			}
			B32 = {
				change_variable = { which = battlesWonAgainstElecast value = 1 }
				clr_country_flag = battleCooldownAgainstElecast
				set_country_flag = battleCooldownAgainstElecast
			}
			random_list = {
				# Nothing happens
				10 = {
					modifier = {
						factor = 0
						# Yes this implementation sucks
						any_province = {
							has_province_flag = castanor_stack_wipe
							NOT = {
								had_province_flag = {
									flag = castanor_stack_wipe
									days = 2
								}
							}
						}
					}
				}
				1 = {
					modifier = {
						factor = 10
						B32 = { check_variable = { which = battlesWonAgainstElecast value = 2 } }
					}
					modifier = {
						factor = 3
						B32 = { check_variable = { which = battlesWonAgainstElecast value = 3 } }
					}
					modifier = {
						factor = 10
						B32 = { check_variable = { which = battlesWonAgainstElecast value = 5 } }
					}
					B32 = { country_event = { id = flavor_castanor.210 } }
				}
			}
		}
		if = {
			limit = {
				enemy_unit = { general_with_name = "Gracos, the Leaden Breath" }
				if = {
					limit = { B32 = { has_country_flag = battleCooldownAgainstGracos } }
					B32 = {
						had_country_flag = {
							flag = battleCooldownAgainstGracos
							days = 5
						}
					}
				}
			}
			B32 = {
				change_variable = { which = battlesWonAgainstGracos value = 1 }
				clr_country_flag = battleCooldownAgainstGracos
				set_country_flag = battleCooldownAgainstGracos
			}
			random_list = {
				# Nothing happens
				10 = {
					modifier = {
						factor = 0
						# Yes this implementation sucks
						any_province = {
							has_province_flag = castanor_stack_wipe
							NOT = {
								had_province_flag = {
									flag = castanor_stack_wipe
									days = 2
								}
							}
						}
					}
				}
				1 = {
					modifier = {
						factor = 10
						B32 = { check_variable = { which = battlesWonAgainstGracos value = 2 } }
					}
					modifier = {
						factor = 3
						B32 = { check_variable = { which = battlesWonAgainstGracos value = 3 } }
					}
					modifier = {
						factor = 10
						B32 = { check_variable = { which = battlesWonAgainstGracos value = 5 } }
					}
					B32 = { country_event = { id = flavor_castanor.208 } }
				}
			}
		}
		if = {
			limit = {
				enemy_unit = { general_with_name = "Erella, the Argent Claw" }
				if = {
					limit = { B32 = { has_country_flag = battleCooldownAgainstErella } }
					B32 = {
						had_country_flag = {
							flag = battleCooldownAgainstErella
							days = 5
						}
					}
				}
			}
			B32 = {
				change_variable = { which = battlesWonAgainstErella value = 1 }
				clr_country_flag = battleCooldownAgainstErella
				set_country_flag = battleCooldownAgainstErella
			}
			random_list = {
				# Nothing happens
				10 = {
					modifier = {
						factor = 0
						# Yes this implementation sucks
						any_province = {
							has_province_flag = castanor_stack_wipe
							NOT = {
								had_province_flag = {
									flag = castanor_stack_wipe
									days = 2
								}
							}
						}
					}
				}
				1 = {
					modifier = {
						factor = 10
						B32 = { check_variable = { which = battlesWonAgainstErella value = 2 } }
					}
					modifier = {
						factor = 3
						B32 = { check_variable = { which = battlesWonAgainstErella value = 3 } }
					}
					modifier = {
						factor = 10
						B32 = { check_variable = { which = battlesWonAgainstErella value = 5 } }
					}
					B32 = { country_event = { id = flavor_castanor.209 } }
				}
			}
		}
	}
	if = { #Larankar
		limit = {
			is_ruler_commanding_unit = yes
			unit_owner = {
				tag = G64 #Larankar
				has_ruler_flag = G64_is_erankar_flag
			}
			enemy_unit = {
				is_ruler_commanding_unit = yes
				unit_owner = {
					tag = G52 #Ameion
					has_ruler_flag = G52_is_laskaris_flag
				}
			}
		}
		unit_owner = {
			country_event = {
				id = larankar_events.1 #Clash of the Two Heroes
			}
		}
	}

	if = { #Parahechend
		limit = {
			unit_owner = {
				is_or_was_tag = { tag = J81 } #Parahechend
				has_country_modifier = J81_the_hammer_of_anathazhilan_mod
			}
			is_ruler_commanding_unit = yes
			enemy_unit = {
				unit_owner = {
					tag = REB
				}
			}
		}
		unit_owner = {
			prepare_months_of_tax_income = {
				months = 1
			}
			add_prepared_months_of_tax_income = {
				sign = +
			}
		}
	}
	if = {
		limit = { 
			unit_owner = {
				has_ruler_flag = a95_casetin_ruler
			}
			is_ruler_commanding_unit = yes
			location = {
				OR = {
					province_id = 267
					province_id = 333
					province_id = 900
					province_id = 269
					province_id = 575
					province_id = 917
					province_id = 266
					province_id = 268
				}
			}
		}
		unit_owner = {
			random = {
				chance = 35
				country_event = {
					id = flavour_themarenn.54
				}
			}
		}
	}

	aldarian_scripted_effect = yes

	if = {  #BINSPLOSION
		limit = {
			unit_owner = {
				has_estate_privilege = estate_adventurers_cowardly_ruler
			}
			is_ruler_commanding_unit = yes
			enemy_unit = {
				unit_owner = {
					culture_group = gnollish
				}
			}
		}
		unit_owner = {
			change_variable = {
				which = binsplosion_ruler_kills_gnolls
				value = 1
			}
		}
		
	}
	
	if = {
		limit = {
			unit_owner = {
				tag = S23
				has_country_flag = s23_seble_ruler
			}
			is_ruler_commanding_unit = yes
		}
		if = {
			limit = {
				enemy_unit = {
					unit_owner = {
						tag = F29
					}
					is_ruler_commanding_unit = yes
				}
			}
			S23 = {
				set_country_flag = s23_f29_defeated
				country_event = { id = hisost.90 }
			}
		}
		if = {
			limit = {
				enemy_unit = {
					unit_owner = {
						tag = F46
					}
					is_ruler_commanding_unit = yes
				}
			}
			S23 = {
				set_country_flag = s23_f46_defeated
				country_event = { id = hisost.90 }
			}
		}
	}

	if = {  #vaengheim
		limit = {
			unit_owner = {
				tag = Z88
			}
			is_ruler_commanding_unit = yes
		}
		unit_owner = {
			change_variable = {
				which = vaeng_orcbattlescount
				value = 1
			}
		}
	}
	#Istralore
	if = {	
		limit = {
			unit_owner = { tag = A45 }
			is_ruler_commanding_unit = yes
		}
		A45 = {
			change_variable = {
				which = Aucannabattleswon
				value = 1
			}
		}
	}

	#Pashaine
	if = {
		limit = {
			unit_owner = {
				has_country_flag = unlocked_aegis_of_the_state_mod
				is_or_was_tag = { tag = B59 } #Pashaine
			}
			is_ruler_commanding_unit = yes
		}
		unit_owner = {
			change_variable = {
				which = ruler_aegis_battle_count
				value = 1
			}
			if = {
				limit = {
					check_variable = {
						which = ruler_aegis_battle_count
						value = 15
					}
					NOT = { has_ruler_modifier = aegis_of_the_state_mod }
				}
				add_ruler_modifier = {
					name = aegis_of_the_state_mod
					duration = -1
				}
			}
		}
	}

	#Facestealers
	if = {
		limit = { enemy_unit = { general_with_name = "The Host of Facestealers" } }
		unit_owner = { set_country_flag = defeated_face_stealer_host }
	}

	#Fangaulan Pantheon
	if = {
		limit = {
			unit_owner = {
				religion = fangaulan_pantheon
			}
			is_ruler_commanding_unit = yes
		}
		unit_owner = {
			add_church_power = 1
		}
	}
}

on_battle_lost_unit_effect = { #this triggers on every unit present 
	if = {
		limit = { NOT = { is_year = 1465 } } #No point checking for these after early game
		if = {
			limit = {
				unit_owner = {
					tag = F29
				}
				is_ruler_commanding_unit = yes
				enemy_unit = {
					unit_owner = {
						tag = F46
					}
					is_ruler_commanding_unit = yes
				}
			}
			F46 = {
				country_event = { id = zokka_jaddari_war.2 }
			}
		}
		if = {
			limit = {
				unit_owner = {
					tag = F46
				}
				is_ruler_commanding_unit = yes
				enemy_unit = {
					unit_owner = {
						tag = F29
					}
					is_ruler_commanding_unit = yes
				}
			}
			F29 = {
				country_event = { id = zokka_jaddari_war.4 }
			}
		}
		if = {	#Slaying Trompolere's warlord
			limit = {
				unit_owner = {
					has_ruler_flag = alaran
					NOT = { heir_age = 15 }
				}
				is_ruler_commanding_unit = yes
				any_country = {
					core_claim = G36
				}
			}
			enemy_unit = {
				unit_owner = {
					country_event = { id = flavor_trompolere.1 }
				}
			}
		}
	}
    if = {	#For events that happen post-1465
        limit = {
        	is_year = 1465
            unit_owner = {
                tag = Z50
                has_ruler_flag = grombar_corinite_ruler_joins_corinite_wars
            }
            is_ruler_commanding_unit = yes
        }
        Z50 = {
            country_event = { id = flavor_grombar.32 }
        }
    }
    if = {	#Slaying Malacnari Battleking
        limit = {
            unit_owner = {
                tag = G32
				OR = {
					has_reform = malacnar_monarchy
					has_reform = malacnar_monarchy_reformed
					has_reform = malacnar_republic_reform
				}
            }
            is_ruler_commanding_unit = yes
        }
        enemy_unit = {
			unit_owner = {
				country_event = { id = flavor_malacnar.2 }
			}
        }
		G32 = {
			country_event = { id = flavor_malacnar.3 } 
			add_country_modifier = { #Stops the ai/player from receiving multiple copies of the event
				name = g32_battleking_death_cd
				duration = -1
				hidden = yes
			}
		}
    }
	if = { #themarenn death of emperor casetin
		limit = {
			unit_owner = {
				OR = {
					tag = A95
					was_tag = A95
				}
				has_ruler_flag = a95_casetin_ruler
			}
			is_ruler_commanding_unit = yes
			location = {
				OR = {
					province_id = 267
					province_id = 333
					province_id = 900
					province_id = 269
					province_id = 575
					province_id = 917
					province_id = 266
					province_id = 268
				}
			}
		}
		unit_owner = {
			random = {
				chance = 35
				country_event = {
					id = flavour_themarenn.54
				}
			}
		}
	}
	if = {
		limit = {
			unit_owner = {
                tag = S23
                has_country_flag = s23_seble_ruler
            }
            is_ruler_commanding_unit = yes
		}
		if = {
			limit = {
				enemy_unit = {
					unit_owner = {
						tag = F29
					}
					is_ruler_commanding_unit = yes
				}
			}
			S23 = {
				set_country_flag = s23_f29_defeated
				country_event = { id = hisost.91 }
			}
		}
		if = {
			limit = {
				enemy_unit = {
					unit_owner = {
						tag = F46
					}
					is_ruler_commanding_unit = yes
				}
			}
			S23 = {
				set_country_flag = s23_f46_defeated
				country_event = { id = hisost.91 }
			}
		}
	}
	
	if = {
		limit = {
			enemy_unit = {
				unit_owner = {
					is_or_was_tag = { tag = I33 }
				}
				is_ruler_commanding_unit = yes
			}
			unit_owner = {
				capital_scope = { superregion = deepwoods_superregion }
				OR = {
					primary_culture = green_orc
					primary_culture = forest_goblin
					AND = {
						primary_culture = wood_elf
						I33 = { has_country_flag = I33_kill_count_versus_elves }
					}
				}
			}
			is_ruler_commanding_unit = yes	
		}
		unit_owner = {
			add_ruler_modifier = {
				name = I33_mortally_wounded
				duration = -1
			}
		}
		if = {
			limit = { unit_owner = { tag = I42 } }
			I33 = { country_event = { id = flavour_ayeth.7 } }
		}
	}


	if = {
		limit = {
			location = { is_sea = no } #Required to prevent crashes due to transports
			unit_owner = { has_cast_undead_army = yes }
		}
		location = { save_event_target_as = undead_location }
		unit_owner = { country_event = { id = magic_spell.703 } } #Stackwipe for undead army
	}
}

on_battle_won_country_effect = {
	if = {
		limit = {
			ROOT = { has_government_attribute = manpower_from_defeating_armies }
		}
		ROOT = {
			multiply_variable = {
				which = land_units_killed_var
				value = 0.1
			}
			while = {
				limit = {
					check_variable = {
						which = land_units_killed_var
						value = 1000
					}
				}
				subtract_variable = {
					which = land_units_killed_var
					value = 1000
				}
				add_manpower = 1
			}
			multiply_variable = {
				which = land_units_killed_var
				value = 1000
			}
			while = {
				limit = {
					check_variable = {
						which = land_units_killed_var
						value = 1000
					}
				}
				subtract_variable = {
					which = land_units_killed_var
					value = 1000
				}
				add_manpower = 0.001
			}
		}
	}
	if = {
		limit = { religion = goblinic_shamanism  NOT = { FROM = { OR = { tag = REB tag = NAT } } } }
		FROM = { goblinic_shamanism_event = yes } # Fires events for a cult spreading upon winning a battle
	}
	#ROOT = { country_event = { id = infestation_goblin.300 } } # post-rebellion cleanup
	ROOT = { jaddari_deioderan_battle_counter_update = { value = 1 } }
	if = {
		limit = { FROM = { NOT = { tag = REB tag = NAT } } }
		if = {	#for pdx num_of_battles scripted trigger. need to set the country_flag to begin counting
			limit = { OR = { has_country_flag = count_battles_won has_mission = shuvuush_to_ward } }
			change_variable = {
				which = num_of_battles_won_var
				value = 1
			}
		}
		centaur_battle_count_win = yes
		ogre_battle_count_win = yes
		vf_battle_count_win = yes

		if = {
			limit = { has_cast_undead_army = yes }
			set_variable = {
				which = raise_undead
				which = land_units_killed
			}
			change_variable = {
				which = raise_undead
				which = land_units_lost
			}
			country_event = { id = magic_spell.700 } # Undead manpower gain
		}

		#Anbennar
		centaur_battle_won = yes
	}
	if = { limit = { tag = I03 }
		country_event = { id = flavor_vazhatun.25 }
	}
	if = {
		limit = { is_subject_of_type = acolyte_dominion }
		change_variable = { aInfluence = 1 }
	}
	if = {
		limit = {
			NOT = { FROM = { tag = REB } }
			Z43 = { has_ruler_flag = sicrheior_son }
		}
		Z43 = {
			change_variable = { nbSonBattleWon = 1 }
			change_variable = { totalBattle = 1 }
			set_variable = {
				which = battleWinRate
				which = nbSonBattleWon
			}
			divide_variable = {
				which = battleWinRate
				which = totalBattle
			}
			multiply_variable = {
				which = battleWinRate
				value = 100
			}
		}
	}
	if = {
		limit = {
			tag = R08
			FROM = {
				OR = {
					tag = R07 #Rajnadhaga
					tag = R11 #Khadisrapur
					tag = R09 #Parraj
					tag = R34 #Kamapar
					tag = R10 #Sarnavan
					tag = R12 #Tilathi
				}
			}
		}
		change_variable = { which = tiltaghar_battles_ruin_kingdoms value = 1 }
	}

	if = { 
		limit = { 
			tag = F31 #Eduz-Vacyn
			FROM = { 
				OR = { 
					tag = F29 #Zokka
					tag = F46 #Jaddari
				}
			}
		}
		change_variable = { which = EduzVacynEnboldenEledas value = 1 }
	}
	if = {
		limit = { #Command is winning a war against a great power
			mission_completed = R62_one_great_command
			FROM = { is_great_power = yes }
			NOT = { has_country_flag = command_leadership_flag_@FROM }
			is_in_war = {
				attacker_leader = ROOT
				defender_leader = FROM
				war_score = 80
			}
		}
		set_country_flag = command_leadership_flag_@FROM
	}
	if = { # G53 - Empkeios Slave Rebellion win
		limit = {
			ROOT = {
				tag = G53
				has_country_flag = G53_Slave_Rebellion
			}
			NOT = {
				ROOT = {
					num_of_rebel_armies = 1
				}
			}
			NOT = {
				ROOT = {
					num_of_rebel_controlled_provinces = 1
				}
			}
		}
		G53 = {
			country_event = {
				id = empkeios_events.1306
			}
		}
	}
	if = {
		limit = {
			has_country_flag = G54_supporting_peasant_rebels_flag
			FROM = { tag = REB }
			NOT = {
				has_spawned_supported_rebels = U17 #Theinos
				has_spawned_supported_rebels = G54 #Besolaki
				war_with = U17 #Theinos
				war_with = G54 #Besolaki
			}
		}
		clr_country_flag = G54_supporting_peasant_rebels_flag
	}
	if = {
		limit = {
			religion = genie_cult
			has_country_flag = renewed_emancipation_active
		}
		add_manpower = 5
	}
	if = {
		limit = {
			has_country_flag = G64_sibling_rose_up_flag
			FROM = { tag = REB }
		}
		country_event = {
			id = larankar_events.110 #Sibling Escapes Hidden Event
			days = 7 #Need to wait a few days for 'NOT = { num_of_rebel_armies = 1 }' to trigger correctly
		}
	}
	if = {
		limit = {
			has_country_flag = G64_sibling_rose_up_again_flag
			FROM = { tag = REB }
		}
		country_event = {
			id = larankar_events.111 #Sibling War Ends Hidden Event
			days = 7 #Need to wait a few days for 'NOT = { num_of_rebel_armies = 1 }' to trigger correctly
		}
	}
	#Stalbor
	if = {
		limit = {
			has_country_flag = B47_elrac_in_rebellion
			FROM = { tag = REB }
		}
		country_event = {
			id = flavor_stalbor.6 
			days = 7 #Need to wait a few days for 'NOT = { num_of_rebel_armies = 1 }' to trigger correctly
		}
	}
	if = {
		limit = {
			has_country_flag = B47_deepwood_religious_revolt
			FROM = { tag = REB }
		}
		country_event = {
			id = flavor_stalbor.12
			days = 7 #Need to wait a few days for 'NOT = { num_of_rebel_armies = 1 }' to trigger correctly
		}
	}
	if = {
		limit = {
			overlord = {
				has_country_flag = B47_deepwood_religious_revolt
			}
			FROM = { tag = REB }
		}
		overlord = {
			country_event = {
				id = flavor_stalbor.12
				days = 7 #Need to wait a few days for 'NOT = { num_of_rebel_armies = 1 }' to trigger correctly
			}
		}
	}
	if = { 
		limit = { 
			tag = H66 #Jaherian Exemplars
			FROM = { 
				culture_group = taychendi_ruinborn_elf
			}
		}
		change_variable = { which = RezankandJahersDuty value = 1 }
	}
	if = { 
		limit = { 
			tag = H66 #Jaherian Exemplars
			FROM = {
				is_or_was_tag = { tag = G52 } #Ameion
			}
		}
		change_variable = { which = RezankandFirstClash value = 1 }
	}
	if = { 
		limit = { 
			tag = H67 #Rezankand
			FROM = { 
				OR = {
					culture_group = taychendi_ruinborn_elf
					culture_group = kheionai_ruinborn_elf
				}
			}
		}
		change_variable = { which = RezankandMarchingWest value = 1 }
	}
	if = {
		limit = {
			has_country_flag = awakened_lapnam
		}
		change_variable = {
			which = lapnam_amrik_battle_counter
			value = 1
		}
	}
	# Raj rework
	overlord = {
		PREV = {	#the shit I have to do - overlord in attacker_leader_doesn't work, global event targets do but throw errors
			if = {
				limit = {
					is_subject_of_type = great_daimyo_vassal
					OR = {
						is_in_war = { attacker_leader = PREV participants = THIS }
						is_in_war = { defender_leader = PREV participants = THIS }
					}
				}
				change_variable = { which = senapti_battles_won value = 1 }
			}
		}
	}

	if = { #vaengheim manpower return
		limit = {
			ROOT = { has_country_flag = Z88_manpower_recovery_from_battles }
		}
		ROOT = {
			set_variable = {
				which = land_units_lost_z88
				which = land_units_lost
			}
			divide_variable = {
				which = land_units_lost_z88
				value = 10
			}
			change_variable = {
				which = vaengheim_land_units_recovered_total
				which = land_units_lost_z88
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = Vaengheim_land_units_num_roosts_allowed
							value = 12
						}
					}
				}
				if = {
					limit = {
						check_variable = {
							which = vaengheim_land_units_recovered_total
							value = 20000
						}
					}
					set_variable = {
						which = Z88_land_units_calc
						which = vaengheim_land_units_recovered_total
					}
					divide_variable = {
						which = Z88_land_units_calc
						value = 20000
					}
					round_variable = {
						which = Z88_land_units_calc
						value = -1
					}
					change_variable = {
						which = Z88_land_units_calc
						value = 2
					}
					set_variable = {
						which = Vaengheim_land_units_num_roosts_allowed
						which = Z88_land_units_calc
					}
				}
				else_if = {
					limit = {
						check_variable = {
							which = vaengheim_land_units_recovered_total
							value = 10000
						}
					}
					set_variable = {
						which = Vaengheim_land_units_num_roosts_allowed
						value = 2
					}
				}
				else_if = {
					limit = {
						check_variable = {
							which = vaengheim_land_units_recovered_total
							value = 5000
						}
					}
					set_variable = {
						which = Vaengheim_land_units_num_roosts_allowed
						value = 1
					}
				}
			}
			divide_variable = {
				which = land_units_lost_z88
				value = 1000
			}
			var_effect_granular = { 
				effect = add_manpower 
				var = land_units_lost_z88 
				sign = + 
			}
		}
	}
	
	if = { #Parahechend
		limit = {
			is_or_was_tag = { tag = J81 } #Parahechend	
			FROM = { tag = G52 } #Ameion
		}
		country_event = { #Scythe and Terror
			id = parahechend_events.6
		}
	}

	#Tiboktsamo
	if = {
		limit = {
			is_or_was_tag = { tag = L53 }
			NOT = { FROM = { OR = { tag = REB tag = NAT } } }
		}
		country_event = { id = flavour_tiboktsamo.9 }
	}

	if = { #Rinta Seekers Incident - Light Up The Night Sky
		limit = {
			has_country_flag = rinta_active_cultists_flag
			FROM = { tag = REB }
		}
		country_event = {
			id = rinta_seeker_events.526 #The Terror-Filled Cult Is Rich
			days = 7 #Need to wait a few days for 'NOT = { num_of_rebel_armies = 1 }' to trigger correctly
		}
	}

	if = { #Xiaken mission
		limit = {
			FROM = { tag = R62 }
			has_mission = xiaken_true_skill
		}
		change_variable = { num_battles_won_against_command = 1 }
	}

	#salla drennen
	if = {
		limit = {
			tag = I28
		}
		if = {
			limit = {
				FROM = { 
					culture_group = orcish
				}
			}
			change_variable = {
				which = I28_orc_battles
				value = 1
			}
		}
	}
}

on_battle_lost_country_effect = {
	jaddari_deioderan_battle_counter_update = { value = -1 }

	if = {
		limit = { NOT = { FROM = { OR = { tag = REB tag = NAT } } } }
		centaur_battle_count_lost = yes
		aelnar_battle_count_lost = yes
	}
	if = {
		limit = { is_subject_of_type = acolyte_dominion }
		subtract_variable = { aInfluence = 1 }
		if = {
			limit = { NOT = { check_variable = { aInfluence = 0 } } }
			set_variable = { aInfluence = 0 }
		}
	}
	if = {
		limit = { 
			OR = {
				religion = gods_of_the_taychend 
				religion = oren_nayiru
			}
		}
		lose_taychend_glory_effect = { amount = 5 }
	}
	if = {
		limit = { #Command has started to lose against a great power
			has_country_flag = command_leadership_flag_@FROM
			NOT = {
				is_in_war = {
					attacker_leader = ROOT
					defender_leader = FROM
					war_score = 50
				}
			}
		}
		clr_country_flag = command_leadership_flag_@FROM
	}
	g27_civil_war_end_no_subject_effect = yes
	if = {
		limit = { tag = S93 has_global_flag = darkmagicks_flag }
		change_variable = {
			which = alefisol_lost_6
			value = 1
		}
	}

	if = { #vaengheim manpower return
		limit = {
			ROOT = { has_country_flag = Z88_manpower_recovery_from_battles }
		}
		ROOT = {
			set_variable = {
				which = land_units_lost_z88
				which = land_units_lost
			}
			divide_variable = {
				which = land_units_lost_z88
				value = 10
			}
			change_variable = {
				which = vaengheim_land_units_recovered_total
				which = land_units_lost_z88
			}
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = Vaengheim_land_units_num_roosts_allowed
							value = 12
						}
					}
				}
				if = {
					limit = {
						check_variable = {
							which = vaengheim_land_units_recovered_total
							value = 20000
						}
					}
					set_variable = {
						which = Z88_land_units_calc
						which = vaengheim_land_units_recovered_total
					}
					divide_variable = {
						which = Z88_land_units_calc
						value = 20000
					}
					round_variable = {
						which = Z88_land_units_calc
						value = -1
					}
					change_variable = {
						which = Z88_land_units_calc
						value = 2
					}
					set_variable = {
						which = Vaengheim_land_units_num_roosts_allowed
						which = Z88_land_units_calc
					}
				}
				else_if = {
					limit = {
						check_variable = {
							which = vaengheim_land_units_recovered_total
							value = 10000
						}
					}
					set_variable = {
						which = Vaengheim_land_units_num_roosts_allowed
						value = 2
					}
				}
				else_if = {
					limit = {
						check_variable = {
							which = vaengheim_land_units_recovered_total
							value = 5000
						}
					}
					set_variable = {
						which = Vaengheim_land_units_num_roosts_allowed
						value = 1
					}
				}
			}
			divide_variable = {
				which = land_units_lost_z88
				value = 1000
			}
			var_effect_granular = { 
				effect = add_manpower 
				var = land_units_lost_z88 
				sign = + 
			}
		}
	}
}

on_battle_won_province_effect = {
	if = {
		limit = {
			from = {
				tag = REB
				is_rebel_type = revolutionary_rebels
			}
			owner = {
				any_owned_province = {
					region = root
					has_revolution_in_province = yes
				}
				# NOT = { has_disaster = french_revolution }
				NOT = { has_disaster = revolution }
				NOT = { has_spawned_rebels = revolutionary_rebels }
			}
		}
		owner = { country_event = { id = center_of_revolution.1600 } }
	}

	#Anbennar
	if = {
		limit = {
			from = {
				tag = REB
				is_rebel_type = pretender_rebels
			}
			owner = {
				tag = A48
				has_disaster = sugamber_succession_war
			}
		}
		owner = { country_event = { id = flavor_sugamber.9 } }
	}

	if = { limit = { has_province_flag = nsc_duel } #Mages vs Artificers duel during the 'Rise of Artificery' NSC incident
		if = { limit = { NOT = { has_province_flag = nsc_duel_null } }
			if = { limit = { from = { tag = REB is_rebel_type = artificer_duelists_rebels } }
				owner = { country_event = { id = new_sun_cult.203 } }
			}
			if = { limit = { from = { tag = REB is_rebel_type = mage_duelists_rebels } }
				owner = { country_event = { id = new_sun_cult.204 } }
			}
		}
		else = {
			owner = { country_event = { id = new_sun_cult.205 } }
		}
	}

	if = {
		limit = {
			ROOT = {
				has_province_flag = G26_cursed_one_expedition
			}
			FROM = {
				has_country_flag = G26_gamer_time
			}
		}
		FROM = {
			country_event = {
				id = flavour_amacimst.102
			}
		}
	}

	if = {
		limit = {
			from = {
				tag = REB
				is_rebel_type = allclan_rabble
			}
			owner = {
				tag = I98
				check_variable = {
					which = tithicIncrement
					value = 1
				}
				NOT = {
					check_variable = {
						which = tithicIncrement
						value = 2
					}
				}
			}
		}
		I98 = { country_event = { id = allclan.23 } }
	}
	if = {
		limit = {
			from = {
				tag = REB
				is_rebel_type = allclan_rabble
			}
			owner = {
				tag = I98
				check_variable = {
					which = tithicIncrement
					value = 2
				}
				NOT = {
					check_variable = {
						which = tithicIncrement
						value = 3
					}
				}
			}
		}
		I98 = { country_event = { id = allclan.24 } }
	}
	if = {
		limit = {
			from = {
				tag = REB
				is_rebel_type = allclan_rabble
			}
			owner = {
				tag = I98
				check_variable = {
					which = tithicIncrement
					value = 3
				}
				NOT = {
					check_variable = {
						which = tithicIncrement
						value = 4
					}
				}
			}
		}
		I98 = { country_event = { id = allclan.25 } }
	}
	if = {
		limit = {
			from = {
				tag = REB
				is_rebel_type = allclan_rabble
			}
			owner = {
				tag = I98
				check_variable = {
					which = tithicIncrement
					value = 4
				}
				NOT = {
					check_variable = {
						which = tithicIncrement
						value = 5
					}
				}
			}
		}
		I98 = { country_event = { id = allclan.26 } }
	}
	if = {
		limit = {
			FROM = {
				tag = REB
				is_rebel_type = allclan_rabble
			}
			owner = {
				tag = I98
				check_variable = {
					which = tithicIncrement
					value = 5
				}
			}
		}
		I98 = { country_event = { id = allclan.27 } }
	}

	if = {
		limit = { 
			owner = {
				OR = {
					tag = Y17 #Gushuokguan
					was_tag = Y17 #Gushuokguan
				}
				any_hired_mercenary_company = {
					template = merc_dacite_dragons
					location = { province_id = ROOT }
				}
			}
			FROM = {
				tag = REB
				is_rebel_type = spirit_swarms 
			}
		}
		owner = {
			change_variable = {
				which = gushuokguan_dacite_dragons_death_toll
				which = land_units_killed
			}
		}
	}
	else_if = {
		limit = { 
			owner = {
				overlord = {
					OR = {
						tag = Y17 #Gushuokguan
						was_tag = Y17 #Gushuokguan
					}
					any_hired_mercenary_company = {
						template = merc_dacite_dragons
						location = { province_id = ROOT }
					}
				}
			}
			FROM = {
				tag = REB
				is_rebel_type = spirit_swarms 
			}
		}
		owner = {
			overlord = {
				set_variable = {
					which = land_units_killed
					which = PREV
				}
				change_variable = {
					which = gushuokguan_dacite_dragons_death_toll
					which = land_units_killed
				}
			}
		}
	}
	if = {
		limit = { 
			FROM = {
				tag = REB
				is_rebel_type = asarta_merfolk_rebels
			}
		}
		if = {
			limit = {
				owner = {
					has_country_flag = asarta_merfolk_rebels1 
				}
			}
			owner = {
				country_event = {
					id = asarta.5
				}
			}
		}
		else_if = {
			limit = {
				owner = {
					has_country_flag = asarta_merfolk_rebels2
				}
			}
			owner = {
				country_event = {
					id = asarta.7
				}
			}
		}
		owner = {
			clr_country_flag = asarta_merfolk_rebels1
			clr_country_flag = asarta_merfolk_rebels2 
		}
	}
	if = {
		limit = { 
			owner = {
				has_country_flag = asarta_remove_sep
			}
			FROM = {
				tag = REB #Must put REB in front of rebel type check, for error log reasons
				is_rebel_type = nationalist_rebels
			}
			owner = {
				NOT = {
					num_of_rebel_armies = 1
				}
			}
		}
		owner = {
			country_event = {
				id = asarta.17
			}
		}
	}
	if = {
		limit = { 
			has_ruler_leader_from = I33
			has_ruler_leader_from = I30
		}
		I33 = {
			country_event = {
				id = flavour_ayeth.16
			}
		}
	}
	

	if = { #Shuvuush generic missions
		limit = {
			FROM = { tag = REB is_rebel_type = face_stealers_rebels }
			owner = { has_mission = shuvuush_to_forget }
		}
		owner = { set_country_flag = has_defeated_face_stealer }
	}
}

on_battle_lost_province_effect = {
	# Crushing rebels trying to stop Silentblade's Emerald Orc ritual 
	if = {
		limit = {
			FROM = { tag = I43 }
			province_id = 6258
			NOT = { has_country_flag = silentblade_ritual_complete }
		}

		I43 = { country_event = { id = silentblade.5 } }
	}
	# Castanor disaster trigger enemy general capture event helper
	if = {
		limit = {
			FROM = {
				TAG = B32
				has_disaster = castanor_succession_war
			}
			ROOT = {
				NOT = {
					num_of_units_in_province = {
						who = B61
						amount = 1
					}
				}
			}
		}
		set_province_flag = castanor_stack_wipe
	}

	if = {
		limit = {
			ROOT = {
				has_province_flag = G26_cursed_one_expedition
			}
			FROM = {
				has_country_flag = G26_gamer_time
			}
		}
		FROM = {
			country_event = {
				id = flavour_amacimst.103
			}
		}
	}

	if = {
		limit = { 
			FROM = {
				tag = A77 #orda_aldresia
				any_hired_mercenary_company = {
					template = merc_rectorates_finest
					location = { province_id = ROOT }
				}
			}
		} 
		FROM = {
			add_papal_influence = 2
		}
	}

	if = {
		limit = { 
			FROM = {
				OR = {
					tag = Y17 #Gushuokguan
					was_tag = Y17 #Gushuokguan
				}
				any_hired_mercenary_company = {
					template = merc_rock_raiders
					location = { 
						province_id = ROOT
						has_underground_terrain = yes
					}
				}
			}
		} 
		FROM = {
			set_country_flag = gushuokguan_rock_raiders_battle
		}
	}
}

#1.35
on_battle_ended_effect = {
	ROOT = {
		change_variable = {
			which = total_land_units_killed
			which = land_units_killed
		}
		change_variable = {
			which = total_land_units_lost
			which = land_units_lost
		}
		change_variable = {
			which = total_naval_units_killed
			which = naval_units_killed
		}
		change_variable = {
			which = total_naval_units_lost
			which = naval_units_lost
		}
	}
}

#Province effect
# judaism_on_province_culture_converted_effect = {
# 	if = {
# 		limit = { has_province_modifier = judaism_community_wrong_culture }
# 		remove_province_modifier = judaism_community_wrong_culture
# 	}
# 	if = {
# 		limit = { has_province_modifier = judaism_community_same_culture_group }
# 		remove_province_modifier = judaism_community_same_culture_group
# 	}
# 	if = {
# 		limit = {
# 			religion = jewish
# 			owner = {
# 				has_church_aspect = judaism_communities_aspect
# 			}
# 		}
# 		if = {
# 			limit = {
# 				has_owner_accepted_culture = no
# 				has_owner_culture = no
# 				owner = { NOT = { culture_group = ROOT } }
# 			}
# 			add_province_modifier = {
# 				name = judaism_community_wrong_culture
# 				duration = -1
# 			}
# 		}
# 		if = {
# 			limit = {
# 				owner = {
# 					culture_group = ROOT
# 					has_cultural_union = yes
# 				}
# 				has_owner_accepted_culture = no
# 			}
# 			add_province_modifier = {
# 				name = judaism_community_same_culture_group
# 				duration = -1
# 			}
# 		}
# 	}
# }

on_religion_change_effect = {
	###removes catholic modifiers
	# 	remove_country_modifier = counter_reformation
	# 	remove_country_modifier = the_statue_in_restraint_of_appeals
	# 	remove_country_modifier = revocation_of_restraint_of_appeals
	# 	remove_country_modifier = bavarian_jesuits
	# 	remove_country_modifier = the_societas_jesu
	# 	remove_country_modifier = the_declaration_of_indulgence
	# 	remove_country_modifier = de_heretico_comburendo
	# 	remove_country_modifier = the_conventicle_act
	# if = {
	# 	limit = {
	# 		has_reform = indian_sultanate_reform
	# 		NOT = { religion_group = muslim }
	# 	}
	# 	remove_government_reform = indian_sultanate_reform
	# }

	# if = {
	# 	limit = {
	# 		has_reform = feudal_theocracy
	# 		NOT = { religion_group = muslim }
	# 		NOT = { religion_group = zoroastrian_group }
	# 	}
	# 	remove_government_reform = feudal_theocracy
	# }

	# if = {
	# 	limit = {
	# 		government = native
	# 		OR = {
	# 			religion = nahuatl
	# 			religion = mesoamerican_religion
	# 			religion = inti
	# 		}
	# 	}
	# 	change_government = monarchy
	# 	add_government_reform = autocracy_reform
	# }


	if = {
		limit = {
			has_heir = yes
		}
		set_heir_religion = ROOT
	}
	if = {
		limit = {
			has_regency = no
		}
		set_ruler_religion = ROOT
	}
	if = {
		limit = {
			has_dlc = "Rights of Man"
			has_consort = yes
		}
		set_consort_religion = ROOT
	}
	# if = {
	# 	limit = {
	# 		NOT = { religion = orthodox }
	# 	}
	# 	every_known_country = {
	# 		limit = {
	# 			reverse_has_opinion_modifier = {
	# 				who = ROOT
	# 				modifier = closed_down_the_patriarchate
	# 			}
	# 		}
	# 		reverse_remove_opinion = {
	# 			who = ROOT
	# 			modifier = closed_down_the_patriarchate
	# 		}
	# 	}
	# }
	# if = {
	# 	limit = {
	# 		religion = catholic
	# 		has_ruler_flag = personal_catholic_sympathies
	# 	}
	# 	country_event = { id = protestantism_events.19 }
	# }
	# if = {
	# 	limit = {
	# 		religion = protestant
	# 	}
	# 	set_country_flag = converted_to_protestantism
	# }
	# if = {
	# 	limit = {
	# 		religion = hussite
	# 	}
	# 	remove_country_modifier = hussite_persecution
	# }
	# if = {
	# 	limit = { has_country_modifier = bav_religious_mandate_mod }
	# 	remove_country_modifier = bav_religious_mandate_mod
	# }
	add_country_modifier = {
		name = recently_changed_religion_dummy
		duration = 10
		hidden = yes
	}
	# if = {
	# 	limit = {
	# 		NOT = { religion_group = muslim }
	# 		any_owned_province = { has_province_modifier = sufi_shrine }
	# 	}
	# 	every_owned_province = {
	# 		limit = { has_province_modifier = sufi_shrine }
	# 		remove_province_modifier = sufi_shrine
	# 	}
	# }
	# if = {
	# 	limit = {
	# 		religion = shamanism
	# 		has_country_modifier = son_fetishism_as_secondary_religion
	# 	}
	# 	remove_country_modifier = son_fetishism_as_secondary_religion
	# 	every_owned_province = {
	# 		limit = {
	# 			has_province_modifier = son_fetishism_as_secondary_religion_province
	# 		}
	# 		remove_province_modifier = son_fetishism_as_secondary_religion_province
	# 	}
	# }
	# if = { 
	# 	limit = { 
	# 		has_country_flag = fra_papal_lap_dop_flag 
	# 	}
	# 	clr_country_flag = fra_papal_lap_dop_flag 
	# 	set_country_flag = fra_chose_to_piss_off_pope_flag
	# 	swap_non_generic_missions = yes 
	# 	remove_country_modifier = fra_catholic_head_of_state_modifier 
	# 	remove_country_modifier = fra_fervent_call_to_arms_modifier 
	# 	clr_country_flag = enable_holy_orders_flag 
	# 	if = { 
	# 		limit = { 
	# 			KOJ = { is_subject_of = ROOT } 
	# 		}
	# 		KOJ = { add_liberty_desire = 25 } 
	# 	}
	# 	remove_country_modifier = fra_sword_of_christianity_modifier
	# 	remove_country_modifier = fra_sword_of_christianity_modifier2
	# 	remove_country_modifier = fra_sword_of_christianity_modifier3
	# 	remove_country_modifier = fra_sword_of_christianity_modifier4
	# 	remove_country_modifier = fra_sword_of_christianity_modifier5
	# 	remove_country_modifier = fra_jerusalem_modifier
	# }
	# if = {
	# 	limit = { 
	# 		has_government_mechanic = persian_influence_mechanic 
	# 		num_of_subjects = 1
	# 		any_subject_country = {
	# 			is_subject_of_type = cultural_sphere_of_influence_subject
	# 			NOT = { religion = root }
	# 		}
	# 	}
	# 	country_event = {
	# 		id = persian_influence_events.2000
	# 	}
	# }
	# if = {
	# 	limit = { 
	# 		is_subject = yes 
	# 		is_subject_of_type = cultural_sphere_of_influence_subject 
	# 		overlord = { NOT = { religion = root } }
	# 	}
	# 	country_event = {
	# 		id = persian_influence_events.1000
	# 	}
	# }
	if = { #Anbennar
		limit = { religion = kalyin_worshippers }
		kalyin_conversion = yes
	}
	if = {
		limit = {
			has_country_flag = kalyin_subject_flag
			NOT = { religion = kalyin_worshippers }
		}
		capital_scope = { change_religion = ROOT }
		kalyin_conversion = yes
	}
	if = {
		limit = { has_country_flag = owns_cannorian_holy_site }
		if = {
			limit = { has_country_flag = can_use_cannorian_holy_site }
			if = {
				limit = { can_use_cannorian_holy_site_trigger = no }
				clr_country_flag = can_use_cannorian_holy_site
				every_owned_province = {
					limit = { province_group = cannorian_holy_sites }
					make_cannorian_holy_site_inactive = yes
				}
			}
		}
		else_if = {
			limit = { can_use_cannorian_holy_site_trigger = yes }
			set_country_flag = can_use_cannorian_holy_site
			every_owned_province = {
				limit = { province_group = cannorian_holy_sites }
				make_cannorian_holy_site_active = yes
			}
		}
	}
	#simplified version of cannorian code above, unlikely than more than 1 such modifier will exist, if it does replace this code with one like above
	if = {
		limit = {
			976 = {
				owned_by = ROOT
			}
		}
		if = {
			limit = {
				religion = skaldhyrric_faith
			}
			976 = {
				remove_province_modifier = skaldol_temple_inactive
				add_permanent_province_modifier = {
					name = skaldol_temple
					duration = -1
				}
			}
		}
		else = {
			976 = {
				remove_province_modifier = skaldol_temple
				add_permanent_province_modifier = {
					name = skaldol_temple_inactive
					duration = -1
				}
			}
		}
	}

	if = {
		limit = { religion = devouring_path has_country_flag = owns_high_temple }
		every_owned_province = {
			limit = { has_province_modifier = corrupted_temple_complex_inactive religion = devouring_path }
			remove_province_modifier = corrupted_temple_complex_inactive
			add_permanent_province_modifier = { name = corrupted_temple_complex duration = -1 }
		}
	}
	else_if = {
		limit = { has_country_flag = owns_high_temple }
		every_owned_province = {
			limit = { has_province_modifier = corrupted_temple_complex }
			remove_province_modifier = corrupted_temple_complex
			add_permanent_province_modifier = { name = corrupted_temple_complex_inactive duration = -1 }
		}
	}

	if = {
		limit = {
			culture_group = mengi
			overlord = {
				religion = high_philosophy
				mission_completed = L62_rainbow_dawn_rising
			}
		}
		add_country_modifier = {
			name = L62_hp_loyalists
			duration = 18250
		}
		add_historical_friend = overlord
		overlord = { add_historical_friend = ROOT }
	}

	if = { #Someone should really combine these...
		limit = { religion = transmutative_path }
		set_country_flag = was_transmutative_path
	}
	else_if = {
		limit = { has_country_flag = was_transmutative_path }
		clr_country_flag = was_transmutative_path
		every_owned_province = {
			limit = { province_has_chi_wellspring_trigger = yes }
			transmutative_path_destroy_chi_wellspring_to_size_effect = yes
		}
	}

	if = {
		limit = { religion = devouring_path }
		set_country_flag = was_devouring_path
		assign_dvp_cultural_aspects = yes
	}
	else_if = {
		limit = { has_country_flag = was_devouring_path }
		clr_country_flag = was_devouring_path
		clear_dvp_cultural_aspects = yes
	}

	if = {
		limit = { religion_group = raheni }
		update_personal_visvatma = yes
	}
	else_if = {
		limit = { has_country_flag = was_raheni_religion }
		clr_country_flag = was_raheni_religion
		trigger_switch = {
			on_trigger = has_country_modifier
			visvatma_10_modifier = { remove_country_modifier = visvatma_10_modifier }
			visvatma_9_modifier = { remove_country_modifier = visvatma_9_modifier }
			visvatma_8_modifier = { remove_country_modifier = visvatma_8_modifier }
			visvatma_7_modifier = { remove_country_modifier = visvatma_7_modifier }
			visvatma_6_modifier = { remove_country_modifier = visvatma_6_modifier }
			visvatma_5_modifier = { remove_country_modifier = visvatma_5_modifier }
			visvatma_4_modifier = { remove_country_modifier = visvatma_4_modifier }
			visvatma_3_modifier = { remove_country_modifier = visvatma_3_modifier }
			visvatma_2_modifier = { remove_country_modifier = visvatma_2_modifier }
			visvatma_1_modifier = { remove_country_modifier = visvatma_1_modifier }
		}
		remove_country_modifier = HP_nam_labeda
		remove_country_modifier = HP_rule_mendab
		remove_country_modifier = HP_convoke_idisarindat
		remove_country_modifier = HP_proclaim_anjitaranga
		remove_country_modifier = HP_reorganise_chalanevaala
		remove_country_modifier = HP_meditation_on_simrals_mirror
		remove_country_modifier = HP_meditation_on_the_kamalkundal
	}

	if = {
		limit = { religion = suhans_praxis }
		set_country_flag = was_suhans_praxis
		every_owned_province = {
			limit = { province_group = raheni_school_origin_provinces }
			add_province_modifier = { name = raheni_school_origin_suhans_praxis duration = -1 }
		}
	}
	else_if = {
		limit = { has_country_flag = was_suhans_praxis }
		every_owned_province = {
			limit = { province_group = raheni_school_origin_provinces }
			remove_province_modifier = raheni_school_origin_suhans_praxis
		}
	}

	if = {
		limit = {
			ai = yes
			OR = { #Chi religions
				religion = accretive_path
				religion = transmutative_path
				religion = devouring_path
			}
		}
		add_country_modifier = { name = ai_church_power_bypass duration = -1 }
	}
	else_if = {
		limit = {
			has_country_modifier = ai_church_power_bypass
			NOT = {
				religion = accretive_path
				religion = transmutative_path
				religion = devouring_path
			}
		}
		remove_country_modifier = ai_church_power_bypass
	}

	if = {
		limit = {
			has_global_flag = rending_active
			OR = {
				capital_scope = {
					continent = asia
					NOT = { superregion = forbidden_lands_superregion }
				}
				num_of_owned_provinces_with = {
					value = 10
					continent = asia
					NOT = { superregion = forbidden_lands_superregion }
				}
			}
		}
		remove_country_modifier = rending_severe_global
		remove_country_modifier = rending_medium_global
		clr_country_flag = rending_ward_flag
		clr_country_flag = rending_appease_flag
		clr_country_flag = rending_corrupt_flag
		if = {
			limit = {
				OR = {
					religion = neokttareum
					religion = mystic_accord
				}
			}
			set_country_flag = rending_appease_flag

			add_country_modifier = {
				name = rending_medium_global
				duration = -1
			}
			country_event = { 
				id = rending.300
				days = 20
			}
		}
		if = { #Can't be an else-if because of scripted effect firing events
			limit = {
				OR = {
					religion = accretive_path
					religion = transmutative_path
				}
			}
			country_event = { id = spirits.704 days = 1 }
		}
		else_if = {
			limit = {
				religion = devouring_path
			}
			set_country_flag = rending_corrupt_flag
			
			add_country_modifier = {
				name = rending_severe_global
				duration = -1
			}
		}
		else_if = {
			limit = {
				NOT = { religion = neokttareum religion = mystic_accord } #Handled above
			}
			set_country_flag = rending_ward_flag

			add_country_modifier = {
				name = rending_severe_global
				duration = -1
			}
		}
	}

	#Taychend Religious Reforms
	if = {
		limit = { 
			NOT = {
				religion = gods_of_the_taychend
				religion = oren_nayiru
			}
			OR = {
				has_country_modifier = taychend_reform_1_mod
				has_country_modifier = taychend_reform_2_mod
				has_country_modifier = taychend_reform_3_mod
				has_country_modifier = taychend_reform_4_mod
				has_country_modifier = taychend_reform_5_mod
			}
		}
		remove_country_modifier = taychend_reform_1_mod
		remove_country_modifier = taychend_reform_2_mod
		remove_country_modifier = taychend_reform_3_mod
		remove_country_modifier = taychend_reform_4_mod
		remove_country_modifier = taychend_reform_5_mod
		clr_country_flag = taychendi_window_open
	}

	if = { #Oren Nayiru
		limit = {
			ai = no
			religion = oren_nayiru
		}
		set_global_flag = player_is_oren_nayiru_flag
	}

	if = { #Oren Nayiru
		limit = {
			has_global_flag = player_is_oren_nayiru_flag
			ai = no
			NOT = { religion = oren_nayiru }
			NOT = {
				any_country = {
					ai = no
					religion = oren_nayiru
				}
			}
		}
		clr_global_flag = player_is_oren_nayiru_flag
	}
	
	#Saqraxat
	if = {
		limit = { 
			has_province_modifier = L04_stubborn_gnolls
		}
		remove_province_modifier = L04_stubborn_gnolls
	}

	#Fangaulan Pantheon
	if = {
		limit = {
			religion = fangaulan_pantheon
		}
		if = {
			limit = {
				any_owned_province = {
					has_province_flag = fangaulan_pantheon_inactive_holy_site
				}
			}
			every_owned_province = {
				limit = {
					has_province_flag = fangaulan_pantheon_inactive_holy_site
				}
				fangaulan_pantheon_activate_holy_site = yes
			}
		}
		else = { fangaulan_pantheon_apply_holy_site_bonus = yes }
	}
	else_if = {
		limit = {
			any_owned_province = {
				has_province_flag = fangaulan_pantheon_active_holy_site
			}
		}
		every_owned_province = {
			limit = {
				has_province_flag = fangaulan_pantheon_active_holy_site
			}
			fangaulan_pantheon_deactivate_holy_site = yes
		}
	}
}


#Country effect
# judaism_on_religion_change_effect = {
# 	every_owned_province = {
# 		limit = {
# 			OR = {
# 				has_province_modifier = judaism_abrahamic_roots
# 				has_province_modifier = judaism_community_same_culture_group
# 				has_province_modifier = judaism_community_wrong_culture
# 			}
# 		}
# 		remove_province_modifier = judaism_abrahamic_roots
# 		remove_province_modifier = judaism_community_same_culture_group
# 		remove_province_modifier = judaism_community_wrong_culture
# 	}
# }

on_culture_demoted_effect_free_slot_removal = { #Deprecated as of 1.37
	if = { 
		limit = { 
			has_country_modifier = free_slot_for_$culture$ 
			NOT = { accepted_culture = $culture$ } 
			NOT = { primary_culture = $culture$ } 
		} 
		remove_country_modifier = free_slot_for_$culture$
	}
}

on_culture_demoted_effect_remove_all_free_slots = {
	#on_culture_demoted_effect_free_slot_removal = { culture = armenian }
	#on_culture_demoted_effect_free_slot_removal = { culture = georgian }
	#on_culture_demoted_effect_free_slot_removal = { culture = turkish }
	#on_culture_demoted_effect_free_slot_removal = { culture = al_iraqiya_arabic }
	#on_culture_demoted_effect_free_slot_removal = { culture = al_suryah_arabic }
}

#Country effect
on_culture_demoted_effect = {
	# if = {
	# 	limit = {
	# 		has_country_modifier = plc_polish_lithuanian_union
	# 		OR = {
	# 			AND = {
	# 				primary_culture = polish
	# 				NOT = { accepted_culture = lithuanian }
	# 			}
	# 			AND = {
	# 				primary_culture = lithuanian
	# 				NOT = { accepted_culture = polish }
	# 			}
	# 			AND = {
	# 				OR = {
	# 					NOT = { accepted_culture = lithuanian }
	# 					NOT = { accepted_culture = polish }
	# 				}
	# 				NOT = { primary_culture = polish }
	# 				NOT = { primary_culture = lithuanian }
	# 			}
	# 		}
	# 	}
	# 	remove_country_modifier = plc_polish_lithuanian_union
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = teu_pru_integration_of_the_poles
	# 		NOT = { accepted_culture = polish }
	# 		NOT = { primary_culture = polish }
	# 	}
	# 	remove_country_modifier = teu_pru_integration_of_the_poles
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = teu_pru_integration_of_the_ruthenians
	# 		NOT = { accepted_culture = polish }
	# 		NOT = { primary_culture = polish }
	# 	}
	# 	remove_country_modifier = teu_pru_integration_of_the_ruthenians
	# }	
	# if = {
	# 	limit = {
	# 		has_country_modifier = dan_estonian_culture_accepted
	# 		NOT = { accepted_culture = estonian }
	# 		NOT = { primary_culture = estonian }
	# 	}
	# 	remove_country_modifier = dan_estonian_culture_accepted
	# 	every_owned_province = {
	# 		limit = {
	# 			has_province_modifier = dan_estonian_support
	# 		}
	# 		remove_province_modifier = dan_estonian_support
	# 	}
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = tur_legitimate_roman_empire_modifier
	# 		OR = {
	# 			NOT = { accepted_culture = lombard }
	# 			NOT = { accepted_culture = tuscan }
	# 			NOT = { accepted_culture = sardinian }
	# 			NOT = { accepted_culture = romagnan }
	# 			NOT = { accepted_culture = ligurian }
	# 			NOT = { accepted_culture = venetian }
	# 			NOT = { accepted_culture = dalmatian }
	# 			NOT = { accepted_culture = neapolitan }
	# 			NOT = { accepted_culture = piedmontese }
	# 			NOT = { accepted_culture = umbrian }
	# 			NOT = { accepted_culture = sicilian }
	# 			NOT = { accepted_culture = maltese }
	# 		}
	# 	}
	# 	remove_country_modifier = tur_legitimate_roman_empire_modifier
	# 	remove_accepted_culture = lombard
	# 	remove_accepted_culture = tuscan
	# 	remove_accepted_culture = sardinian
	# 	remove_accepted_culture = romagnan
	# 	remove_accepted_culture = ligurian
	# 	remove_accepted_culture = venetian
	# 	remove_accepted_culture = dalmatian
	# 	remove_accepted_culture = neapolitan
	# 	remove_accepted_culture = piedmontese
	# 	remove_accepted_culture = umbrian
	# 	remove_accepted_culture = sicilian
	# 	remove_accepted_culture = maltese
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = tur_turkish_andalusian_relations_gra
	# 		NOT = { accepted_culture = turkish }
	# 	}
	# 	remove_country_modifier = tur_turkish_andalusian_relations_gra
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = tur_turkish_andalusian_relations_tur
	# 		NOT = { accepted_culture = andalucian }
	# 	}
	# 	remove_country_modifier = tur_turkish_andalusian_relations_tur
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = rus_west_slavic_union
	# 		OR = {
	# 			NOT = { accepted_culture = czech }
	# 			NOT = { accepted_culture = sorbian }
	# 			NOT = { accepted_culture = schlesian }
	# 			NOT = { accepted_culture = polish }
	# 		}
	# 	}
	# 	remove_country_modifier = rus_west_slavic_union
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = rus_carpathian_union
	# 		OR = {
	# 			NOT = { accepted_culture = hungarian }
	# 			NOT = { accepted_culture = romanian }
	# 			NOT = { accepted_culture = slovak }
	# 			NOT = { accepted_culture = transylvanian }
	# 		}
	# 	}
	# 	remove_country_modifier = rus_carpathian_union
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = rus_south_slavic_union
	# 		OR = {
	# 			NOT = { accepted_culture = bulgarian }
	# 			NOT = { accepted_culture = serbian }
	# 			NOT = { accepted_culture = bosnian }
	# 			NOT = { accepted_culture = slovene }
	# 			NOT = { accepted_culture = albanian }
	# 			NOT = { accepted_culture = croatian }
	# 		}
	# 	}
	# 	remove_country_modifier = rus_south_slavic_union
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = gbr_unified_british_isles_culture
	# 		OR = {
	# 			NOT = { accepted_culture = irish }
	# 			NOT = { accepted_culture = highland_scottish }
	# 		}
	# 	}
	# 	remove_country_modifier = gbr_unified_british_isles_culture
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = gbr_accepted_lowlands
	# 		OR = {
	# 			NOT = { accepted_culture = dutch }
	# 			NOT = { accepted_culture = flemish }
	# 		}
	# 	}
	# 	remove_country_modifier = gbr_accepted_lowlands
	# }
}

#Country effect
# judaism_on_culture_country_effect = {
# 	if = {
# 		limit = {
# 			has_church_aspect = judaism_communities_aspect
# 		}
# 		every_owned_province = {
# 			remove_province_modifier = judaism_community_wrong_culture
# 			remove_province_modifier = judaism_community_same_culture_group
# 		}
# 		every_owned_province = {
# 			limit = {
# 				religion = jewish
# 			}
# 			if = {
# 				limit = {
# 					NOT = { culture_group = ROOT }
# 					has_owner_accepted_culture = no
# 					has_owner_culture = no
# 				}
# 				add_province_modifier = {
# 					name = judaism_community_wrong_culture
# 					duration = -1
# 				}
# 			}
# 			else_if = {
# 				limit = {
# 					owner = {
# 						has_cultural_union = no
# 					}
# 					culture_group = ROOT
# 					has_owner_accepted_culture = no
# 				}
# 				add_province_modifier = {
# 					name = judaism_community_same_culture_group
# 					duration = -1
# 				}
# 			}
# 		}
# 	}
# }

#Province effect
imperial_modifiers_on_province_change_culture_or_change_owner_effect = {
	# if = {
	# 	limit = {
	# 		NOT = { has_province_modifier = kon_south_african_hegemony_province }
	# 		owner = {
	# 			has_country_modifier = kon_south_african_hegemony
	# 		}
	# 		has_owner_accepted_culture = no
	# 		OR = {
	# 			culture_group = southern_african
	# 			culture_group = african
	# 			culture_group = great_lakes_group
	# 		}
	# 	}
	# 	add_province_modifier = {
	# 		name = kon_south_african_hegemony_province
	# 		duration = -1
	# 	}
	# }
	# else_if = {
	# 	limit = {
	# 		has_province_modifier = kon_south_african_hegemony_province
	# 	}
	# 	remove_province_modifier = kon_south_african_hegemony_province
	# }
	# if = {
	# 	limit = {
	# 		NOT = { has_province_modifier = nor_scandinavian_empire_local }
	# 		owner = {
	# 			has_country_modifier = nor_scandinavian_empire
	# 		}
	# 		culture_group = scandinavian
	# 	}
	# 	add_province_modifier = {
	# 		name = nor_scandinavian_empire_local
	# 		duration = -1
	# 	}
	# }
	# else_if = {
	# 	limit = {
	# 		has_province_modifier = nor_scandinavian_empire_local
	# 	}
	# 	remove_province_modifier = nor_scandinavian_empire_local
	# }
	# if = {
	# 	limit = {
	# 		NOT = { has_province_modifier = sca_hegemony_over_germany_province }
	# 		culture_group = germanic
	# 		owner = {
	# 			has_country_modifier = sca_hegemony_over_germany
	# 			NOT = { culture_group = PREV }
	# 			NOT = { primary_culture = PREV }
	# 		}
	# 		has_owner_accepted_culture = no
	# 	}
	# 	add_province_modifier = {
	# 		name = sca_hegemony_over_germany_province
	# 		duration = -1
	# 	}
	# }
	# else_if = {
	# 	limit = {
	# 		NOT = { has_province_modifier = sca_hegemony_over_germany_province_same_culture }
	# 		culture_group = germanic
	# 		owner = {
	# 			has_country_modifier = sca_hegemony_over_germany
	# 			culture_group = PREV
	# 			NOT = { primary_culture = PREV }
	# 		}
	# 		has_owner_accepted_culture = no
	# 	}
	# 	add_province_modifier = {
	# 		name = sca_hegemony_over_germany_province_same_culture
	# 		duration = -1
	# 	}
	# }
	# else_if = {
	# 	limit = {
	# 		OR = {
	# 			has_province_modifier = sca_hegemony_over_germany_province
	# 			has_province_modifier = sca_hegemony_over_germany_province_same_culture
	# 		}
	# 	}
	# 	remove_province_modifier = sca_hegemony_over_germany_province
	# 	remove_province_modifier = sca_hegemony_over_germany_province_same_culture
	# }
}

#Country effect
imperial_modifiers_on_culture_country_effect = {
	# if = {
	# 	limit = {
	# 		any_owned_province = {
	# 			OR = {
	# 				has_province_modifier = kon_south_african_hegemony_province
	# 				has_province_modifier = nor_scandinavian_empire_local
	# 				has_province_modifier = sca_hegemony_over_germany_province
	# 				has_province_modifier = sca_hegemony_over_germany_province_same_culture
	# 			}
	# 		}
	# 	}
	# 	every_owned_province = {
	# 		remove_province_modifier = kon_south_african_hegemony_province
	# 		remove_province_modifier = nor_scandinavian_empire_local
	# 		remove_province_modifier = sca_hegemony_over_germany_province
	# 		remove_province_modifier = sca_hegemony_over_germany_province_same_culture
	# 	}
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = kon_south_african_hegemony
	# 	}
	# 	every_owned_province = {
	# 		limit = {
	# 			OR = {
	# 				culture_group = southern_african
	# 				culture_group = african
	# 				culture_group = great_lakes_group
	# 			}
	# 			NOT = { has_province_modifier = kon_south_african_hegemony_province }
	# 			has_owner_accepted_culture = no
	# 		}
	# 		add_province_modifier = {
	# 			name = kon_south_african_hegemony_province
	# 			duration = -1
	# 		}
	# 	}
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = sca_hegemony_over_germany
	# 	}
	# 	every_owned_province = {
	# 		limit = {
	# 			culture_group = germanic
	# 			NOT = { has_province_modifier = sca_hegemony_over_germany_province }
	# 			has_owner_accepted_culture = no
	# 			owner = {
	# 				NOT = { primary_culture = PREV }
	# 				NOT = { culture_group = PREV }
	# 			}
	# 		}
	# 		add_province_modifier = {
	# 			name = sca_hegemony_over_germany_province
	# 			duration = -1
	# 		}
	# 	}
	# 	every_owned_province = {
	# 		limit = {
	# 			culture_group = germanic
	# 			NOT = { has_province_modifier = sca_hegemony_over_germany_province_same_culture }
	# 			has_owner_accepted_culture = no
	# 			owner = {
	# 				NOT = { primary_culture = PREV }
	# 				culture_group = PREV
	# 			}
	# 		}
	# 		add_province_modifier = {
	# 			name = sca_hegemony_over_germany_province_same_culture
	# 			duration = -1
	# 		}
	# 	}
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = nor_scandinavian_empire
	# 	}
	# 	every_owned_province = {
	# 		limit = {
	# 			culture_group = scandinavian
	# 			NOT = { has_province_modifier = nor_scandinavian_empire_local }
	# 		}
	# 		add_province_modifier = {
	# 			name = nor_scandinavian_empire_local
	# 			duration = -1
	# 		}
	# 	}
	# }
}

#Country effect
imperial_modifiers_on_primary_culture_change_effect = {
	# if = {
	# 	limit = {
	# 		has_country_modifier = kon_south_african_hegemony
	# 		NOT = { culture_group = kongo_group }
	# 	}
	# 	remove_country_modifier = kon_south_african_hegemony
	# 	every_owned_province = {
	# 		limit = {
	# 			has_province_modifier = kon_south_african_hegemony_province
	# 		}
	# 		remove_province_modifier = kon_south_african_hegemony_province
	# 	}
	# }
	# every_owned_province = {
	# 	remove_province_modifier = sca_hegemony_over_germany_province
	# 	remove_province_modifier = sca_hegemony_over_germany_province_same_culture
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = sca_hegemony_over_germany
	# 	}
	# 	every_owned_province = {
	# 		limit = {
	# 			culture_group = germanic
	# 			NOT = { has_province_modifier = sca_hegemony_over_germany_province }
	# 			has_owner_accepted_culture = no
	# 			owner = {
	# 				NOT = { primary_culture = PREV }
	# 				NOT = { culture_group = PREV }
	# 			}
	# 		}
	# 		add_province_modifier = {
	# 			name = sca_hegemony_over_germany_province
	# 			duration = -1
	# 		}
	# 	}
	# 	every_owned_province = {
	# 		limit = {
	# 			culture_group = germanic
	# 			NOT = { has_province_modifier = sca_hegemony_over_germany_province_same_culture }
	# 			has_owner_accepted_culture = no
	# 			owner = {
	# 				NOT = { primary_culture = PREV }
	# 				culture_group = PREV
	# 			}
	# 		}
	# 		add_province_modifier = {
	# 			name = sca_hegemony_over_germany_province_same_culture
	# 			duration = -1
	# 		}
	# 	}
	# }
	# if = {
	# 	limit = {
	# 		has_country_modifier = nor_scandinavian_empire
	# 		NOT = { culture_group = scandinavian }
	# 	}
	# 	remove_country_modifier = nor_scandinavian_empire
	# 	every_owned_province = {
	# 		limit = {
	# 			has_province_modifier = nor_scandinavian_empire_local
	# 		}
	# 		remove_province_modifier = nor_scandinavian_empire_local
	# 	}
	# }
}

#EVERYTHING BELOW IS 1.35
on_war_declaration_effect = {
	random_list = {
		1 = {
			country_event = {
				id = new_court_flavour_events.21
			}
		}
		9 = {}
	}
	if = {
		limit = {
			has_estate_privilege = artifice_invention_allclan_stealth_gob
		}
		every_war_enemy_country = {
			limit = { ai = yes }
			remove_fow = 6
		}
	}

	if = {
		limit = {
			OR = {
				is_emperor = yes
				FROM = { is_emperor = yes }
			}
			A77 = {
				is_subject_of_type = imperial_bodyguard
				OR = {
					is_in_war = {
						attacker_leader = emperor
					}
					is_in_war = {
						defender_leader= emperor
					}
				}
			}
		}
		if = {
			limit = {
				A77 = {
					mission_completed = redeem_our_name
				}
				
			}
			A77 = {
				add_country_modifier = {
					name = A77_defending_empire_morale
					duration = 365
				}
			}
		}
		if = {
			limit = {
				A77 = {
					mission_completed = old_ways_and_the_new
				}
			}
			A77 = {
				add_country_modifier = {
					name = A77_defending_empire_recruitment
					duration = 1825
				}
			}
		}
		if = {
			limit = {
				A77 = {
					mission_completed = forms_eight_to_three
				}
			}
			A77 = {
				add_country_modifier = {
					name = A77_defending_empire_diranbe
					duration = 1825
				}
			}
		}
	}
	

	if = {
		limit = {
			tag = A77
			mission_completed = reign_in_the_knight_errants
			mission_completed = reign_in_the_knight_errants
			is_in_war = {
				attacker_leader = ROOT
				casus_belli = cb_imperial_ban
			}
		}
		A77 = {
			set_country_flag = imperial_ban_goody_rewards
		}
	}
	if = {
		limit = {
			has_country_flag = irkorzik_declare_war_on_gnollakaz
		}
		every_war_enemy_country = {
			limit = { 
				tag = U09
				ai = yes 
			}
			every_owned_province = {
				if = {
					limit = {
						religion_group = khetist
					}
					add_province_modifier = { name = irkorzik_local_treason duration = 7300 }
				}
			}
		}
		clr_country_flag = irkorzik_declare_war_on_gnollakaz
	}
	if = {
		limit = {
			has_government_attribute = fighting_war_increases_absolutism_effect
			is_monarch_leader = yes
			NOT = { has_country_modifier = blorc_ruler_shows_prowess }
		}
		add_country_modifier = {
			name = blorc_ruler_shows_prowess
			duration = -1
		}
	}
	if = {
		limit = { has_country_modifier = J33_resisting_the_command }
		remove_country_modifier = J33_resisting_the_command
	}
	if = {
		limit = {
			has_country_flag = feast_gods_need_to_declare_war
		}
		set_country_flag = feast_gods_war_declared
		clr_country_flag = feast_gods_need_to_declare_war
	}
	if = {
		limit = {
			NOT = { has_country_modifier = G79_thunderous_advance }
			has_country_flag = G79_thunderous_advance
		}
		add_country_modifier = {
			name = G79_thunderous_advance
			duration = 548
		}
	}
	if = {
		limit = {
			has_country_flag = active_frenzy_flg
			is_in_war = { casus_belli = cb_blood_frenzy }
		}
		every_neighbor_country = {
			reverse_remove_casus_belli = {
				target = ROOT
				type = cb_blood_frenzy
			}
		}
		clr_country_flag = active_frenzy_flg
	}
	if = { #Kherka
		limit = { has_country_flag = G48_odegaster_cogemos_enabled }
		add_country_modifier = {
			name = G48_odegaster_cogemos
			duration = 1825 #Days
		}
	}
	if = {
		limit = {
			is_or_was_tag = { tag = A81 } # Giberd
		}
		if = {
			limit = {
				FROM = {
					owns = 234 #Damescrown
				}
			}
			234 = {
				remove_province_modifier = giberd_damescrown_wind_tower
				owner = {
					add_opinion = {
						who = ROOT
						modifier = giberd_wind_tower_opinion_up
						years = 20
					}
				}
			}
			remove_country_modifier = giberd_damescrown_trade
		}
		else_if = {
			limit = {
				FROM = {
					owns = 9 #Moonisle
				}
				has_country_modifier = giberd_paying_the_moonisle
			}
			265 = {
				change_trade_goods = cloth
				clr_province_flag = permanent_damestear
				remove_province_modifier = giberd_damestear_port_high
			}
			remove_country_modifier = giberd_paying_the_moonisle
		}
		else_if = {
			limit = {
				FROM = {
					owns = 280 #Estallen
				}
				has_country_modifier = giberd_estallen_share
			}
			remove_country_modifier = giberd_estallen_share
			home_trade_node_effect_scope = {
				remove_trade_modifier = {
					who = ROOT
					key = giberd_estallen_trade_deal
				}
				remove_trade_modifier = {
					who = A93
					key = giberd_estallen_trade_deal
				}
				every_trade_node_member_province = {
					limit = { owned_by = A93 }
					remove_province_modifier = giberd_business_ventures
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					owns = 268 #Bennon
				}
				has_country_flag = giberd_bennon_forts_explode
			}
			clr_country_flag = giberd_bennon_forts_explode
			268 = {
				owner = {
					every_owned_province = {
						limit = {
							fort_level = 1
						}
						add_province_modifier = {
							name = giberd_options_war_bennon
							duration = 1825
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				FROM = {
					tag = A73 # Silverforge
				}
				has_country_flag = giberd_silverforge_hold_ongoing
			}
			# stop rebuilding the hold
			clr_country_flag = giberd_silverforge_hold_ongoing
			clr_country_flag = giberd_silverforge_hold_adm_1
			clr_country_flag = giberd_silverforge_hold_adm_2
			clr_country_flag = giberd_silverforge_hold_dip_1
			clr_country_flag = giberd_silverforge_hold_dip_2
			clr_country_flag = giberd_silverforge_hold_mil_1
			clr_country_flag = giberd_silverforge_hold_mil_2
			clr_country_flag = giberd_silverforge_hold_work_done
		}

	}

	if = { #Yinquan/Lingyuk
		limit = {
			mission_completed = Y26_onwards_lingyuk
			OR = {
				is_in_war = {
					casus_belli = cb_rending
				}
				is_in_war = {
					casus_belli = cb_eternal_blossom
				}
			}
			NOT = { has_country_modifier = Y26_onwards_lingyuk_mod }
		}
		add_country_modifier = {
			name = Y26_onwards_lingyuk_mod
			duration = -1
		}
	}

	if = {
		limit = {
			has_reform = rally_to_the_roar #ashhana lizardfolk reform
		}
		add_manpower = 5
	}

	if = {	#expand the war against raj
		limit = {
			ai = no
			FROM = { is_subject_of_the_raja = yes }
			NOT = {
				overlord = { has_government_attribute = is_raja }
			}
		}
		FROM = { save_event_target_as = prabhi_victim }
		country_event = {
			id = rahenraj.5010
			days = 1
		}
	}
	
	if = {
		limit = {
			tag = F66
			empire_of_china_has_active_decree = annihilation_decree
		}
		FROM = {
			country_event = {
				id = flavor_konolkhatep.301
			}
		}
	}

	#Runefather events
	if = {
		limit = { religion = runefather_worship }
		
		country_event = { id = runefather_worship.61 } #Runefather dwarves
		country_event = { id = runefather_worship.62 } #Runefather goblins
		country_event = { id = runefather_worship.63 } #Runefather orcs
		country_event = { id = runefather_worship.64 } #Runefather kobolds
	}
}

remove_all_age_of_discovery_modifiers = {
	# if = {
	# 	limit = {
	# 		NOT = { current_age = age_of_discovery }
	# 	}
	# 	if = {
	# 		limit = { has_country_modifier = eng_a_house_united }
	# 		remove_country_modifier = eng_a_house_united
	# 	}
	# 	if = {
	# 		limit = { has_country_modifier = eng_jousting_tournaments }
	# 		remove_country_modifier = eng_jousting_tournaments
	# 	}
	# }
	
	#Anbennar
	if = {
		limit = {
			NOT = { current_age = age_of_discovery }
		}
		#Vuls Tenvach
		if = {
			limit = { has_country_modifier = G79_the_storm_approaches }
			remove_country_modifier = G79_the_storm_approaches
		}
		#Luna River Minors
		if = {
			limit = { has_country_modifier = LRM_ready_aim_fire }
			remove_country_modifier = LRM_ready_aim_fire
		}
		#Centaur MT
		if = {
			limit = { has_country_modifier = centaur_valorous_caehnate }
			remove_country_modifier = centaur_valorous_caehnate
		}
		if = { 
			limit = { 1001 = { has_province_modifier = z22_last_homely_harbour } }
			1001 = { remove_province_modifier = z22_last_homely_harbour }
		}
	}
}
remove_all_age_of_reformation_modifiers = {
	# if = {
	# 	limit = {
	# 		NOT = { current_age = age_of_reformation }
	# 	}
	# 	if = {
	# 		limit = { has_country_modifier = eng_the_age_of_reformation }
	# 		remove_country_modifier = eng_the_age_of_reformation
	# 	}
	# 	if = {
	# 		limit = { has_country_modifier = eng_reformer_ruler }
	# 		remove_country_modifier = eng_reformer_ruler
	# 	}
	# 	if = {
	# 		limit = { has_country_modifier = eng_catholic_ruler }
	# 		remove_country_modifier = eng_catholic_ruler
	# 	}
	# 	if = {
	# 		limit = { has_country_modifier = eng_tolerant_ruler }
	# 		remove_country_modifier = eng_tolerant_ruler
	# 	}
	# 	if = {
	# 		limit = { has_country_modifier = eng_reformer_ruler_for_catholic_gb }
	# 		remove_country_modifier = eng_reformer_ruler_for_catholic_gb
	# 	}
	# 	if = {
	# 		limit = { has_country_modifier = eng_catholic_ruler_for_reformed_gb }
	# 		remove_country_modifier = eng_catholic_ruler_for_reformed_gb
	# 	}
	# }

	#Anbennar
	if = {
		limit = {
			NOT = { current_age = age_of_reformation }
		}
		#Centaur MT
		if = {
			limit = { has_country_modifier = centaur_valorous_caehnate }
			remove_country_modifier = centaur_valorous_caehnate
		}
	}
}
remove_all_age_of_absolutism_modifiers = {
	#Anbennar
	if = {
		limit = {
			NOT = { current_age = age_of_absolutism }
		}
		#Centaur MT
		if = {
			limit = { has_country_modifier = centaur_valorous_caehnate }
			remove_country_modifier = centaur_valorous_caehnate
		}
	}
}
remove_all_age_of_revolution_modifiers = {
	#Anbennar
	if = {
		limit = {
			NOT = { current_age = age_of_revolutions }
		}
		#Centaur MT
		if = {
			limit = { has_country_modifier = centaur_valorous_caehnate }
			remove_country_modifier = centaur_valorous_caehnate
		}
	}
}

set_age_passed_global_flag = {
	if = {
		limit = {
			not = { current_age = age_of_discovery }
			or = {
				current_age = age_of_reformation
				current_age = age_of_absolutism
				current_age = age_of_revolutions
			}
		}
		set_global_flag = age_of_discovery_passed
	}
	if = {
		limit = {
			has_global_flag = age_of_discovery_passed
			not = { current_age = age_of_reformation }
			or = {
				current_age = age_of_absolutism
				current_age = age_of_revolutions
			}
		}
		set_global_flag = age_of_reformation_passed
	}
	if = {
		limit = {
			has_global_flag = age_of_discovery_passed
			has_global_flag = age_of_reformation_passed
			not = { current_age = age_of_absolutism }
			current_age = age_of_revolutions
		}
		set_global_flag = age_of_absolutism_passed
	}
	if = {
		limit = {
			has_global_flag = age_of_discovery_passed
			has_global_flag = age_of_reformation_passed
			has_global_flag = age_of_absolutism_passed
			not = { current_age = age_of_revolutions }
		}
		set_global_flag = age_of_revolutions_passed
	}
}

remove_all_age_timed_modifiers = {
	remove_all_age_of_discovery_modifiers = yes
	remove_all_age_of_reformation_modifiers = yes
	remove_all_age_of_absolutism_modifiers = yes
	remove_all_age_of_revolution_modifiers = yes
	# Generic ones
	# if = { 
	# 	limit = { has_country_modifier = jap_stability_edo_period_modifier }
	# 	remove_country_modifier = jap_stability_edo_period_modifier 
	# }
}

#You need to manually remove this modifiers in the above scripted effect by age
add_country_modifier_for_age = {
	if = {
		limit = {
			NOT = { has_global_flag = $age$_passed }
		}
		add_country_modifier = {
			name = $name$
			duration = -1
			desc = until_end_of_$age$_desc
		}
	}
	[[else]
		else = {
			$else$
		}
	]
}

on_parliament_abolished_effect = {
	custom_tooltip = on_parliament_abolished_effect_tt
	hidden_effect = {

	}
}

set_parliament_action_flag = {
	hidden_effect = {
		set_country_flag = $parliament_action$_flag
	}
}

on_harmonized_effect = {
	if = {
		limit = {
			has_government_attribute = full_loyalty_on_harmonization
		}
		add_estate_loyalty = {
			estate = estate_church
			loyalty = 100
		}
		add_adm_power = 50
	}
	if = {
		limit = { has_country_flag = J33_assembled_flag }
		every_subject_country = {
			limit = { religion = kalyin_worshippers }
			kalsyto_pan_harmonize = yes
		}
	}
	if = {
		limit = { religion = the_thought }

		if = {
			limit = { any_subject_country = { religion = the_thought } }
			country_event = { id = thought_harmonize.203 }
		}
		if = {
			limit = { is_subject = yes overlord = { religion = the_thought } }
			overlord = { country_event = { id = thought_harmonize.203 } }
		}
	}
}

clear_harmonization_flags = {
	clr_country_flag = harmonization_empowering_ceremonies
	clr_country_flag = harmonization_fate_of_advisor
	clr_country_flag = harmonization_han_kitab
	clr_country_flag = harmonization_shangdi_conflict
	clr_country_flag = harmony_book_timer
}

on_province_culture_change_effect = {
	
	if = {
		limit = {
			owner = { has_country_flag = phoenix_empire_the_sun_outshines_the_moon_flag }
			has_province_modifier = phoenix_empire_the_sun_outshines_the_moon
			culture = sun_elf
		}
		hidden_effect = {
			remove_province_modifier = phoenix_empire_the_sun_outshines_the_moon
			owner = { add_adm_power = 25 }
		}
	}
	if = {
		limit = {
			has_province_modifier = Z26_axzo_vurte
			NOT = { culture = greenscale_kobold }
		}
		remove_province_modifier = Z26_axzo_vurte
	}

	if = {
		limit = {
			owner = { tag = B32 }
			OR = {
				has_province_modifier = castanor_culture_convert_100
				has_province_modifier = castanor_culture_convert_95
				has_province_modifier = castanor_culture_convert_90
				has_province_modifier = castanor_culture_convert_85
				has_province_modifier = castanor_culture_convert_80
				has_province_modifier = castanor_culture_convert_75
			}
			culture = castanorian
		}
		hidden_effect = {
			remove_province_modifier = castanor_culture_convert_100
			remove_province_modifier = castanor_culture_convert_95
			remove_province_modifier = castanor_culture_convert_90
			remove_province_modifier = castanor_culture_convert_85
			remove_province_modifier = castanor_culture_convert_80
			remove_province_modifier = castanor_culture_convert_75
		}
	}

	if = {
		limit = {
			owner = { tag = Y01 }
			OR = {
				has_province_modifier = azjakuma_birb_rejection
				has_province_modifier = azjakuma_birb_caution
			}
			NOT = {
				culture = shuvuush
			}
		}
		remove_province_modifier = azjakuma_birb_rejection
		remove_province_modifier = azjakuma_birb_caution
	}

	if = {
		limit = { owner = { has_country_flag = siadan_harimari_autonomy } }
		if = {
			limit = { culture_is_harimari = yes }
			add_province_modifier = {
				name = siadan_harimari_autonomy
				duration = -1
			}
		}

		if = {
			limit = { NOT = { culture_is_harimari = yes } }
			remove_province_modifier = siadan_harimari_autonomy
		}
	}

	#Ynn
	province_event = { id = ynn_events.23 }	#Pomentere Estates modifier
	# Amacimst Culture converting
	if = {
		limit = {
			owner = {
				OR = {
					has_country_flag = G26_lordly_oversight_flag
					overlord = {
						has_country_flag = G26_lordly_oversight_flag
					}
				}
			}
			OR = {
				culture = dolindhan
				culture = sarda
			}
		}
		add_province_modifier = {
			name = G26_lordly_oversight
			duration = -1
		}	
	}
	else_if = {
		limit = {
			owner = {
				OR = {
					has_country_flag = G26_traditional_ynnic_values_flag
					overlord = {
						has_country_flag = G26_traditional_ynnic_values_flag
					}
				}
			}
			OR = {
				culture = dolindhan
				culture = sarda
			}
		}
		add_province_modifier = {
			name = G26_traditional_ynnic_values
			duration = -1
		}	
	}

	#Drozma TUr
	if = {
		limit = {
			owner = {
				religion = drozma_tur
				has_church_aspect = spirit_introspection_aspect
			}
		}
		if = {
			limit = {
				owner = {
					NOT = {
						has_church_aspect = community_triumph_aspect_dip
					}
				}
			}
			set_province_flag = dt_province_converted_flag
		}
		else_if = {
			limit = {
				owner = {
					has_church_aspect = community_triumph_aspect_dip
				}
				NOT = {
					has_province_modifier = dt_community_triumph_buff
				}
			}
			add_province_modifier = {
				name = dt_community_triumph_buff
				duration = -1
			}
		}
	}

	#Ameion
	if = {
		limit = { owner = { has_country_flag = ameion_fotistrepei_flag } }
		ameion_fotistrepei_effect_prov = yes
	}
	if = {
		limit = {
			owner = { has_country_flag = ameion_kheionization }
			superregion = taychend_superregion
			NOT = {
				area = caergaraen_area
				area = rakkabuttai_area 
				area = zaernmaera_area
				area = oremvand_area
				area = ameionavil_area
			}
			culture_group = kheionai_ruinborn_elf
			NOT = { culture = klereyen }
		}
		change_culture = klereyen
	}
	if = {
		limit = {
			owner = { has_country_flag = ameion_kheionization }
			OR = {
				region = chendhya_region
				region = mteibas_valley_region
				area = caergaraen_area
				area = rakkabuttai_area 
				area = zaernmaera_area
				area = oremvand_area
			}
			culture_group = kheionai_ruinborn_elf
			NOT = { culture = astolbhen }
		}
		change_culture = astolbhen
	}
	#luciande orc hunting
	if = {
		limit = {
			province_id = 355
			NOT = { culture = green_orc }
		}
		remove_province_modifier = B34_orc_hunting_grounds
	}

	#Y91 - Y98 - Nuugdan Tsarai - Daxugo - Remove in next update
	if = {
		limit = { owner = { mission_completed = Y98_expand_the_bureaucracy } }
		if = {
			limit = { culture = daxug }
			add_province_modifier = {
				name = Y98_daxug_administrators
				duration = -1
			}
		}
		else = { remove_province_modifier = Y98_daxug_administrators }
	}
	
	#Daxugo capstone culture conversion effect - Y98 - Y91
	if = {
		limit = {
			owner = { has_reform = halessi_hegemon_reform }
			has_owner_culture = yes
		}
		if = {
			limit = {
				development = 10
			}
			owner = {
				add_prestige = 4
				add_absolutism = 4
			}
		}
		else = {
			owner = {
				add_prestige = 2
				add_absolutism = 2
			}
		}
		add_province_triggered_modifier = daxugo_capstone_effect
	}


	if = {	
		limit = {
			province_group = fey_abundant_goods_provinces
			NOT = { owner = { mission_completed = Z54_turn_their_magic_against_them } } # Karakhanbar
		}
		if = {	#If you're friends with the fey you get good stuff
			limit = {			
				is_fey_attuned_culture = yes
				NOT = { owner = { has_country_flag = abundant_goods_improved } }
			}
			remove_province_modifier = fey_dummy_goods
			remove_province_modifier = fey_abundant_goods_improved
			add_permanent_province_modifier = {
				name = fey_abundant_goods
				duration = -1
			}
		}
		else_if = {	#If you've improved your abundant goods in mission tree you get this
			limit = {
				is_fey_attuned_culture = yes
				owner = { has_country_flag = abundant_goods_improved }
			}
			remove_province_modifier = fey_dummy_goods
			remove_province_modifier = fey_abundant_goods
			add_permanent_province_modifier = {
				name = fey_abundant_goods_improved
				duration = -1
			}
		}
		else_if = {	#If you're not friends with the fey you get nothing
			limit = {
				province_group = fey_abundant_goods_provinces
				is_fey_attuned_culture = no
			}
			remove_province_modifier = fey_abundant_goods
			remove_province_modifier = fey_abundant_goods_improved
			add_permanent_province_modifier = {
				name = fey_dummy_goods
				duration = -1
			}
		}
	}
	if = {
		limit = {
			owner = { has_government_attribute = cheaper_goblin_governance }
			culture_group = goblin
			NOT = { has_province_modifier = goblin_citizens }
		}
		add_province_modifier = {
			name = goblin_citizens
			duration = -1
		}
	}
	else = {
		remove_province_modifier = goblin_citizens
	}
	#Command Post-Edict-of-X Laws of Ninun
	if = {
		limit = {
			owner = { tag = R62 has_global_flag = R62_the_edict_of_x_flag }
			NOT = { has_province_modifier = command_not_yet_wuhyunized_mod }
			command_not_yet_wuhyunized = yes
		}
		add_province_modifier = {
			name = command_not_yet_wuhyunized_mod
			duration = -1
		}
	}
	else_if = {
		limit = {
			has_province_modifier = command_not_yet_wuhyunized_mod
			command_not_yet_wuhyunized = no
		}
		remove_province_modifier = command_not_yet_wuhyunized_mod
	}


	# Reduced gov cap in primary culture
	if = {
		limit = { owner = { has_government_attribute = reduced_gov_cost_in_primary_culture } }
		if = {
			limit = { has_owner_culture = yes }
			add_province_modifier = {
				name = cultural_colonies_mod
				duration = -1
			}
		}
		else = {
			if = {
				limit = { has_province_modifier = cultural_colonies_mod }
				remove_province_modifier = cultural_colonies_mod
			}
		}
	}

	if = {
		limit = { has_province_flag = crimson_height_flag }
		if = {
			limit = { culture = blooded_orc }
			add_province_modifier = {
				name = mb_crimson_heights
				duration = -1
			}
		}
		else = {
			remove_province_modifier = mb_crimson_heights
		}
	}
	#Strenghten Elven Privilleges
	if = {
		limit = { owner = { has_reform = strengthen_elves_privileges } }
		if = {
			limit = { culture = moon_elf }
			add_province_modifier = {
				name = gov_moon_elf_tolerance
				duration = -1
			}
		}
		else_if = {
			limit = { has_province_modifier = gov_moon_elf_tolerance }
			remove_province_modifier = gov_moon_elf_tolerance
		}
	}	
	if = {
		limit = { has_province_flag = flooded_province }
		if = {
			limit = {
				has_province_modifier = flooded_province
				culture = mossmouth_ogre
				owner = { culture = mossmouth_ogre }
			}
			remove_province_modifier = flooded_province
			add_permanent_province_modifier = { name = flooded_province_inactive duration = -1 }
		}
		else_if = {
			limit = {
				has_province_modifier = flooded_province_inactive
				NOT = { culture = mossmouth_ogre }
			}
			remove_province_modifier = flooded_province_inactive
			add_permanent_province_modifier = { name = flooded_province duration = -1 }
		}
	}

	#sponsored adventurers
	if = {
		limit = {
			has_owner_culture = yes
			owner = {
				has_government_attribute = reform_progress_from_conversion
			}
			NOT = { has_province_flag = reform_progress_from_culture_conversion }
		}
		owner = {
			change_government_reform_progress = 10
		}
		set_province_flag = reform_progress_from_culture_conversion
	}
	
	#Eltikanized Taychendi
	if = {
		limit = {
			owner = {
				culture_group = eltibhari_ruinborn_elf
			}
			culture = macamairghe
		}
		add_province_modifier = { name = eltikan_macamairghe duration = -1 hidden = yes }
	}
	else = {
		remove_province_modifier = eltikan_macamairghe
	}

	#Pashaine
	if = {
		limit = {
			has_province_modifier = pashaine_successors_of_vernmen_mod
			NOT = { culture = vernman }
		}
		remove_province_modifier = pashaine_successors_of_vernmen_mod
	}

	#celmaldor
	if = {
		limit = {
			owner = {
				has_estate_privilege = z22_commercial_tongue_privilege
			}
			development = 10
		}
		if = {
			limit = {
				owner = {
					mission_completed = z22_rights_of_man
				}
			}
			if = {
				limit = {
					culture = blue_reachman
				}
				remove_province_modifier = z22_commercial_language_notblue_2
				add_province_modifier = {
					name = z22_commercial_language_blue_2
					duration = -1
				}
			}
			else = {
				if = {
					limit = {
						has_province_modifier = z22_commercial_language_blue_2
					}
					remove_province_modifier = z22_commercial_language_blue_2
					add_province_modifier = {
						name = z22_commercial_language_notblue_2
						duration = -1
					}
				}
			}
		}
		else = {
			if = {
				limit = {
					culture = blue_reachman
				}
				remove_province_modifier = z22_commercial_language_notblue_1
				add_province_modifier = {
					name = z22_commercial_language_blue_1
					duration = -1
				}
			}
			else = {
				if = {
					limit = {
						has_province_modifier = z22_commercial_language_blue_1
					}
					remove_province_modifier = z22_commercial_language_blue_1
					add_province_modifier = {
						name = z22_commercial_language_notblue_1
						duration = -1
					}
				}
			}
		}
	}

	#Lizardfolk Reclamation
	if = {
		limit = { 
			has_province_modifier = 333_lizardfolk_reclamation 
			culture_group = lizardfolk
		}
		remove_province_modifier = 333_lizardfolk_reclamation
		add_base_tax = 1
		add_base_production = 1
		add_base_manpower = 1
		add_devastation = -15
		if = {
			limit = { 
				owner = { 
					mission_completed = khatalashya_we_used_to_live_here 
				} 
			}
			change_culture = ahzdara_lizardfolk
		}
	}
	if = {
		limit = { 
			has_province_modifier = 333_lizardfolk_reclamation_but_for_halflings
			culture_group = lizardfolk
		}
		remove_province_modifier = 333_lizardfolk_reclamation_but_for_halflings
		change_culture = itayzemby_lizardfolk
	}
	
	#Konolkhatep
	if = {
		limit = {
			owner = { tag = F66 }
			empire_of_china_reform_passed = medasi_peak_civilization_reform
		}
		if = {
			limit = {
				OR = {
					culture = sorrowmane_gnoll
					culture_group = kheteratan
				}
			}
			add_province_modifier = {
				name = medasi_peak_civilization_reform_modifier
				duration = -1
				hidden = yes
			}
		}
		else = {
			remove_province_modifier = medasi_peak_civilization_reform_modifier
		}
	}
}

on_province_culture_converted_effect = {
	owner = {
		change_variable = {
			which = num_converted_culture
			value = 1
		}
	}
	if = {
		limit = { has_owner_culture = yes }
		owner = {
			change_variable = {
				which = num_converted_to_own_culture
				value = 1
			}
		}
	}
	if = {
		limit = {
			owner = {
				has_country_flag = arm_coversion_bonus
			}
			has_owner_culture = yes
			NOT = {
				has_province_flag = arm_converted_bonus
			}
		}
		add_base_tax = 1
		add_base_manpower = 1
		add_base_production = 1
		set_province_flag = arm_converted_bonus
	}
}

on_colony_finished_effect = {
	# if = {
	# 	limit = {
	# 		owner = {
	# 			OR = {
	# 				has_country_modifier = colonial_venture_act_modifier
	# 				has_country_flag = can_select_trade_goods_for_colonies
	# 				has_government_attribute = selectable_trade_goods_for_colonies
	# 			}
	# 			NOT = { has_country_flag = eng_disabled_colonial_ventures }
	# 		}
	# 		NOT = { has_province_flag = had_trade_good_change_event }
	# 	}
	# 	set_province_flag = had_trade_good_change_event
	# 	province_event = {
	# 		id = flavor_gbr.200
	# 	}
	# }

	#Urdea Samrad Haraf colony
	if= {
		limit = {
			has_global_flag = urdea_samrad_released
			colonial_region = colonial_haraf
			owner = { overlord_of = U42 }
			OR = {
				U42 = { is_subject_of_type = colony }
				U42 = { is_subject_of_type = crown_colony }
				U42 = { is_subject_of_type = private_enterprise }
				U42 = { is_subject_of_type = self_governing_colony }
			}
		}
		cede_province = U42
	}

	if = {
		limit = {
			owner = { has_estate_privilege = estate_nobles_tribes_tame_the_frontier_privilege }
			OR = {
				region = yyl_moista_region
				region = northern_pass_region
				superregion = gerudia_superregion
			}
		}
		add_province_modifier = {
			name = estate_tame_the_frontier_new_colony_mod
			duration = 18250 # 50 years
		}
		remove_province_modifier = estate_tame_the_frontier_discount_mod
	}
	
	#Seraeddun CN
	if= {
		limit = {
			OR = {
				culture = fograc
				province_group = fograc_provinces
			}
			owner = { overlord_of = U43 }
			OR = {
				U43 = { is_subject_of_type = colony }
				U43 = { is_subject_of_type = crown_colony }
				U43 = { is_subject_of_type = private_enterprise }
				U43 = { is_subject_of_type = self_governing_colony }
			}
		}
		add_core = U43
		cede_province = U43
	}

	if = {
		limit = {
			has_province_modifier = L62_encouraged_harimari_migration
		}
		add_core = L62
		change_religion = high_philosophy
		if = {
			limit = {
				continent = asia
				NOT = { has_terrain = jungle }
			}
			change_culture = serene_harimari
		}
		if = {
			limit = {
				has_terrain = jungle
			}
			change_culture = primal_harimari
		}
		if = {
			limit = {
				NOT = { continent = asia }
				NOT = { has_terrain = jungle }
			}
			change_culture = roaming_harimari
		}
	}

	if = { #Rezankand
		limit = {
			has_province_flag = rezankand_convert_to_vaikazelhi
		}
		change_culture = vaikazelhi
		clr_province_flag = rezankand_convert_to_vaikazelhi
	}

	if = { #Rezankand
		limit = {
			has_province_flag = rezankand_convert_to_brasanni
		}
		change_culture = brasanni
		clr_province_flag = rezankand_convert_to_brasanni
	}

	if = { #Rezankand
		limit = {
			has_province_flag = rezankand_convert_to_oonoi
		}
		change_culture = oonoi
		clr_province_flag = rezankand_convert_to_oonoi
	}
	
	if = {#Rezankand
		limit = {
			owner = { has_country_modifier = rezankand_new_exemplars_modifier }
		}
		add_base_manpower = 1
	}
	#honderaak incident gnoll minorities for colonies
	if = {
		limit = {
			owner = { 
				is_part_of_hre = yes 
				has_country_modifier = honderaak_incident_colonization 
				NOT = { culture_group = gnollish } 
			}
		}
		random_list = {
			1 = {
				trigger = {
					owner = { has_country_flag = honderaak_not_show }}
				add_gnollish_minority_size_effect = yes
			}
			1 = {
				trigger = {
					NOT = { owner = { has_country_flag = honderaak_not_show }}
				}
				province_event = { id = flavor_honderaak.6 }
			}
			1 = {}
		}	 
	}

	#Zokka
	if = {
		limit = { has_province_flag = zokka_convert_flame_flag }
		change_culture = flamemarked_gnoll
		change_religion = xhazobkult
		clr_province_flag = zokka_convert_flame_flag
	}

	#Tiboktsamo
	remove_province_modifier = L53_mainland_reclamation

	#celmaldor
	if = {
		limit = {
			owner = {
				is_or_was_tag = { tag = Z22 }
			}
		}
		if = {
			limit = { 
				owner = { has_country_flag = z22_colonies_to_free_nations } 
				OR = { continent = north_america continent = south_america } 
			}
			z22_give_colony_to_local_ally_effect = yes
		}
		owner = {
			country_event = {
				id = flavour_celmaldor.5
				days = 5
			}
		}
	}
	if = {
		limit = { 
			owner = {	has_country_flag = z22_colony_culture_religion_change_chance } 
			NOT = { superregion = gerudia_superregion } 
		}
		z22_change_to_random_culture_effect = yes
	}
	if = {
		limit = { 
			superregion = gerudia_superregion 
			owner = { has_country_flag = z22_gerudia_colonising } 
		}
		z22_gerudian_frontier_change_culture_effect = yes
	}
}

on_colonist_boosting_colony_effect = {
	hidden_effect = {
		if = {
			limit = {
				NOT = { religion = FROM } # Anbennar - prevent constant conversions
				NOT = {
					AND = {
						owner = { has_country_modifier = bagcatir_colonialism_mercantile }
						culture_is_ruinborn = yes
					}
					AND = {
						owner = { has_country_flag = does_not_convert_colonies_culture_or_religion_flag }
						NOT = { religion = noreligion }
					}
				}
				OR = {
					religion = noreligion
					#test if colonists outnumber natives
					variable_arithmetic_trigger = {
						custom_tooltip = colonysize_is_larger_than_nativesize_tt
						export_to_variable = {
							which = vab_colonysize
							value = trigger_value:colonysize
						}
						export_to_variable = {
							which = vab_nativesize
							value = trigger_value:native_size
						}
						multiply_variable = {
							which = vab_nativesize
							value = 100
						}
						check_variable = {
							which = vab_colonysize
							which = vab_nativesize
						}
					}
					is_in_capital_area = yes
					continent = north_america
					continent = south_america
					continent = new_world
					NOT = {
						OR = {
							has_dlc = "Dharma"
							has_dlc = "Wealth of Nations"
						}
					}
				}
			}
			change_religion = FROM
		}
		if = {
			limit = {
				NOT = { culture = FROM } # Anbennar - prevent constant conversions
				NOT = {
					AND = {
						owner = { has_country_modifier = bagcatir_colonialism_mercantile }
						culture_is_ruinborn = yes
					}
					AND = {
						owner = { has_country_flag = does_not_convert_colonies_culture_or_religion_flag }
						NOT = { culture = noculture }
					}
				}
				OR = {
					culture = noculture
					#test if colonists outnumber natives
					variable_arithmetic_trigger = {
						custom_tooltip = colonysize_is_larger_than_nativesize_tt
						export_to_variable = {
							which = vab_colonysize
							value = trigger_value:colonysize
						}
						export_to_variable = {
							which = vab_nativesize
							value = trigger_value:native_size
						}
						multiply_variable = {
							which = vab_nativesize
							value = 100
						}
						check_variable = {
							which = vab_colonysize
							which = vab_nativesize
						}
					}
					is_in_capital_area = yes
					continent = north_america
					continent = south_america
					continent = new_world
					NOT = {
						OR = {
							has_dlc = "Dharma"
							has_dlc = "Wealth of Nations"
						}
					}
				}
			}
			change_culture = FROM
			change_original_culture = FROM
		}
	}
}

on_alliance_broken_effect = {
	# if = {
	# 	limit = { has_country_modifier = mng_trade_access_in_china_modifier }
	# 	remove_country_modifier = mng_trade_access_in_china_modifier
	# }
	# if = {
	# 	limit = { has_country_modifier = rus_russian_caucasian_alliance FROM = { has_country_modifier = rus_russian_caucasian_alliance } }
	# 	remove_country_modifier = rus_russian_caucasian_alliance
	# 	FROM = { remove_country_modifier = rus_russian_caucasian_alliance }
	# }
	# if = {
	# 	limit = { has_country_modifier = gbr_english_dutch_trade_partners FROM = { has_country_modifier = gbr_english_dutch_trade_partners } }
	# 	remove_country_modifier = gbr_english_dutch_trade_partners
	# 	FROM = { remove_country_modifier = gbr_english_dutch_trade_partners }
	# }
	# if = {
	# 	limit = {
	# 		has_saved_global_event_target = tur_ottoman_trade_partner
	# 		OR = {
	# 			tag = event_target:tur_ottoman_trade_partner
	# 			FROM = { tag = event_target:tur_ottoman_trade_partner }
	# 		}
	# 	}
	# 	if = {
	# 		limit = { tag = event_target:tur_ottoman_trade_partner }
	# 		if = {
	# 			limit = { has_country_modifier = tur_ottoman_venetian_trade_deal_modifier }
	# 			remove_country_modifier = tur_ottoman_venetian_trade_deal_modifier
	# 		}
	# 		every_owned_province = {
	# 			limit = { has_province_modifier = tur_ottoman_venetian_trade_deal_modifier_prov }
	# 			remove_province_modifier = tur_ottoman_venetian_trade_deal_modifier_prov
	# 		}
	# 	}
	# 	FROM = {
	# 		if = {
	# 			limit = { tag = event_target:tur_ottoman_trade_partner }
	# 			if = {
	# 				limit = { has_country_modifier = tur_ottoman_venetian_trade_deal_modifier }
	# 				remove_country_modifier = tur_ottoman_venetian_trade_deal_modifier
	# 			}
	# 			every_owned_province = {
	# 				limit = { has_province_modifier = tur_ottoman_venetian_trade_deal_modifier_prov }
	# 				remove_province_modifier = tur_ottoman_venetian_trade_deal_modifier_prov
	# 			}
	# 		}
	# 	}
	# 	clear_global_event_target = tur_ottoman_trade_partner
	# }
	# FROM = {
	# 	if = {
	# 		limit = { has_country_modifier = mng_trade_access_in_china_modifier }
	# 		remove_country_modifier = mng_trade_access_in_china_modifier
	# 	}
	# }
	if = {
		limit = {
			has_global_flag = z22_can_have_giesadh
		}
		if = {
			limit = { transfers_trade_power_to = Z22 }
			z22_giesadh_check_effect = yes
		}
		else_if = {
			limit = { OR = { tag = Z22 was_tag = Z22 } FROM = { transfers_trade_power_to = ROOT }}
			FROM = { z22_giesadh_check_effect = yes }
		}
	}
	if = {
		limit = {
			is_or_was_tag = { tag = Z22 }
			FROM = {
				is_or_was_tag = { tag = Z18 }
			}
		}
		remove_country_modifier = z22_gray_alliance
	}
	if = {
		limit = {
			is_or_was_tag = { tag = Z18 }
			FROM = {
				is_or_was_tag = { tag = Z22 }
			}
		}
		remove_country_modifier = z22_gray_alliance
	}
}

on_adm_development_effect = {
	if = {
		limit = { owner = { has_country_flag = enable_supplemental_development_flag } }
		random_list = {
			20 = { add_base_tax = 1 }
			80 = { }
		}
	}
	if = {
		limit = { 
			owner = { has_country_modifier = lit_increased_dev_modifier }
		}
		add_base_tax = 1 
	}
	if = { 
		limit = { has_state_edict = chinese_industrialization } 
		random_list = {
			10 = { add_base_tax = 1 } 
			10 = { add_prosperity = 1 } 
			10 = { add_province_modifier = { name = qng_center_of_industrialization_modifier duration = 3650 } }
			70 = {  } 
		}
	}
	if = {
		limit = { owner = { has_country_modifier = JAP_cadastral_surveys has_dlc = "Domination" } }
		change_estate_land_share = {
			estate = all 
			share = -0.2
		}
	}
	
	if = {
		limit = { owner = { has_country_modifier = jap_20_years_devving_tax_yields_twice_bonus_1_burgher_loyalt_modifier } }
		add_base_tax = 1 
		add_estate_loyalty = {
			estate = estate_burghers 
			loyalty = 1 
		}
	}

	if = {
		limit = { owner = { has_country_flag = enable_supplemental_development_flag } }
		random_list = {
			20 = { add_base_tax = 1 }
			80 = { }
		}
	}

	if = {
		limit = { owner = { has_estate_privilege = estate_wolf_command_war_room_rights } }
		owner = { add_legitimacy = 1 }
	}
	jaddari_deioderan_dev_counter_update = yes
	# if = {
		# limit = { owner = { has_country_flag = federation_state_council } }
		# governing_point_adm = yes
	# }
	
	anb_on_development_effect = {
		development = tax
	}
	owner = {
		if = {
			limit = {
				religion = winter_court
			}
			add_church_power = 4
		}
	}
	if = {
		limit = {
			province_group = spirit_forts_province_group
		}
		spirit_fort_awakening_effect = yes
	}
	#Isobelin urban renewal
	if = {
		limit = {
			area = coast_of_isobel_area
			owner = { 
				tag = G91  
				has_country_flag = isobelin_country_flag_comissioners_plan
			} 
		}
		isobelin_scripted_effect_inscrease_comissioners_plan_variable = yes
	}

	# Harpy AI fledgling roost retroactive construction.
	harpy_roost_se_add_roost_tier_1_AI = { category = adm }

	if = {
		limit = {
			owner = {
				tag = Y89
				mission_completed = yuanszi_blight_extremities
			}
			has_province_modifier = rightful_xia_territory
			base_tax = 8
			OR = {
				owner = { ai = yes }
				num_of_times_expanded_infrastructure = 1
			}
		}
		yuanszi_attempt_adm_specialization = yes
	}

	#drozma tur
	if = {
		limit = {
			owner = {
				religion = drozma_tur
				has_church_aspect = aspire_compassion_aspect_dip
			}
			dt_has_any_holy_order = yes
		}
		random_list = {
			9 = {

			}
			1 = {
				add_base_tax = 1
				owner = {
					add_church_power = 5
				}
			}
		}
	}

	owner = {
		if = {
			limit = { has_church_aspect = accretive_path_liberation_of_the_mind }
			add_church_power = 15
			change_variable = { accretive_path_adm_chi = 15 }
		}
	}

	if = {
		limit = { owner = { has_mission = ap_xiaken_temple_grounds } }
		change_variable = { num_times_developed_adm = 1 }
	}
}
on_dip_development_effect = {
	if = {
		limit = { owner = { has_country_flag = enable_supplemental_development_flag } }
		random_list = {
			20 = { add_base_production = 1 }
			80 = { }
		}
	}
	if = {
		limit = { 
			owner = { has_country_modifier = lit_increased_dev_modifier }
		}
		add_base_production = 1 
	}
	if = { 
		limit = { has_state_edict = chinese_industrialization } 
		random_list = {
			10 = { add_base_production = 1 } 
			10 = { add_prosperity = 1 } 
			10 = { add_province_modifier = { name = qng_center_of_industrialization_modifier duration = 3650 } }
			70 = {  } 
		}
	}

	if = {
		limit = { owner = { has_country_flag = enable_supplemental_development_flag } }
		random_list = {
			20 = { add_base_production = 1 }
			80 = { }
		}
	}

	jaddari_deioderan_dev_counter_update = yes
	# if = {
		# limit = { owner = { has_country_flag = federation_state_council } }
		# governing_point_dip = yes
	# }
	
	anb_on_development_effect = {
		development = production
	}
	#Isobelin urban renewal
	if = {
		limit = {
			area = coast_of_isobel_area
			owner = { 
				tag = G91  
				has_country_flag = isobelin_country_flag_comissioners_plan
			} 
		}
		isobelin_scripted_effect_inscrease_comissioners_plan_variable = yes
	}
	owner = {
		if = {
			limit = {
				religion = spring_court
			}
			add_church_power = 4
		}
	}
	if = {
		limit = {
			province_group = spirit_forts_province_group
		}
		spirit_fort_awakening_effect = yes
	}
	if = {
		limit = {
			owner = {
				tag = G53
			}
			OR = {
				G53 = {
					ai = no
				}
				U27 = { #Theinos
					ai = no
				}
			}
		}
		owner = {
			country_event = {
				id = empkeios_events.1299
			}
		}
	}
	# Ovdal Tungr Uthojdihr Trading Post system. Ideally works off of Expanding Infrastructure, but that's locked behind Leviathan so this is the fallback.
	F23_apply_uthojdihr_trading_post = yes 

	# Harpy AI fledgling roost retroactive construction.
	harpy_roost_se_add_roost_tier_1_AI = { category = dip }
	# Xanzerbexis
	if = { 
		limit = { 
			owner = { has_country_modifier = A49_mining_coefficient }
			OR = {
				trade_goods = copper
				trade_goods = iron
				trade_goods = mithril
				trade_goods = gold
			}
		}
		add_base_production = 1
	}
	if = {
		limit = {
			owner = {
				tag = Y89
				mission_completed = yuanszi_prosperity_faithful
			}
			has_province_modifier = rightful_xia_territory
			base_production = 8
			OR = {
				owner = { ai = yes }
				num_of_times_expanded_infrastructure = 1
			}
		}
		yuanszi_attempt_dip_specialization = yes
	}

	#drozma tur
	if = {
		limit = {
			owner = {
				religion = drozma_tur
				has_church_aspect = aspire_compassion_aspect_dip
			}
			dt_has_any_holy_order = yes
		}
		random_list = {
			9 = {

			}
			1 = {
				add_base_production = 1
				owner = {
					add_church_power = 5
				}
			}
		}
	}
	if = {
		limit = { has_province_modifier = konolkhatep_abyssal_golden_mine }
		add_base_production = 1
	}

	owner = {
		if = {
			limit = { has_church_aspect = accretive_path_liberation_of_the_soul }
			add_church_power = 15
			change_variable = { accretive_path_dip_chi = 15 }
		}
	}
}
on_mil_development_effect = {
	if = {
		limit = { owner = { has_country_flag = enable_supplemental_development_flag } }
		random_list = {
			20 = { add_base_manpower = 1 }
			80 = { }
		}
	}
	if = {
		limit = { 
			owner = { has_country_modifier = lit_increased_dev_modifier }
		}
		add_base_manpower = 1 
	}
	if = { 
		limit = { has_state_edict = chinese_industrialization } 
		random_list = {
			10 = { add_base_manpower = 1 } 
			10 = { add_prosperity = 1 } 
			10 = { add_province_modifier = { name = qng_center_of_industrialization_modifier duration = 3650 } }
			70 = {  } 
		}
	}

	if = {
		limit = { owner = { has_country_flag = enable_supplemental_development_flag } }
		random_list = {
			20 = { add_base_manpower = 1 }
			80 = { }
		}
	}

	if = {
		limit = { owner = { has_estate_privilege = estate_boar_command_war_room_rights } }
		owner = { add_legitimacy = 1 }
	}
	
	anb_on_development_effect = {
		development = manpower
	}
	# Isobelin urban renewal
	if = {
		limit = {
			area = coast_of_isobel_area
			owner = { 
				tag = G91  
				has_country_flag = isobelin_country_flag_comissioners_plan
			} 
		}
		isobelin_scripted_effect_inscrease_comissioners_plan_variable = yes
	}
	owner = {
		if = {
			limit = {
				religion = autumn_court
			}
			add_church_power = 4
		}
	}
	if = {
		limit = {
			province_group = spirit_forts_province_group
		}
		spirit_fort_awakening_effect = yes
	}
	if = {
		limit = {
			owner = {
				tag = Y89
				mission_completed = yuanszi_black_monks
			}
			has_province_modifier = rightful_xia_territory
			base_manpower = 8
			OR = {
				owner = { ai = yes }
				num_of_times_expanded_infrastructure = 1
			}
		}
		yuanszi_attempt_mil_specialization = yes
	}

	# Harpy AI fledgling roost retroactive construction.
	harpy_roost_se_add_roost_tier_1_AI = { category = mil }
	#drozma tur
	if = {
		limit = {
			owner = {
				religion = drozma_tur
				has_church_aspect = aspire_compassion_aspect_dip
			}
			dt_has_any_holy_order = yes
		}
		random_list = {
			9 = {

			}
			1 = {
				add_base_manpower = 1
				owner = {
					add_church_power = 5
				}
			}
		}
	}

	#Frozenmaw Gray Orc Settlement
	if = {
		limit = {
			owner = {
				tag = Z18
				OR = {
					has_country_flag = moskaran_flag_0
					has_country_modifier = moskaran_conscription_1
					has_country_modifier = moskaran_conscription_2
				}
			}
			OR = {
				region = olavlund_region
				region = northern_pass_region
				region = gerudian_frontier_region
				area = east_chillsbay_area
				area = wudhal_area
				area = gulletpeak_area
				area = cedesck_area
				area = vrorenmarch_area
				area = vrorenwall_area
				area = sondaar_area
			}
		}
		random_list = {
			5 = { #gray orcs settle the province
				modifier = { factor = 8 NOT = { development = 10 } owner = { has_country_modifier = moskaran_conscription_2 } } #40%
				modifier = { factor = 6 development = 10 NOT = { development = 15 } owner = { has_country_modifier = moskaran_conscription_2 } } #30%
				modifier = { factor = 4 development = 15 owner = { has_country_modifier = moskaran_conscription_2 } } #20%

				modifier = { factor = 7 NOT = { development = 10 } owner = { has_country_modifier = moskaran_conscription_1 } } #35%
				modifier = { factor = 5 development = 10 NOT = { development = 15 } owner = { has_country_modifier = moskaran_conscription_1 } } #25%
				modifier = { factor = 3 development = 15 owner = { has_country_modifier = moskaran_conscription_1 } } #15%

				modifier = { factor = 6 NOT = { development = 10 } owner = { has_country_flag = moskaran_flag_0 } } #30%
				modifier = { factor = 4 development = 10 NOT = { development = 15 } owner = { has_country_flag = moskaran_flag_0 } } #20%
				modifier = { factor = 2 development = 15 owner = { has_country_flag = moskaran_flag_0 } } #10%
				if = {
					limit = {
						has_large_orcish_minority_trigger = yes
					}
					change_culture = gray_orc
				}
				else = {
					add_orcish_minority_size_effect = yes
				}
			}
			5 = { #they don't
				modifier = { factor = 12 NOT = { development = 10 } owner = { has_country_modifier = moskaran_conscription_2 } }
				modifier = { factor = 14 development = 10 NOT = { development = 15 } owner = { has_country_modifier = moskaran_conscription_2 } }
				modifier = { factor = 16 development = 15 owner = { has_country_modifier = moskaran_conscription_2 } }

				modifier = { factor = 13 NOT = { development = 10} owner = { has_country_flag = moskaran_conscription_1 } }
				modifier = { factor = 15 development = 10 NOT = { development = 15 } owner = { has_country_flag = moskaran_conscription_1 } }
				modifier = { factor = 17 development = 15 owner = { has_country_flag = moskaran_conscription_1 } }

				modifier = { factor = 14 NOT = { development = 10} owner = { has_country_flag = moskaran_flag_0 } }
				modifier = { factor = 16 development = 10 NOT = { development = 15 } owner = { has_country_flag = moskaran_flag_0 } }
				modifier = { factor = 18 development = 15 owner = { has_country_flag = moskaran_flag_0 } }
			}
		}
	}
	owner = {
		if = {
			limit = { has_church_aspect = accretive_path_liberation_of_the_body }
			add_church_power = 15
			change_variable = { accretive_path_mil_chi = 15 }
		}
	}
}
on_development_effect = {
	owner = {
		change_variable = {
			which = num_of_times_developed
			value = 1
		}
	}
	#if = {
	#	limit = {
	#		owner = {
	#			has_mission = ARB_the_harsh_desert
	#		}
	#		has_climate = arid
	#	}
	#	owner = {
	#		change_variable = {
	#			which = num_of_times_developed_arid
	#			value = 1
	#		}
	#	}
	#}

	#Drozma Tur
	dt_introspection_dev_effect = yes

	#Celmaldor
	if = {
		limit = {
			owner = {
				has_estate_privilege = z22_commercial_tongue_privilege
			}
			development = 10
		}
		if = {
			limit = {
				owner = {
					mission_completed = z22_rights_of_man
				}
			}
			if = {
				limit = {
					culture = blue_reachman
				}
				add_province_modifier = {
					name = z22_commercial_language_blue_2
					duration = -1
				}
			}
			else = {
				add_province_modifier = {
					name = z22_commercial_language_notblue_2
					duration = -1 
				}
			}
		}
		else = {
			if = {
				limit = {
					culture = blue_reachman
				}
				add_province_modifier = {
					name = z22_commercial_language_blue_1
					duration = -1
				}
			}
			else = {
				add_province_modifier = {
					name = z22_commercial_language_notblue_1
					duration = -1 
				}
			}
		}
	}


	#Zokka

	if = {
		limit = { province_id = 5073 has_province_modifier = zokka_gaping_maw owner = { tag = F29 } }
		owner = {
			change_variable = {
				which = zokkamak_count
				value = 1
			}
		}
		if = {
			limit = { owner = { check_variable = { which = zokkamak_count value = 10 } } }
			remove_province_modifier = zokka_gaping_maw
			add_province_modifier = {
				name = zokka_over_maw
				duration = -1
			}
			owner = { add_kelmaxherho_favour = yes }
		}
	}
	
	#Gnoll tributaries
	owner = {
		if = {
			limit = {
				overlord = { 
					OR = { 
						has_estate_privilege = gnoll_the_weak_serve_the_strong 
						has_estate_privilege = gnoll_the_weak_serve_the_strong_burghers 
					}
				}
				is_right_subject_type_xhazobkult = yes
				is_right_development_xhazobkult = yes
				NOT = { has_country_flag = already_giving_tributary_bonus }
			}
			set_country_flag = already_giving_tributary_bonus
			overlord = { change_variable = { gnoll_tributary_bonus_count = 1 } }
		}
	}

	#Pashaine
	if = {
		limit = { has_province_modifier = pashaine_age_of_luna_prov_mod }
		extend_province_modifier = {
			name = pashaine_age_of_luna_prov_mod
			duration = 365 #1 year
		}
		owner = {
			extend_country_modifier = {
				name = pashaine_age_of_luna_country_mod
				duration = 365 #1 year
			}
			#This is done because the extend country modifier duration isn't refreshed immediatly
			#It only refreshed on saving/reloading or adding a new country modifier
			add_country_modifier = {
				name = fake_hidden_modifier
				duration = 1 #This counts suprisingly
				hidden = yes
			}
		}
	}

	#Salla Ayeth
	if = {
		limit = {
			province_id = 3033
			check_variable = {
				which = ayethFamiliesReturning
				value = 1
			}
		}
		extend_province_modifier = {
			name = I33_families_returning
			duration = 365
		}
		subtract_variable = {
			which = ayethFamiliesReturning
			value = 1
		}
	}

	if = { #Transmutative Path
		limit = { province_has_chi_wellspring_trigger = yes }
		add_chi_wellspring_to_size = yes
	}
	
	if = { #Kheionai
		limit = {
			owner = { has_reform = kheionai_the_kheionolyklos }
			has_seat_in_parliament = yes
			OR = {
				has_terrain = city_terrain
				development = 20
			}
		}
		remove_province_modifier = kheionai_the_kheionolyklos_bad_mod
		add_province_modifier = {
			name = kheionai_the_kheionolyklos_good_mod
			duration = -1
		}
	}

	owner = { #Magic Rework
		if = {
			limit = { has_country_modifier = orb_of_omniscience_dev_tracker }
			change_variable = { orb_of_omniscience_progress_tracker = 1 }
		}
	}

	#Fangaulan Pantheon
	if = {
		limit = {
			owner = {
				has_country_modifier = fangaulan_pantheon_ujun_sacrifice
			}
			has_owner_culture = yes
		}
		random = {
			chance = 10
			add_random_development = 1
		}
	}
}

# THIS = Province, FROM = Country, ROOT = Merc Unit
on_mercenary_recruited_effect = {
	if = {
		limit = {
			FROM = { has_not_free_mercs_trait = yes }
			is_not_free_merc_company = yes
			OR = {
				FROM = { NOT = { has_country_flag = oyo_cavalry_do_not_consume_ap } }
				ROOT = { NOT = { mercenary_company = merc_oyo_cavalry } }
			}
		}
		if = {
			limit = {
				FROM = { 
					OR = {
						has_country_flag = fifty_percent_merc_army_professionalism_cost 
						has_country_modifier = pol_cheap_ap_mercs_modifier
					}
				}
			}
			FROM = { add_army_professionalism = -0.025 }
		}
		else = { 
			FROM = { add_army_professionalism = -0.05 } 
		}
	}

	#Anbennar
	if = {
		limit = {
			FROM = {
				tag = H78
				has_reform = seghdihr_segbandalic_military
			}
		}
		FROM = { add_army_professionalism = -0.05 } #so its -10% total
	}
	if = {
		limit = {
			FROM = {
				OR = {
					tag = G35
					was_tag = G35
				}
				mission_completed = veykodan_guard
			}
			OR = {
				ROOT = { mercenary_company = veykodan_guard_merc }
				ROOT = { mercenary_company = veykodan_guard_elite_merc }
			}
		}
		FROM = { country_event = { id = flavor_arverynn.46 } }
	}
	if = {
		limit = {
			FROM = {
				culture_group = ynnic_ruinborn_elf
				OR = {
					religion = ynn_river_worship
					religion = ynn_river_reformed
				}
				OR = {
					NOT = {
						has_country_flag = yrw_3a
						has_country_flag = yrw_3b
						has_country_flag = yrw_3a_reform
						has_country_flag = yrw_3b_reform
					}
					has_country_flag = yrw_3b
					has_country_flag = yrw_3b_reform
				}
				NOT = {
					has_country_modifier = ynn_strict_merc_equipment
					has_country_modifier = ynn_lax_merc_equipment
				}
			}
			ROOT = {
				is_foreign_company = yes
				home_province = {
					culture_is_not_ruinborn = yes
				}
			}
		}
		FROM = {
			country_event = {
				id = ynnsman_events.107
			}
		}
	}
	if = {
		limit = {
			FROM = {
				OR = {
					tag = F30
					was_tag = F30
				}
			}
			OR = {
				ROOT = { mercenary_company = merc_sarraka }
				ROOT = { mercenary_company = merc_sarraka_two }
				ROOT = { mercenary_company = merc_sarraka_three }
			}
		}
		FROM = {
			country_event = {
				id = flavor_kumarkand.101
			}
		}
	}
	if = {
		limit = {
			FROM = { capital_scope = { continent = europe } }
			ROOT = { mercenary_company = merc_ironwall }
		}
		FROM = { country_event = { id = flavor_frozenmaw.9 } }
	}

	FROM = {
		if = {
			limit = {
				OR = {
					tag = Z22
					was_tag = Z22
				}
				has_estate_privilege = z22_clan_levies_privilege
			}
			z22_check_merc_modifier = yes
		}
	}
	FROM = {
		clr_country_flag = recruited_merc_company
		set_country_flag = recruited_merc_company	#flag to check for when you last hired mercs
	}
}

on_parliament_debate_reset_effect = {
	add_country_modifier = {
		name = reset_parliament_debate_modifier
		duration = 3650
	}
	if = {
		limit = { has_government_attribute = corruption_loss_on_reset }
		add_corruption = -1
	}
	else = { add_corruption = 2 }
	if = {
		limit = {
			has_government_mechanic = parliament_vs_monarchy_mechanic
		}
		add_government_power = { 
			mechanic_type = parliament_vs_monarchy_mechanic
			power_type = governmental_power
			value = 20
		}
	}
	if = { #Anbennar
		limit = { tag = J33 }
		kalsyto_assign_seats = yes
		clr_country_flag = J33_major_issue
	}
}

on_parliament_seat_given_effect = {
	owner = {
		if = { 
			limit = { has_country_flag = fra_powerful_parliament_flag } 
			change_government_reform_progress = 5
			random_list = {
				1 = { add_adm_power = 10 }
				1 = { add_dip_power = 10 }
				1 = { add_mil_power = 10 }
			}
		}
		if = {
			limit = {
				has_government_mechanic = parliament_vs_monarchy_mechanic
			}
			add_government_power = { 
				mechanic_type = parliament_vs_monarchy_mechanic
				power_type = governmental_power
				value = -5
			}
		}
		if = {
			limit = {
				has_government_attribute = parliament_seat_bonus
			}
			add_estate_loyalty = {
				estate = all
				loyalty = 1
			}
		}
	}
	if = {
		limit = {
			owner = {
				has_government_attribute = parliament_seat_bonus
			}
		}
		add_province_modifier = {
			name = gov_buffed_parliament_seat
			duration = -1
		}
	}
	if = {
		limit = { has_province_modifier = chaqway_markets }
		add_province_modifier = {
			name = chaqway_parliament
			duration = -1
		}
	}
	if = { #Kheionai
		limit = { owner = { has_reform = kheionai_the_kheionolyklos } }
		if = {
			limit = {
				OR = {
					has_terrain = city_terrain
					development = 20
				}
			}
			add_province_modifier = {
				name = kheionai_the_kheionolyklos_good_mod
				duration = -1
			}
		}
		else = {
			add_province_modifier = {
				name = kheionai_the_kheionolyklos_bad_mod
				duration = -1
			}
		}
	}
}
on_parliament_seat_lost_effect = {
	owner = {
		if = {
			limit = {
				has_government_mechanic = parliament_vs_monarchy_mechanic
			}
			add_government_power = { 
				mechanic_type = parliament_vs_monarchy_mechanic
				power_type = governmental_power
				value = 5
			}
		}
	}
	if = {
		limit = {
			has_province_modifier = gov_buffed_parliament_seat
		}
		remove_province_modifier = gov_buffed_parliament_seat
	}
	if = {
		limit = { has_province_modifier = chaqway_parliament }
		remove_province_modifier = chaqway_parliament
	}
	if = {
		limit = { has_province_modifier = kheionai_the_kheionolyklos_good_mod }
		remove_province_modifier = kheionai_the_kheionolyklos_good_mod
	}
	if = {
		limit = { has_province_modifier = kheionai_the_kheionolyklos_bad_mod }
		remove_province_modifier = kheionai_the_kheionolyklos_bad_mod
	}
}
on_parliament_debate_failed_effect = {
	if = {
		limit = {
			has_government_mechanic = parliament_vs_monarchy_mechanic
		}
		add_government_power = { 
			mechanic_type = parliament_vs_monarchy_mechanic
			power_type = governmental_power
			value = 33
		}
	}
	if = { #Anbennar
		limit = { tag = J33 }
		kalsyto_clear_seats = yes
		clr_country_flag = J33_major_issue
	}
	if = {
		limit = { has_government_attribute = deliberative_design_parliament }
		add_country_modifier = {
			name = deliberative_design_failed_parliament
			duration = 3650
		}
	}
}
on_parliament_debate_succeeded_effect = {
	if = {
		limit = {
			has_government_mechanic = parliament_vs_monarchy_mechanic
		}
		add_government_power = { 
			mechanic_type = parliament_vs_monarchy_mechanic
			power_type = governmental_power
			value = -20
		}
	}
	if = {
		limit = { has_government_attribute = gain_rt_from_parliament }
		add_republican_tradition = 5
	}
	#Anbennar

	#Breluslad Endurance training
	if = {
		limit = {
			current_debate = breluslad_endurance_training
		}
		country_event = {
			id = flavour_brelar.15
			days = 3650
		}
	}
	if = {
		limit = { tag = J33 }
		kalsyto_clear_seats = yes
		clr_country_flag = J33_major_issue
	}

	#Gnomish reform
	if = {
    	limit = { has_government_attribute = deliberative_design_parliament }
    	add_country_modifier = {
    	    name = deliberative_design_successful_parliament
    	    duration = 3650
    	}
	}

	if = {
		limit = { has_government_attribute = mana_from_parliament }
		add_adm_power = 100
		add_dip_power = 100
		add_mil_power = 100
	}

	#Arg Ordstun
	if = {
		limit = {
			has_government_mechanic = argordstun_roughness_mechanic
		}
		add_government_power = {
			mechanic_type = argordstun_roughness_mechanic
			power_type = argordstun_roughness_power
			value = -2
		}
	}
	if = {
		limit = {
			has_government_mechanic = argordstun_luster_mechanic
		}
		add_government_power = {
			mechanic_type = argordstun_luster_mechanic
			power_type = argordstun_luster_power
			value = 5
		}
	}

	#Pashaine
	pashaine_add_clue = yes
}

on_main_war_won_effect = {
	if = {
		limit = {
			has_government_attribute = winning_wars_gives_rt
		}
		add_republican_tradition = 5
	}
	if = {
		limit = {
			has_government_attribute = winning_war_increases_legitimacy
		}
		add_legitimacy = 5
		add_devotion = 5
		add_meritocracy = 5
		add_horde_unity = 5
		add_republican_tradition = 2
	}

	# if = {
		# limit = {
			# has_country_modifier = swe_fight_for_independence
			# NOT = { has_country_flag = swe_defeated_denmark }
			# FROM = { tag = DAN }
		# }
		# set_country_flag = swe_defeated_denmark
	# }
	# if = {
		# limit = { 
			# has_country_flag = nor_norwegian_independence_modifier 
			# is_subject = no
			# FROM = { tag = DAN }
		# }
		# clr_country_flag = nor_norwegian_independence_modifier
		# remove_country_modifier = nor_norwegian_independence_war_mod
	# }
	# if = {
		# limit = {
			# ROOT = {
				# religion = jewish
				# has_church_aspect = judaism_purim_teachings_aspect
			# }
		# }
		# add_church_power = 75
	# }
	# if = {
		# limit = {
			# has_country_flag = nor_norwegian_independence_modifier
			# is_subject = no
		# }
		# clr_country_flag = nor_norwegian_independence_modifier
		# remove_country_modifier = nor_norwegian_independence_war_mod
	# }
	# if = {
		# limit = {
			# ROOT = {
				# has_mission = swe_devastate_the_christians
				# NOT = { mission_completed = swe_devastate_the_christians }
				# religion = norse_pagan_reformed
			# }
			# FROM = { religion_group = christian }
		# }
		# change_variable = {
			# which = swe_won_wars_against_christians
			# value = 1
		# }
	# }
	# if = { 
		# limit = {
			# has_dlc = "Mandate of Heaven" 
			# ROOT = {
				# is_emperor_of_china = yes 
				# has_country_flag = mng_outward_perfection_flag 
			# }
		# }
		# add_mandate = 10
	# }
	if = {
		limit = {
			ROOT = {
				has_government_mechanic = end_time_mechanic
				NOT = {
					government_power_frozen = {
						mechanic_type = end_time_mechanic
						power_type = fanatic_zeal
					}
				}
			}
		}
		add_government_power = {
			mechanic_type = end_time_mechanic
			power_type = fanatic_zeal
			value = -5
		}
	}
	if = {
		limit = {
			FROM = {
				religion_group = ROOT
				NOT = { religion = ROOT }
			}
		}
		change_variable = {
			which = num_of_wars_won_against_heretics
			value = 1
		}
	}
	if = {
		limit = {
			FROM = {
				NOT = { religion = ROOT }
			}
		}
		change_variable = {
			which = num_of_wars_won_against_non_believers
			value = 1
		}
	}
	if = {
		limit = { 
			has_government_attribute = plundered_knowledge_reform_effect
			FROM = {
				NOT = { has_country_modifier = monstrous_nation }
			}
		}
		change_government_reform_progress = 20
	}
	if = { #Anbennar
		limit = {
			ROOT = { has_country_modifier = lake_federation_member }
			FROM = { has_country_modifier = centaur_administration }
		}
		set_country_flag = federation_cohesion_triumph
	}
	if = { #Taychend Glory
		limit = {
			has_country_flag = taychendi_coalition_defender
		}
		clr_country_flag = taychendi_coalition_defender
		gain_taychend_glory_effect = { amount = 100 }
		every_known_country = {
			limit = {
				NOT = {
					has_opinion_modifier = {
						who = ROOT
						modifier = aggressive_expansion
						value = -75
					}
				}
			}
			remove_opinion = {
				who = ROOT
				modifier = aggressive_expansion
			}
		}
		every_subject_country = {
			remove_opinion = {
				who = ROOT
				modifier = aggressive_expansion
			}
		}
	}

	if = { #Blorc Absolutism
		limit = {
			has_government_attribute = winning_wars_gives_absolutism_effect
		}
		add_absolutism = 10
	}

	#brelar
	g27_boats_uprising_check_effect = yes
	#feast_of_the_gods stuff
	feast_of_the_gods_won_war_count = yes
	if = {
		limit = {
			religion = autumn_court
		}
		add_church_power = 25
	}
	#undergrowth
	if = {
		limit = {
			OR = {
				ROOT = { tag = H88 }
				ROOT = { tag = H93 }
				ROOT = { tag = H94 }
			}
		}	
		add_legitimacy = 20
	}

	if = { #Nekheis and their overlord lose their war modifiers
		limit = { has_country_modifier = nekhei_granted_war_rights }
		remove_country_modifier = nekhei_granted_war_rights
		overlord = {
			remove_all_nekhei_negate_overlord_modifiers = yes
		}
	}
	
	if = { #Besolaki
		limit = {
			has_country_flag = G54_in_okti_arped_war_flag
		}
		clr_country_flag = G54_in_okti_arped_war_flag
		set_country_flag = G54_oktikheion_war_happened_flag
	}

	if = { #Davharral
		limit = { is_or_was_tag = { tag = R03 } }
		change_variable = { which = davharral_num_wars_won value = 1 }
	}

	if = { #Vuls Tenvach
		limit = { has_country_modifier = G79_thunderous_advance }
		remove_country_modifier = G79_thunderous_advance
		add_splendor = 50
		add_navy_tradition = 5
		add_army_tradition = 5
		add_war_exhaustion = -2
	}

	if = { #Vandipha Decree
		limit = { 
			ROOT = { tag = L62 }
			FROM = {
				OR = {
					has_country_flag = L62_decree_refuser
					has_country_modifier = L62_decree_of_tranquil_waves
				}
			}
		}
		ROOT = { country_event = { id = flavour_vandipha.13 } }
		FROM = { country_event = { id = flavour_vandipha.13 } }
	}

	#Istralore
	if = {
		limit = {
			tag = A45
			FROM = {
				tag = A98
			}
			has_country_flag = A45_ae_reduce
		}
		every_known_country = {
			add_aggressive_expansion = {
				who = A45
				value = -20
				apply_calc = yes
			} 
		}
		clr_country_flag = A45_ae_reduce
	}
	if = {
		limit = {
			is_or_was_tag = { tag = A45 }
			NOT = { has_matching_religion = FROM }
			religion = corinite
		}
		change_variable = { istraloreReligiousWarsWon = 1 }
	}

	#Pashaine
	if = {
		limit = {
			has_country_flag = pashaine_extend_golden_age_by_war
			in_golden_age = yes
			FROM = { is_great_power = yes }
		}
		extend_golden_age = 12 #1 years
	}

	#Fangaulan Pantheon
	if = {
		limit = {
			religion = fangaulan_pantheon
		}
		add_church_power = 2
	}
}

on_change_tag_effect = {
	hidden_effect = {
		restore_country_name = yes
		restore_country_color = yes
		#England specific
		if = { limit = { has_country_modifier = royal_impressment_act_modifier } remove_country_modifier = royal_impressment_act_modifier }
		if = { limit = { has_country_modifier = isolationism_act_modifier } remove_country_modifier = isolationism_act_modifier }
		if = { limit = { has_country_modifier = colonial_act_modifier } remove_country_modifier = colonial_act_modifier }
		if = { limit = { has_country_modifier = military_reassignment_act_modifier } remove_country_modifier = military_reassignment_act_modifier }
		if = { limit = { has_country_modifier = acts_of_development_modifier } remove_country_modifier = acts_of_development_modifier }
		if = { limit = { has_country_modifier = global_empire_act_modifier } remove_country_modifier = global_empire_act_modifier }
		if = { limit = { has_country_modifier = naval_reassignment_act_modifier } remove_country_modifier = naval_reassignment_act_modifier }
		if = { limit = { has_country_modifier = diplomatic_act_modifier } remove_country_modifier = diplomatic_act_modifier }
		if = { limit = { has_country_modifier = internal_focus_act_modifier } remove_country_modifier = internal_focus_act_modifier }
	}
}

on_force_conversion_effect = {
	#if = {	#Commented out for now because Catholicism has received a lot of buffs already.
	#	limit = {
	#		FROM = { religion = catholic }
	#	}
	#	if = {
	#		limit = { ROOT = { government_rank = 3 } }
	#		FROM = { add_papal_influence = 20 }
	#	}
	#	else_if = {
	#		limit = { ROOT = { government_rank = 2 } }
	#		FROM = { add_papal_influence = 10 }
	#	}
	#	else = {
	#		FROM = { add_papal_influence = 5 }
	#	}
	#}
	add_country_modifier = {
		name = recently_was_force_converted
		duration = 3600
		hidden = yes
	}
	FROM = {
		add_country_modifier = {
			name = recently_force_converted_protagonist_timer
			duration = 5475
			hidden = yes
		}
		#if = {
		#	limit = { has_country_modifier = liv_protector_of_the_catholics }
		#	add_papal_influence = 25
		#}
		change_variable = {
			which = num_of_forced_conversions
			value = 1
		}
		if = {
			limit = { has_government_attribute = gain_monarch_power_from_force_converting }
			export_to_variable = {
				variable_name = root_development
				value = total_development
				who = ROOT
			}
			while = {
				limit = {
					check_variable = {
						which = root_development
						value = 1
					}
				}
				subtract_variable = {
					which = root_development
					value = 1
				}
				add_adm_power = 1
				add_dip_power = 1
				add_mil_power = 1
			}
		}
		if = {
			limit = { has_government_attribute = gain_devotion_from_force_converting }
			export_to_variable = {
				variable_name = root_development
				value = total_development
				who = ROOT
			}
			while = {
				limit = {
					check_variable = {
						which = root_development
						value = 1
					}
				}
				subtract_variable = {
					which = root_development
					value = 1
				}
				add_devotion = 0.05
			}
		}
		if = {
			limit = { has_government_attribute = theocratic_monarchy_mechanic }
			change_statists_vs_orangists = -0.05
		}
	}
	if = {
		limit = {
			has_global_flag = suhan_goes_sicko_mode
			FROM = {
				religion = high_philosophy
			}
			has_saved_event_target = suhan_center
		}
		if = {
			limit = {
				capital_scope = { province_id = event_target:suhan_center }
			}
			FROM = { country_event = { id = rahen.11 } }
		}
	}
	#if = { #Anbennar
	#	trigger = { religion = kalyin_worshippers }
	#	kalyin_conversion = yes
	#}
}

on_general_recruited_effect = {
	if = {
		limit = { has_country_modifier = pol_trigger_for_army_professionalism_modifier } 
		add_army_professionalism = 0.0125 
	}
	else = { add_army_professionalism = 0.01 }
	if = {
		limit = { has_government_attribute = recruiting_generals_increases_nobles_loyalty }
		if = {
			limit = {
				has_estate = estate_nobles
			}
			add_estate_loyalty = {
				estate = estate_nobles
				loyalty = 2
			}
		}
		if = {
			limit = {
				has_estate = estate_maratha
			}
			add_estate_loyalty = {
				estate = estate_maratha
				loyalty = 2
			}
		}
		if = {
			limit = {
				has_estate = estate_rajput
			}
			add_estate_loyalty = {
				estate = estate_rajput
				loyalty = 2
			}
		}
	}
	if = {
		limit = { has_government_attribute = recruiting_generals_increases_church_loyalty }
		if = {
			limit = {
				has_estate = estate_church
			}
			add_estate_loyalty = {
				estate = estate_church
				loyalty = 2
			}
		}
		# if = {
		# 	limit = {
		# 		has_estate = estate_brahmins
		# 	}
		# 	add_estate_loyalty = {
		# 		estate = estate_brahmins
		# 		loyalty = 2
		# 	}
		# }
	}
	if = { 
		limit = { has_country_modifier = fra_french_papal_military_cooperation_modifier } 
		add_army_professionalism = 0.015
	}
	#Anbennar
	if = {
		limit = { has_government_attribute = dwarovar_emulate_warriors_effect }
		change_estate_land_share = {
			estate = estate_church
			share = -1
		}
	}

	if = {
		limit = { has_estate_privilege = estate_lion_command_war_room_rights }
		add_legitimacy = 1
	}
	
	if = {
		limit = {
			has_country_flag = sareyand_artists_of_triumph_flag
			NOT = { has_country_modifier = sareyand_artist_cooldown }
		}
		add_country_modifier = {
			name = sareyand_artist_cooldown
			duration = 365
			hidden = yes
		}
		if = {
			limit = { army_tradition = 75 }
			define_advisor = {
				type = artist
				skill = 2
				cost_multiplier = 0.5
				culture = ROOT
				religion = ROOT
			}
		}
		else_if = {
			limit = { army_tradition = 50 }
			define_advisor = {
				type = artist
				skill = 2
				cost_multiplier = 0.65
				culture = ROOT
				religion = ROOT
			}
		}
		else_if = {
			limit = { army_tradition = 25 }
			define_advisor = {
				type = artist
				skill = 1
				cost_multiplier = 0.8
				culture = ROOT
				religion = ROOT
			}
		}
		else = {
			define_advisor = {
				type = artist
				skill = 1
				cost_multiplier = 0.95
				culture = ROOT
				religion = ROOT
			}
		}
	}
	accretive_path_gain_chi = { aspect = leadership_of_hero_monks category = mil amount = 15 }
}

on_sale_of_titles_effect = {
	hidden_effect = {
		change_variable = {
			which = sale_of_titles_counter
			value = 1
		}
	}
}
on_summon_the_diet_effect = {
	hidden_effect = {
		change_variable = {
			which = summon_the_diet_counter
			value = 1
		}
	}
}
on_seize_land_effect = {
	hidden_effect = {
		change_variable = {
			which = seize_land_counter
			value = 1
		}
		if = {
			limit = {
				has_government_attribute = has_appanages
			}
			change_variable = {
				which = can_annex_appanages_points
				value = 1
			}
		}
	}
}
on_heir_disinherited_or_death_effect = {
	if = {
		limit = { has_country_flag = heir_dip_education }
		clr_country_flag = heir_dip_education
	}
	if = {
		limit = { has_country_flag = heir_mil_education }
		clr_country_flag = heir_mil_education
	}
	if = {
		limit = { has_country_flag = heir_adm_education }
		clr_country_flag = heir_adm_education
	}
	if = {
		limit = { has_ruler_flag = well_advised_tutored_heir }
		clr_ruler_flag = well_advised_tutored_heir
	}
	if = {
		limit = { has_ruler_flag = heir_went_on_grand_tour }
		clr_ruler_flag = heir_went_on_grand_tour
	}
	#if = {
	#	limit = { has_country_flag = albrecht_achilles_flag }
	#	clr_country_flag = albrecht_achilles_flag #Death of original Albrecht Achilles
	#}
	#if = {
	#	limit = { has_ruler_flag = sancaga_cikma }
	#	clr_ruler_flag = sancaga_cikma
	#	every_owned_province = {
	#		limit = {
	#			has_province_modifier = heir_in_training
	#		}
	#		remove_province_modifier = heir_in_training
	#	}
	#}
	#if = {
	#	limit = { has_ruler_flag = returned_from_sancaga_sikma_province }
	#	clr_ruler_flag = returned_from_sancaga_sikma_province
	#}
	#if = {
	#	limit = { primary_culture = maori }
	#	country_event = { id = polynesian.26 }
	#}
	if = {
		limit = { has_any_heir_cult_active = yes }
		remove_heir_cult = yes
	}
}

on_defender_of_faith_loss_effect = {
	clr_country_flag = claimed_defender_of_faith_flag
	#remove_country_modifier = liv_the_livonian_defender
	remove_country_modifier = gov_improved_defender_of_faith_mod
	#remove_country_modifier = pol_shield_against_catholicism_modifier
	#remove_country_modifier = per_persian_defender_of_faith
}
on_defender_of_faith_claim_effect = {
	set_country_flag = claimed_defender_of_faith_flag
	#if = {
	#	limit = {
	#		religion = catholic
	#		has_country_flag = liv_the_livonian_defender_flag
	#		NOT = { has_country_modifier = liv_the_livonian_defender }
	#	}
	#	add_country_modifier = {
	#		name = liv_the_livonian_defender
	#		duration = -1
	#		desc = liv_the_livonian_defender_tt
	#	}
	#}
	if = {
		limit = {
			has_government_attribute = improved_defender_of_faith
		}
		add_country_modifier = {
			name = gov_improved_defender_of_faith_mod
			duration = -1
		}
	}
	#if = {
	#	limit = {
	#		has_country_flag = per_gain_persian_dotf_buff
	#	}
	#	add_country_modifier = {
	#		name = per_persian_defender_of_faith
	#		duration = -1
	#		desc = UNTIL_NO_MORE_DOTF
	#	}
	#}
}

on_advisor_removed_effct_adm = {}
on_advisor_removed_effct_dip = {}
on_advisor_removed_effct_mil = {}
on_advisor_removed_effct = {
	on_advisor_removed_effct_$type$ = yes
	#remove_country_modifier = zoroastrian_prophet_in_the_court
}


on_built_tax_building_effect = {
	if = {
		limit = {
			owner = { has_country_flag = can_place_center_of_reformation }
			is_reformation_center = no
			expelling_minorities = no
			NOT = {
				any_neighbor_province = {
					is_reformation_center = yes
				}
			}
			NOT = {
				any_province = {
					area = PREV
					is_reformation_center = yes
					#religion = zoroastrian
				}
			}
			OR = {
				has_owner_religion = yes
				NOT = { has_active_triggered_province_modifier = religious_center }
			}
		}
		if = {
			limit = { development = 31 }
			custom_tooltip = TOO_MUCH_DEV_FOR_CENTER_OF_CONVERSION_TT
		}
		#else = {
		#	hidden_effect = { 
		#		owner = { 
		#			clr_country_flag = can_place_center_of_reformation 
		#		} 
		#		1 = {
		#			change_variable = {
		#				which = zoroastrian_reform_center_counter
		#				value = 1
		#			}
		#		}
		#	}
		#	change_religion = zoroastrian
		#	add_reform_center = zoroastrian
		#}
	}
	
	#Drozma Tur
	if = {
		limit = {
			owner = {
				religion = drozma_tur
				has_church_aspect = aspire_power_aspect_dip
			}
		}
		add_base_manpower = 1
		owner = {
			add_church_power = 5
		}
	}
	dt_community_advancement_institution_spread_effect = yes 
	dt_community_recognition_mil_effect = yes

	if = {
		limit = { owner = { mission_completed = ap_xiaken_temple_grounds } }
		add_province_modifier = { name = xiaken_temple_grounds_mod duration = -1 }
	}
}

on_built_manpower_building_effect = {
	
	#Drozma Tur
	if = {
		limit = {
			owner = {
				religion = drozma_tur
				has_church_aspect = aspire_wisdom_aspect_dip
			}
		}
		owner = {
			add_church_power = 5
			change_government_reform_progress = 2
		}
	}

}

on_built_production_building_effect = {

	#Drozma Tur
	dt_community_recognition_mil_effect = yes

}

on_built_manufactory_effect = {

	#Drozma Tur
	if = {
		limit = {
			owner = {
				religion = drozma_tur
				has_church_aspect = community_advancement_aspect_adm
			}
			NOT = {
				has_province_modifier = dt_communities_advancement_prosperity
			}
		}
		add_province_modifier = {
			name = dt_communities_advancement_prosperity
			duration = -1
		}
	}
	# Tribute
	if = {
		limit = {
			OR = {
				region = rakhadesh_region
				region = rahen_coast_region
			}
		}
		random_list = { 
			1 = {
				province_event = { id = rahen.200 }
			}
			19 = { }
		}
	}

}

on_capital_moved_effect = {
}

on_government_change_effect = {
	clr_country_flag = pirate_mutineer_council
	clr_country_flag = caretaker_revolutionary_government
	if = {
		limit = {
			NOT = { government = monarchy }
			any_owned_province = { has_province_modifier = domain_of_spouses_family }
		}
		random_owned_province = {
			limit = { has_province_modifier = domain_of_spouses_family }
			remove_province_modifier = domain_of_spouses_family
		}
	}
	if = {
		limit = {
			NOT = { government = monarchy }
			any_owned_province = { has_province_modifier = home_of_consort }
		}
		random_owned_province = {
			limit = { has_province_modifier = home_of_consort }
			remove_province_modifier = home_of_consort
		}
	}
	if = {
		limit = { 
			owner = {
				has_estate_privilege = artifice_invention_arcane_battery_capital_complex
			}
		}
		FROM = { 
			remove_province_modifier = artifice_arcane_battery_capital_complex
		}
		ROOT = {
			add_province_modifier = {
				name = artifice_arcane_battery_capital_complex
				duration = -1
			}
		}
	}
	#if = {
	#	limit = {
	#		OR = {
	#			tag = ENG
	#			tag = GBR
	#		}
	#		any_owned_province = { has_province_modifier = rotten_borough }
	#	}
	#	every_owned_province = {
	#		limit = { has_province_modifier = rotten_borough }
	#		remove_province_modifier = rotten_borough
	#	}
	#}
	if = {
		limit = { has_country_modifier = the_reign_of_terror }
		remove_country_modifier = the_reign_of_terror
	}
	if = {
		limit = {
			has_global_flag = great_peasants_war_flag
			is_part_of_hre = yes
			has_government_attribute = is_peasants_republic
		}
		1 = {
			change_variable = {
				which = GPW_counting_variable
				value = -3
			}
		}
	}
	if = {
		limit = {
			num_of_subjects = 1
			any_subject_country = {
				is_subject_of_type = cultural_sphere_of_influence_subject
			}
		}
		country_event = { id = persian_influence_events.3000 }
	}
	if = {
		limit = { NOT = { has_government_attribute = heir } }
		remove_country_modifier = heir_mage_personality_mod
	}
	if = {
		limit = { NOT = { has_government_attribute = queen } }
		remove_country_modifier = consort_mage_personality_mod
	}
}

on_non_estate_disaster_end = {
	hidden_effect = {
		change_variable = {
			which = total_disasters_completed_counter
			value = 1
		}
	}
}

on_startup_effect = {
	#if = {
	#	limit = {
	#		NOT = { has_country_flag = new_flavour_bav_13_has_been_triggered }
	#		OR = {
	#			tag = UBV
	#			tag = LBV
	#			tag = ING
	#		}
	#	}
	#	set_country_flag = new_flavour_bav_13_has_been_triggered
	#	country_event = { id = new_flavour_bav.13 days = 90 } #better not to allow almost instant DOWs
	#}
	#if = {
	#	limit = {
	#		OR = {
	#			has_country_modifier = rise_of_the_ottomans
	#			has_country_modifier = zenith_of_the_ottomans
	#			has_country_modifier = twilight_of_the_ottomans
	#			has_country_modifier = decline_of_the_ottomans
	#		}
	#	}
	#	remove_country_modifier = rise_of_the_ottomans
	#	remove_country_modifier = zenith_of_the_ottomans
	#	remove_country_modifier = twilight_of_the_ottomans
	#	remove_country_modifier = decline_of_the_ottomans
	#}
	#if = {
	#	limit = {
	#		has_government_mechanic = ottoman_decadence_mechanic
	#		current_age = age_of_discovery
	#	}
	#	add_country_modifier = {
	#		name = rise_of_the_ottomans
	#		duration = -1
	#		desc = until_end_of_age_desc
	#	}
	#}
	#if = {
	#	limit = {
	#		has_government_mechanic = ottoman_decadence_mechanic
	#		current_age = age_of_reformation
	#	}
	#	add_country_modifier = {
	#		name = zenith_of_the_ottomans
	#		duration = -1
	#		desc = until_end_of_age_desc
	#	}
	#}
	#if = {
	#	limit = {
	#		has_government_mechanic = ottoman_decadence_mechanic
	#		current_age = age_of_absolutism
	#	}
	#	add_country_modifier = {
	#		name = twilight_of_the_ottomans
	#		duration = -1
	#		desc = until_end_of_age_desc
	#	}
	#}
	#if = {
	#	limit = {
	#		has_government_mechanic = ottoman_decadence_mechanic
	#		current_age = age_of_revolutions
	#	}
	#	add_country_modifier = {
	#		name = decline_of_the_ottomans
	#		duration = -1
	#		desc = until_end_of_age_desc
	#	}
	#}
}

on_startup_dlc_cleanup_effect = {
	#if = {
	#	limit = {
	#		has_dlc = "Cradle of Civilization"
	#		has_country_modifier = tur_janissary
	#	}
	#	remove_country_modifier = tur_janissary
	#}
}

feast_of_the_gods_won_war_count = {
	if = {
		limit = {
			OR = {
				religion = feast_of_the_gods
				religion = reformed_feast_of_the_gods
			}
		}
		change_variable = { fotg_war_wins = 1 }
	}
}

fotg_reform_variable = {
	if = {
		limit = { 
			NOT = {
				OR = {
					has_country_flag = fotg_reforms_1
					has_country_flag = fotg_reforms_2
					has_country_flag = fotg_reforms_3
					has_country_flag = fotg_reforms_4
					has_country_flag = fotg_reforms_5
				}
			}
		}
		set_country_flag = fotg_reforms_1
	}

	else_if = {
		limit = { 
			has_country_flag = fotg_reforms_1 
		}
		set_country_flag = fotg_reforms_2
		clr_country_flag = fotg_reforms_1
	}

	else_if = {
		limit = { 
			has_country_flag = fotg_reforms_2 
		}
		set_country_flag = fotg_reforms_3
		clr_country_flag = fotg_reforms_2
	}
	else_if = {
		limit = { 
			has_country_flag = fotg_reforms_3 
		}
		set_country_flag = fotg_reforms_4
		clr_country_flag = fotg_reforms_3
	}
	else_if = {
		limit = { 
			has_country_flag = fotg_reforms_4 
		}
		set_country_flag = fotg_reforms_5
		clr_country_flag = fotg_reforms_4
	}
}

anb_on_province_owner_change_government_reform_effect = {
	if = {
		limit = { 
			trade_goods = tropical_wood 
			owner = {
				has_reform = wood_elf_clan_inward_focus
			}
		}
		add_province_modifier = {
			name = deepwoods_government_reform_isolation_mod
			duration = -1
		}
	}
	if = {
		limit = {
			religion = regent_court
			owner = {
				has_government_attribute = two_rulers_one_people_cor
			}
		}
		add_province_modifier = {
			name = two_rulers_one_people_modifier
			duration = -1
		}
	}
	if = {
		limit = {
			religion = corinite
			owner = {
				has_government_attribute = two_rulers_one_people_rc
			}
		}
		add_province_modifier = {
			name = two_rulers_one_people_modifier
			duration = -1
		}
	}
	if = {
		limit = { 
			owner = { has_reform = kheionai_the_urban_litea } 
			has_terrain = city_terrain
		}
		add_urban_litea_modifiers = yes
		if = {
			limit = {
				area_for_scope_province = {
					type = all
					NOT = { has_province_modifier = kheionai_the_urban_litea_state_mod }
				}
			}
			add_province_modifier = {
				name = kheionai_the_urban_litea_state_mod
				duration = -1
			}
		}
	}
}

startup_1444_effects = {
	# runs on startup, for effects that should only happen at game startup in 1444 (so NOT for releasables)
	if = {
		limit = {
			NOT = {
				has_country_flag = startup_1444_completed
				is_year = 1445	# is 1444
				is_month = 11	# is november (this trigger is 0-based, 11 is december)
			}
		}
		set_country_flag = startup_1444_completed

		###########################
		# STARTUP EFFECTS GO HERE #
		###########################


		#ruler optimization

		if = {
			limit = { ai = no }
			REB = {
				random_variable = { randnum = 4092 }
				round_variable = { which = randnum value = 0 }
			}
		}

		if = {
			limit = { is_playing_custom_nation = yes }
			clear_fast_ruler_flags = yes
			clear_fast_consort_flags = yes
			clear_fast_heir_flags = yes
		}
		#custom nations fire on_new_monarch when you spawn them
		#so their monarch has the flags of the original nation, not the new culture
		#clear all the flags before resetting them here to fix that

		update_ruler_racial_flag = yes
		update_heir_racial_flag = yes
		update_consort_racial_flag = yes

		update_artifice_points = yes
		update_research_speed = yes

		# Raj setup
		if = { limit = { tag = R51 }
			rahen_raj_variables_startup = yes
			country_event = { id = rahenraj.90 days = 120 random = 60 }
		}

		if = {
			limit = {
				religion_group = cannorian
				OR = {
					has_reform = adventurer_reform
					tag = B55
					tag = B36
				}
			}
			country_event = { id = corinite.100 days = 365}
		}
		if = {
			limit = {
				capital_scope = { superregion = western_cannor_superregion }
				religion_group = cannorian
				NOT = {
					has_reform = adventurer_reform
					tag = B55
					tag = B36
				}
			}
			country_event = { id = corinite.101 days = 365}
		}
		if = {
			limit = {
				OR = {
					tag = Z15
					tag = Z08
				}
			}
			country_event = { id = ebonsteel_events.2 }
		}

		if = {
			limit = {
				OR = {
					was_tag = Y20
					tag = Y20
				}
			}
			save_global_event_target_as = feiten_or_was_feiten_target
		}

		if = {
			limit = { tag = REB }
			emperor = {
				save_global_event_target_as = Emperor
			}
		}

		if = {
			limit = { is_emperor_of_china = yes }
			save_global_event_target_as = EmperorOfChina
		}
	
		if = {
			limit = {
				religion = aakhetist
				has_country_flag = current_aakhet_host
			}
			save_global_event_target_as = aakhet_host
		}

		if = {
			limit = {
				tag = A06
			}
			A06 = { 
				country_event = { id = gnomish.4 days = 1830 } #Gawed truce
				add_estate_loyalty = { #Nimscodd estates start at 49% loyalty
					estate = all
					loyalty = 1
				}
			}
		}

		if = {
			limit = {
				tag = S70
			}
			S70 = { country_event = { id = shadow.1 } } #Yezel Mora starting event
		}

		if = {
			limit = {
				ai = no
				capital_scope = {
					superregion = ynn_superregion
				}
			}
			country_event = { id = ynn_events.991 days = 30 }
		}

		if = {
			limit = {
				tag = G26
			}
			country_event = { id = flavour_amacimst.0 days = 15 }
		}

		##aakhetist starting tags minus aramoole
		if = {
			limit = { 
				tag = F70 #Mattabo 
			}
			country_event = { id = aakhetist.04 }
		}

		if = {
			limit = {
				has_country_flag = has_caste_estates
			}
			#Introduction to the castes
			country_event = {
				id = estate_castes_events.0
				days = 15
			}
		}

		# Add wine to Wine Lords
		if = {
			limit = {
				OR = {
					has_reform = wine_lord_reform
					has_reform = roilsard_elective
					has_reform = wineport_merchants
				}
			}
			every_owned_province = {
				limit = {
					trade_goods = wine
				}
				add_province_modifier = {
					name = wine_lord_wine
					duration = -1
					hidden = yes
				}
			}
		}
		
		# Add sugar bonus to Keyolion (From Gov Reform)
		if = {
			limit = {
				has_reform = G58_agronomers_association_reform
			}
			every_owned_province = {
				limit = {
					trade_goods = sugar
				}
				add_province_modifier = {
					name = G58_sugar_province_goods
					duration = -1
					hidden = yes
				}
			}
		}

		# Frontier Republics
		if = {
			limit = {
				has_reform = frontier_republic_reform
			}
			every_owned_province = {
				limit = {
					trade_goods = livestock
				}
				add_province_modifier = {
					name = livestock_boost_frontier
					duration = -1
					hidden = yes
				}
			}
			every_owned_province = {
				limit = {
					has_terrain = steppe
				}
				add_province_modifier = {
					name = frontier_republic_steppe_expansion
					duration = -1
					hidden = yes
				}
			}
		}

		#Mulen goblin setup
		if = {
			limit = { tag = F50 }
			country_event = {
				id = flavour_mulen.3
				days = 3650
			}
		}

		#company of thorns high stability
		if = {
			limit = { tag = B11 }
			country_event = {
				id = flavor_luciande.54
				days = 30
			}
		}

		if = {
			limit = {
				capital_scope = {
					OR = {
						superregion = escann_superregion
						region = forlorn_vale_region
					}
					NOT = {
						region = dostanor_region
						region = ourdia_region
						region = daravans_folly_region
					}
				}
				NOT = {
					culture_group = orcish
					culture_group = goblin
				}
				NOT = { tag = A32 }	#Dont let Ibevar, Silent Repose, and Orda Aldresia get this
				NOT = { tag = A83 }
				NOT = { tag = A77 }
			}
			country_event = { id = greentide.0 days = 1 }
		}

		if = {
			limit = {
				tag = G40 # Tehanek
			}
			country_event = { id = damestear.4 days = 14600 random = 3650 }
		}


		if = {
			limit = {
				capital_scope = {
					OR = {
						superregion = escann_superregion
						region = forlorn_vale_region
					}
					NOT = { region = dostanor_region region = ourdia_region }
				}
				culture_group = orcish
			}
			country_event = { id = greentide.1 days = 1 }
		}

		if = {
			limit = {
				capital_scope = {
					OR = {
						superregion = escann_superregion
						area = gulletpeak_area
						region = forlorn_vale_region
					}
					NOT = { region = dostanor_region region = ourdia_region }
				}
				culture_group = goblin
			}
			country_event = { id = greentide.6 days = 6 }
		}

		if = {
			limit = {
				tag = Z18
			}
			country_event = { id = greentide.2 } #graytide
			country_event = { id = flavor_frozenmaw.2 days = 1200 random = 30 } #caught between worlds
			country_event = { id = flavor_frozenmaw.4 days = 800 random = 20 } #Bakram Winterwind
			country_event = { id = flavor_frozenmaw.10 days = 30 } #Marosh in Corintar
		}

		if = {
			limit = {
				culture = white_reachman
			}
			country_event = { id = greentide.3 days = 1 }
		}
	
		if = {
			limit = {
				capital_scope = { superregion = deepwoods_superregion }
				religion = great_dookan
			}
			country_event = { id = greentide.4 days = 20 }
		}
		
		if = {
			limit = {
				tag = A32
				NOT = { has_country_flag = ibevar_reformation_flag }
			}
			every_owned_province = {
				limit = { has_province_modifier = ibevar_old_tradition }
				set_variable = { which = ibReform value = 100 }
			}
			set_country_flag = ibevar_reformation_flag
		}
	
		if = {
			limit = {
				tag = Y58
			}
			country_event = { id = lotdekkhang.4 days = 3 } #Lot Dekkhang intro event and setting up hobgoblin tolerance
		}
	
		if = {
			limit = {
				owns_core_province = 4565
			}
			country_event = { id = bim_lau_flavour.4 days = 1 } #Bim Lau Necropolis Setup
    	}
	
    	if = {
			limit = {
				tag = Y09
			}
			country_event = {
				id = bianfang.7 	#tyrant system setup
				days = 1
			}
		}

		if = {
			limit = {
				tag = A13
			}
			country_event = {
				id = flavor_gawed.4 			#Derek Deland
				days = 10
			}
		}
	
		#Tamran civil war events START
		if = {
			limit = {
				tag = Y97 #Baihon Xinh
			}
			country_event = { id = flavour_baihon_xinh.1 }
		}
		#Tamran civil war events END

		if = {
			limit = {
				has_dlc = "Cradle of Civilization"
				has_country_modifier = tur_janissary
			}
			remove_country_modifier = tur_janissary
		}

		anb_initialize_schools_effect = yes

		if = {
			limit = { OR = { tag = J06 tag = J07 } }
			country_event = { id = lake.42 } #Explain Ultakal Decree
		}
		#Mother Akasik event cycle start
		if = {
			limit = {
				NOT = { has_global_flag = akasik_cycle_timer }
			}
			set_global_flag = akasik_cycle_timer
			random_country = {
				country_event = {
					id = mother_akasik.4
					days = 1315
				}
			}
		}
		set_global_flag = mother_akasik_2

		#Mother akasik mountain count start
		if = {
			limit = { tag = REB }
			country_event = { id = mother_akasik.0 }
		}
	
		if = {
			limit = { tag = R51 NOT = { check_variable = { diplomaticAnnexations = 1 } } }
			set_variable = { diplomaticAnnexations = 0 }
		}

		ynnic_setup_effect = yes

		#Ynn Worship event cycle start
		if = {
			limit = {
				NOT = { has_global_flag = ynn_cycle_timer }
			}
			set_global_flag = ynn_cycle_timer
			random_country = {
				country_event = {
					id = ynn_zodiac.1
					days = 1145
				}
			}
		}
		set_global_flag = ynn_zodiac_7
	
		if = {
			limit = {
				tag = G33
			}
			country_event = { id = flavour_bosancovac.010 }
		}
	
		# Expedition
		if = {
			limit = { tag = REB }
			country_event = { id = diggy_expedition.0 }
		}
	
		if = { #Starts Azjakuma - Command Truce | sets event to give aikogeoke to owner of akhortosal 70 years after start
			limit = {
				tag = Y01
			}
			country_event = {
				id = flavor_azjakuma.15
				days = 15
			}
		}
	
		#Remnant colonist removal
		if = {
			limit = {
				has_country_flag = dwarovar_remnant
				NOT = { has_country_flag = remnant_stagnation_disaster_end }
				NOT = { has_country_modifier = remnant_legacy }
			}
			add_country_modifier = { name = remnant_legacy duration = 31 hidden = yes }
		}
	
		if = { #sets dev cost reduction in capital area on game start, might move to history files once all governments are in
			limit = {
				has_government_attribute = lower_dev_cost_in_capital_state
				NOT = { capital_scope = { has_province_modifier = lower_dev_cost_in_capital_state_modifier } }
			}
			capital_scope = {
				area = {
					limit = { owned_by = ROOT }
					add_province_modifier = {
						name = lower_dev_cost_in_capital_state_modifier
						duration = -1
						hidden = yes
					}
				}
			}
		}
		if = { #Sri Baginda extra dev cost reduction in capital
			limit = {
				is_sri_baginda = yes
				NOT = { capital_scope = { has_province_modifier = sri_baginda_lower_dev_cost_capital_mod } }
			}
			capital_scope = {
				area = {
					limit = { owned_by = ROOT }
					add_province_modifier = {
						name = sri_baginda_lower_dev_cost_capital_mod
						duration = -1
						hidden = yes
					}
				}
			}
		}
		if = { #sets gov cost reduction in capital region on game start, might move to history files once all governments are in
			limit = {
				has_government_attribute = lower_gov_cost_in_home_region
				NOT = { capital_scope = { has_province_modifier = lower_gov_cost_in_home_region_modifier } }
			}
			capital_scope = {
				region = {
					limit = { owned_by = ROOT }
					add_province_modifier = {
						name = lower_gov_cost_in_home_region_modifier
						duration = -1
						hidden = yes
					}
				}
			}
		}
	
		# Nekheis cheap colonies modifier and event to make them start colonizing
		if = {
			limit = {
				OR = {
					tag = G53 #Empkeios
					tag = G58 #Keyolion
					tag = G55 #Eneion
					tag = G54 #Besolaki
					tag = G57 #Apikhoxi
					tag = G59 #Anisikheion
					tag = G56 #Deyeion
					tag = G62 #Amgremos
				}
			}
			add_country_modifier = {
				name = nekheis_cheap_colonies
				duration = 18250 #50 years
			}
			country_event = {
				id = kheionai.200
			}
		}
		if = { #Ameion doesn't need help colonizing so they just get the event
			limit = { tag = G52 } #Ameion
			country_event = { id = kheionai.200 }
		}
		
		# Dwarovar cheap colonies modifier and event to make them start colonizing
		if = {
			limit = {
				OR = {
					tag = M01 #Grizehud
					tag = M02 #Dursikari
					tag = H73 #Skewered Drake
				}
			}
			country_event = {
				id = diggy.759
			}
		}
		
		#Effelai Worship Startup Events
		if = {
			limit = {
				religion = chahinanito
				NOT = {
					num_of_cities = 2
				}
			}
			country_event = {
				id = effelai_worship.2
			}
		}
		if = {
			limit = {
				religion = tswohvwohii
				NOT = {
					num_of_cities = 2
				}
			}
			country_event = {
				id = effelai_worship.402
			}
		}
		if = {
			limit = {
				religion = senanset
				NOT = {
					num_of_cities = 2
				}
			}
			country_event = {
				id = effelai_worship.302
			}
		}
		if = {
			limit = { #Thavoii blood hunts startup event, for player only
				tag = G19
				ai = no
			}
			country_event = {
				id = effelai_worship.601
				days = 20
			}
		}
		if = { #laii bonehunt startup event, for player only
			limit = {
				tag = G18
				ai = no
			}
			country_event = {
				id = effelai_worship.531
				days = 20
			}
		}
		if = { #soruinic festival site startup event, for player only
			limit = {
				tag = G16
				ai = no
			}
			country_event = {
				id = effelai_worship.521
				days = 20
			}
		}
		if = { #effei sapling spot startup event, for player only
			limit = {
				tag = G17
				ai = no
			}
			country_event = {
				id = effelai_worship.541
				days = 20
			}
		}

		#dwarovar reclaimer
		if = { limit = { capital_scope = { continent = serpentspine } }
			add_country_modifier = { name = reclaiming_dwarovar duration = -1 }
		}

		# fotg setup
		if = {
			limit = {
				religion = feast_of_the_gods
			}
			set_variable = {
				which = fotg_war_wins
				value = 0
			}
		}

		if = {
			limit = { NOT = { has_global_flag = rending_setup } }
			set_global_flag = rending_setup
			update_global_ward_strength = yes
		}

		#rending ma appeasement pillage counter
		if = {
			limit = {
				capital_scope = {
					OR = {
						superregion = rahen_superregion
						superregion = yanshen_superregion
						superregion = vimdatrong_superregion
					}
				}
			}
			set_variable = {
				which = rending_pillage_counter_variable
				value = 0
			}
		}
		if = {
			limit = { NOT = { has_global_flag = suhan_setup } }
			set_global_flag = suhan_setup
			4411 = {
				set_variable = {
					value = 0
					which = suhanProgress
				}
			}
		}

		#cardesti starup
		if = {
			limit = {
				tag = REB
			}
			country_event = { id = cardesti_events.21 days = 30 }
		}

		if = { #dakinshi warlord startup
			limit = {
				OR = {
					has_reform = dakinshi_warlord_reform
					tag = L63
				}
			}
			country_event = {
				id = dakinshi_events.1
			}
		}

		#AI needs this mission event early to stop it from releasing stuff
		if = {
			limit = {
				tag = A30
				ai = yes
			}
			country_event = { id = flavor_wex.2 }
		}

		if = {
			limit = {
				tag = V01
			}
			country_event = { id = oinukhudi.1 days = 2 }
		}

		#Undergrowth
		if = {
			limit = {
				OR = {
					tag = H88
					tag = H92
					tag = H93
				}
			}
			country_event = {
				id = undergrowth_goblin.2
			}
		}

		# Ovdal Tungr DLC warnings
		#if = { limit = { tag = F23 }
		#	country_event = { id = flavour_ovdal_tungr.1000 }
		#}

		#taric and cagodic migrations assimilation
		if = {
			limit = {
				owns = 700
			}
			700 = { province_event = { id = gerudia.28 days = 18250 } }
		}

		if = {
			limit = {
				culture_group = kheionai_ruinborn_elf
				ai = no
			}
			country_event = {
				id = kheionai.30
				days = 730
			}
		}

		#Gisden Start Event
		if = {
    		limit = {
				tag = A75 
			}
    		country_event = {
				id = gisden.1 days = 30
			}
		}

		#Duwarkani start event
		if = {
			limit = {
				tag = F62
			}
			country_event = {
				id = flavor_duwarkani.1
				days = 30
			}
		}

		if = {	#Gophira starting event
			limit = { tag = G74 }
			country_event = { id = gophira.1 }
		}
		
		#Making Dursikari non-migratory if AI to stop them from blocking player
		if = {
			limit = {
				tag = M02
				ai = yes
			}
			add_government_reform = dwarovar_squatter
		}

		#Gushuokguan
		if = {
			limit = { tag = Y17 } #Gushuokguan
			set_variable = {
				which = gushuokguan_rented_condottieri_counter
				value = 0
			}
			set_country_flag = count_battles_won
			set_variable = {
				which = gushuokguan_siege_counter
				value = 0
			}
			set_variable = {
				which = gushuokguan_scorched_earth_counter
				value = 0
			}
			set_variable = {
				which = gushuokguan_event_counter
				value = 0
			}
		}
		
		if = {
			limit = { tag = Y58 } #Lot Dekkhang
			set_country_flag = awakened_lapnam
			set_variable = {
				which = lapnam_amrik_battle_counter
				value = 0
			}
		}

		#Gotiriei
		if = {
			limit = { religion = gotiriei }
			country_event = { id = gotiriei_pilgrimage.0 days = 31 }
		}

		# Applying Flooded Depths to Ovdal Tungr.
		if = {
			limit = { tag = F23	}
			526 = { add_permanent_province_modifier = { name = F23_flooded_depths duration = -1 } }
		}

		if = {
			limit = { tag = R11 }
			country_event = { id = khadisrapur.1 days = 30 random = 30 }
		}

		if = { limit = { culture_group = harpy }
			harpy_roost_se_setup = yes

			if = {
				limit = {
					660 = {
						owned_by = PREV
						has_great_project = { type = queens_throne tier = 1 }
					}
				}
				set_country_flag = harpy_roost_queens_throne_has_tier_1_free_roost
				harpy_roost_se_allow_construction_of_extra_roost = yes
			}
		}

		if = {
			limit = { tag = L81 }
			country_event = { id = flavour_yassa.29 days = 365 }
		}

		if = {
			limit = { tag = L95 } #Rayaz
			country_event = { id = rayaz_event.1 }
		}

		if = {
			limit = { tag = J78 }	#Uesrennu
			country_event = { id = uesrennu.1 }
		}

		#Aldarian event chain
		if = {
			limit = {
				owns_core_province = 622 #Setadazar
			}
			622 = {
				province_event = {
					id = bulwar_flavour.139
					days = 11401
					random = 365
				}
			}
		}

		if = { #Tribal Chendhyans
			limit = {
				has_reform = chendhyan_tribal_federation
			}
			if = {
				limit = { ai = no }
				add_country_modifier = {
					name = chendhya_ramping_up_1
					duration = -1
				}
			}
			else = {
				add_country_modifier = {
					name = chendhya_ai_modifier
					duration = -1
				}
			}
			every_country = {
				limit = { 
					OR = {
						culture_group = kheionai_ruinborn_elf
						culture_group = taychendi_ruinborn_elf
						culture_group = devandi_ruinborn_elf
					}
					NOT = { primary_culture = chendhyan } 
				}
				reverse_add_opinion = {
					who = ROOT
					modifier = chendhyan_threaten_freedom
				}
				add_opinion = {
					who = ROOT
					modifier = chendhyan_threaten_freedom
				}
			}
			if = {
				limit = { tag = H23 } #Kaeorg
				add_casus_belli = {
					type = cb_vassalize_mission
					target = H29 #Tsidarok
				}
				add_casus_belli = {
					type = cb_vassalize_mission
					target = H28 #Durasyar
				}
			}

			if = {
				limit = { tag = H28 } #Durasyar
				add_casus_belli = {
					type = cb_vassalize_mission
					target = H29 #Tsidarok
				}
				add_casus_belli = {
					type = cb_vassalize_mission
					target = H23 #Kaeorg
				}
			}

			if = {
				limit = { tag = H29 } #Tsidarok
				add_casus_belli = {
					type = cb_vassalize_mission
					target = H28 #Durasyar
				}
				add_casus_belli = {
					type = cb_vassalize_mission
					target = H23 #Kaeorg
				}
			}
		}
		
		#Sri Baginda
		if = {
			limit = {
				has_reform = yanglam_tengalam_reform
			}
			set_country_flag = tier_1_baginda
		}

		if = {
			limit = {
				OR = {
					capital_scope = { region = lupulan_rainforest_region }
					OR = {
						tag = Y72 #Chien
						tag = Y73 #Sirtan
						tag = Y97 #Baihon
					}
				}
			}
			country_event = { id = lupulan_events.1000 }
		}

		#Haless Tribute Event
		if = {
			limit = { ai = no }
			export_to_variable = {
				which = monarch_reign_start_dev
				value = total_development
				who = ROOT
			}
		}

		#Escanni refugees
		if = {
			limit = { owns = 451 }
			451 = { #Nathalaire
				province_event = {
					id = escanni_refugees_settlement.312
					days = 2700
				}
			}
		}
		if = {
			limit = { owns = 723 }
			723 = { #Bayvic
				province_event = {
					id = escanni_refugees_settlement.311
					days = 2800
				}
			}
		}
		if = { #Arbaran
			limit = { tag = A46 }
			country_event = {
				id = escanni_refugees_settlement.314
				days = 2250
			}
		}
		if = { #Gawed
			limit = { tag = A13 }
			country_event = {
				id = escanni_refugees_settlement.313
				days = 2250
			}
		}

		if = { #Salla Ayeth
			limit = { tag = I33 }
			country_event = {
				id = flavour_ayeth.1
				days = 23
			}
		}
		if = {
			limit = { owns = 5921 }
			5921 = {
				province_event = { id = empire_333.98 days = 717 } #333 empire Thraxis timer set
			}
		}
	}
}

on_province_owner_change_effect = {
	on_province_owner_change_government_effect = yes
	on_province_owner_change_estate_privileges_effect = yes
	anb_on_province_owner_change_government_reform_effect = yes
	#Anbennar

	if = {
		limit = {
			FROM = {
				is_migratory_tribe = yes
				NOT = { num_of_cities = 2 } # be extra safe - check they're an OPM
			}
			is_empty = yes
			NOT = { has_province_flag = someone_migrated_here_dawg }
		}
		# note this province was migrated out of so the culture change event handles it properly
	
		if = {
			limit = {
				FROM = { NOT = { has_country_flag = majority_setup_complete } }
			}
			# fix edge case - if you migrate immediately without unpausing (after uncolonised but before country setup)
			# the province you migrated out of has no majority
			# only possible if the person migrating has not done majority setup yet, so fix here
			add_majority_of_current_culture = yes	
		} 
	
		set_province_flag = someone_migrated_here_dawg
		#we have the define that clears province flags on becoming unowned AIYEEEE, surely i can set it on uncolonised provinces

		if = { limit = { FROM = { has_country_flag = migratory_small_minority } }
			set_province_flag = migratory_small_minority
			FROM = { clr_country_flag = migratory_small_minority }
		}
		else_if = { limit = { FROM = { has_country_flag = migratory_large_minority } }
			set_province_flag = migratory_large_minority
			FROM = { clr_country_flag = migratory_large_minority }
		}
		# oh the clunkiness, transfer the flags from country to province
		# now when the culture update is called, it will save whether there was a small or large minority, so it can be restored later
	}

	#Krakazol/Rahen initial friendship, formerly rahen.1

	if = {
		limit = {
			province_id = 4266
			owner = { culture_group = dwarven has_reform = dwarovar_adventurer_reform }
			4462 = { #keppakazol
				owner = {
					is_subject = no
					NOT = { tag = R62 }
				}
			}
		}
		4462 = { owner = { country_event = { id = rahen.1 days = 60 } } } #delay so ai attitude switches from unknown
	}

	if = {
		limit = {
			trade_goods = gold
			NOT = { has_province_modifier = estate_burghers_control_over_gold_mine }
			owner = {
				has_estate_privilege = estate_burghers_control_over_the_mint
			}
		}
		add_province_modifier = {
			name = estate_burghers_control_over_gold_mine
			duration = -1
		}
	}

	#ANBENNAR
	if = {
		limit = {
			NOT = { has_province_modifier = wine_lord_wine }
			OR = {
				owner = { has_reform = wine_lord_reform }
				owner = { has_reform = roilsard_elective }
				owner = { has_reform = wineport_merchants }
			}
		}
		hidden_effect = {
			if = {
				limit = {
					trade_goods = wine
				}
				add_province_modifier = {
					name = wine_lord_wine
					duration = -1
					hidden = yes
				}
			}
		}
	}

	if = {
		limit = {
			NOT = { has_province_modifier = J84_masquerade_relics }
			owner = { has_estate_privilege = estate_vampire_law_relic_shrouded_masquerade }
			trade_goods = precursor_relics
		}
		add_province_modifier = {
			name = J84_masquerade_relics
			duration = -1
			hidden = yes
		}
	}

	if = {
		limit = {
			NOT = { has_province_modifier = livestock_boost_frontier }
			owner = { has_reform = frontier_republic_reform }
		}
		hidden_effect = {
			if = {
				limit = {
					trade_goods = livestock
				}
				add_province_modifier = {
					name = livestock_boost_frontier
					duration = -1
					hidden = yes
				}
			}
		}
	}

	if = {
		limit = {
			NOT = { has_province_modifier = frontier_republic_steppe_expansion }
			owner = { has_reform = frontier_republic_reform }
		}
		hidden_effect = {
			if = {
				limit = {
					has_terrain = steppe
				}
				add_province_modifier = {
					name = frontier_republic_steppe_expansion
					duration = -1
					hidden = yes
				}
			}
		}
	}

	#ANBENNAR
	if = {
		limit = {
			NOT = { 
				OR = {
					has_province_modifier = lupulan_primary_modifier
					has_province_modifier = lupulan_modifier
				}
			}
			owner = { has_country_flag = rending_lupulan_reward_primary }
		}
		hidden_effect = {
			if = {
				limit = {
					OR = {
						has_terrain = jungle
						has_climate = tropical
					}
				}
				add_province_modifier = {
					name = lupulan_primary_modifier
					duration = -1
				}
			}
		}
	}
	#ANBENNAR
	if = {
		limit = {
			NOT = { 
				OR = {
					has_province_modifier = lupulan_primary_modifier
					has_province_modifier = lupulan_modifier
				}
			}
			owner = { has_country_flag = rending_lupulan_reward }
		}
		hidden_effect = {
			if = {
				limit = {
					OR = {
						has_terrain = jungle
						has_climate = tropical
					}
				}
				add_province_modifier = {
					name = lupulan_modifier
					duration = -1
				}
			}
		}
	}


	#ANBENNAR
	#Cleaning up holy order upgrade modifiers
	if = {
		limit = { has_province_modifier = corinite_balgar_upgraded }
		area = { remove_province_modifier = corinite_balgar_upgraded }
	}
	else_if = {
		limit = { has_province_modifier = corinite_corin_upgraded }
		area = { remove_province_modifier = corinite_corin_upgraded }
	}
	else_if = {
		limit = { has_province_modifier = corinite_falah_upgraded }
		area = { remove_province_modifier = corinite_falah_upgraded }
	}
	else_if = {
		limit = { has_province_modifier = corinite_munas_upgraded }
		area = { remove_province_modifier = corinite_munas_upgraded }
	}
	else_if = {
		limit = { has_province_modifier = corinite_ryala_upgraded }
		area = { remove_province_modifier = corinite_ryala_upgraded }
	}
	#Restoring upgrades if an order was deactivated but not destroyed due to the state only being partially conquered
	if = {
		limit = {
			owner = { has_country_flag = upgraded_balgar }
			holy_order = balgar_order
			area_for_scope_province  = {
				type = all
				owner = {
					ROOT = { owned_by = PREV }
					is_core = PREV
				}
			}
		}
		area = {
			add_permanent_province_modifier = {
				name = corinite_balgar_upgraded
				duration = -1
			}
		}
	}
	else_if = {
		limit = {
			owner = { has_country_flag = upgraded_corin }
			holy_order = corin_order
			area_for_scope_province  = {
				type = all
				owner = {
					ROOT = { owned_by = PREV }
					is_core = PREV
				}
			}
		}
		area = {
			add_permanent_province_modifier = {
				name = corinite_corin_upgraded
				duration = -1
			}
		}
	}
	else_if = {
		limit = {
			owner = { has_country_flag = upgraded_falah }
			holy_order = falah_order
			area_for_scope_province  = {
				type = all
				owner = {
					ROOT = { owned_by = PREV }
					is_core = PREV
				}
			}
		}
		area = {
			add_permanent_province_modifier = {
				name = corinite_falah_upgraded
				duration = -1
			}
		}
	}
	else_if = {
		limit = {
			owner = { has_country_flag = upgraded_munas }
			holy_order = munas_order
			area_for_scope_province  = {
				type = all
				owner = {
					ROOT = { owned_by = PREV }
					is_core = PREV
				}
			}
		}
		area = {
			add_permanent_province_modifier = {
				name = corinite_munas_upgraded
				duration = -1
			}
		}
	}
	else_if = {
		limit = {
			owner = { has_country_flag = upgraded_ryala }
			holy_order = ryala_order
			area_for_scope_province  = {
				type = all
				owner = {
					ROOT = { owned_by = PREV }
					is_core = PREV
				}
			}
		}
		area = {
			add_permanent_province_modifier = {
				name = corinite_ryala_upgraded
				duration = -1
			}
		}
	}

	#ANBENNAR
	#Keyolion goods produced bonus (From Gov Reform)
	if = {
		limit = {
			NOT = { has_province_modifier = G58_sugar_province_goods }
			OR = {
				owner = { has_reform = G58_agronomers_association_reform }
			}
		}
		hidden_effect = {
			if = {
				limit = {
					trade_goods = sugar
				}
				add_province_modifier = {
					name = G58_sugar_province_goods
					duration = -1
					hidden = yes
				}
			}
		}
	}

	if = {
		limit = {
			trade_goods = slaves
			has_country_flag = orldhum_indenture_flag
			NOT = { has_province_modifier = orldhum_indentured_masses }
			NOT = { has_province_modifier = orldhum_major_slave_depot }
			NOT = { has_province_modifier = orldhum_the_chainyard }
		}
		add_province_modifier = { name = orldhum_indentured_masses duration = -1 }
	}

	if = {
		limit = {
			trade_goods = slaves
		}
		if = {
			limit = {
				NOT = { owned_by = B34 }
				OR = {
					has_province_modifier = B34_board_of_chains_boost
					has_province_modifier = B34_board_of_chains_boost_upgraded
					has_province_modifier = B34_board_of_chains_boost_upgraded_2
				}
			}
			remove_province_modifier = B34_board_of_chains_boost
			remove_province_modifier = B34_board_of_chains_boost_upgraded
			remove_province_modifier = B34_board_of_chains_boost_upgraded_2
		}
		else_if = {
			limit = {
				owned_by = B34
				owner = { has_reform = luciande_board_of_chains_reform }
			}
			if = {
				limit = {
					owner = { has_country_flag = luciande_tier3_slaves_flag }
				}
				add_province_modifier = { name = B34_board_of_chains_boost_upgraded_2 duration = -1 hidden = yes }
			}
			else_if = {
				limit = {
					owner = { has_country_flag = luciande_tier2_slaves_flag }
				}
				add_province_modifier = { name = B34_board_of_chains_boost_upgraded duration = -1 hidden = yes }
			}
			else_if = {
				limit = {
					owner = { has_country_flag = luciande_tier1_slaves_flag }
				}
				add_province_modifier = { name = B34_board_of_chains_boost duration = -1 hidden = yes }
			}
		}
	}
	if = {
		limit = {
			owner = {
				has_estate_privilege = artifice_invention_wine_ageifier
			}
			trade_goods = wine
		}
		hidden_effect = {
			add_province_modifier = {
				name = artifice_wine_ageifier
				duration = -1
				hidden = yes
			}
		}
	}
	if = {
		limit = {
			owner = {
				has_estate_privilege = artifice_invention_growth_beans
			}
			OR = {
				trade_goods = grain
				trade_goods = cocoa
				trade_goods = sugar
				trade_goods = wine
				trade_goods = tobacco
				trade_goods = spices
				trade_goods = incense
				trade_goods = tea
				trade_goods = coffee
				trade_goods = fungi
				trade_goods = serpentbloom
			}
		}
		hidden_effect = {
			add_province_modifier = {
				name = artifice_growth_beans
				duration = -1
				hidden = yes
			}
		}
	}
	if = {
		limit = {
			trade_goods = gems
			has_port = yes
			owner = {
				has_estate_privilege = artifice_invention_pearl_cultivators
			}
		}
		hidden_effect = {
			add_province_modifier = {
				name = artifice_pearl_cultivators
				duration = -1
				hidden = yes
			}
		}
	}
	if = {
		limit = {
			province_group = hold_province
			owner = { has_estate_privilege = artifice_invention_superfast_elevators }
		}
		hidden_effect = {
			add_province_modifier = {
				name = artifice_superfast_elevators
				duration = -1
				hidden = yes
			}
		}
	}

	if = { #this was "multiply_colonysize = 0", moved to an event to prevent a race condition crash 1.35
		limit = { owner = { NOT = { num_of_colonists = 1 } ai = yes } is_colony = yes }
		province_event = {
			id = deletecolony.1
		}
	}

	if = {
		limit = {
			owner = { has_country_flag = phoenix_empire_the_sun_outshines_the_moon }
			culture = moon_elf
		}
		add_province_modifier = {
			name = phoenix_empire_the_sun_outshines_the_moon
			duration = -1
		}
	}
	if = {
		limit = {
			owner = { has_country_flag = jaddari_the_western_beacon_flag }
			continent = europe
			NOT = { religion = the_jadd }
		}
		add_province_modifier = {
			name = jaddari_the_western_beacon
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			owner = { has_country_flag = jaddari_remnant_dhenijansar_administration_flag }
			OR = { region = rakhadesh_region region = rahen_coast_region region = dhujat_region }
		}
		add_province_modifier = {
			name = jaddari_remnant_dhenijansar_administration
			duration = -1
			hidden = yes
		}
	}

	if = {
		limit = {
			OR = {
				owner = { has_country_modifier = monstrous_nation }
				owner = { government = tribal }
				owner = { culture_is_ruinborn = yes }
				owner = { has_country_flag = no_ravelian_societies }
			}
			OR = {
				has_province_modifier = ravelian_society
				has_province_modifier = ravelian_lodge
			}
		}
		remove_province_modifier = ravelian_society
		remove_province_modifier = ravelian_lodge
		owner = { country_event = { id = ravelian.21 } }
		# explains why they're fleeing, only one copy will fire as can't have duped unhidden events with same id
		# (if you remove the modifier in this event it will only remove it from one of the provinces you gained if you got multiple)
	}

	if = {
		limit = {
			owner = {
				NOT = { tag = Z45 }
				NOT = { tag = Z26 }
			}
			has_province_modifier = vrorenwood_company
		}
		remove_province_modifier = vrorenwood_company
	}

	if = {
		limit = {
			owner = {
				NOT = {
					overlord = { has_government_attribute = is_raja }
					has_government_attribute = is_raja
				}
			}
		}
		rahen_clear_court_disaster_province_modifiers = yes
	}

	#AI Xhazobkult fake razing
	if = {
		limit = { owner = { religion = xhazobkult ai = yes } }
		xhazobkult_terrain_razing = yes
	}


	if = {
		limit = { has_province_modifier = ghavaanaj_white_herd_unlocked owner = { NOT = { has_country_flag = ghavaanaj_white_herd_unlocked_flag } } }
		remove_province_modifier = ghavaanaj_white_herd_unlocked
		add_permanent_province_modifier = { name = ghavaanaj_white_herd_locked duration = -1 }
	}
	if = {
		limit = { has_province_modifier = ghavaanaj_red_herd_unlocked owner = { NOT = { has_country_flag = ghavaanaj_red_herd_unlocked_flag } } }
		remove_province_modifier = ghavaanaj_red_herd_unlocked
		add_permanent_province_modifier = { name = ghavaanaj_red_herd_locked duration = -1 }
	}
	if = {
		limit = { has_province_modifier = ghavaanaj_purple_herd_unlocked owner = { NOT = { has_country_flag = ghavaanaj_purple_herd_unlocked_flag } } }
		remove_province_modifier = ghavaanaj_purple_herd_unlocked
		add_permanent_province_modifier = { name = ghavaanaj_purple_herd_locked duration = -1 }
	}
	if = {
		limit = { has_province_modifier = ghavaanaj_black_herd_unlocked owner = { NOT = { has_country_flag = ghavaanaj_black_herd_unlocked_flag } } }
		remove_province_modifier = ghavaanaj_black_herd_unlocked
		add_permanent_province_modifier = { name = ghavaanaj_black_herd_locked duration = -1 }
	}
	if = {
		limit = { has_province_modifier = ghavaanaj_palace_herd_unlocked owner = { NOT = { has_country_flag = ghavaanaj_palace_herd_unlocked_flag } } }
		remove_province_modifier = ghavaanaj_palace_herd_unlocked
		add_permanent_province_modifier = { name = ghavaanaj_palace_herd_locked duration = -1 }
	}
	if = {
		limit = { has_province_modifier = ghavaanaj_castle_herd_unlocked owner = { NOT = { has_country_flag = ghavaanaj_castle_herd_unlocked_flag } } }
		remove_province_modifier = ghavaanaj_castle_herd_unlocked
		add_permanent_province_modifier = { name = ghavaanaj_castle_herd_locked duration = -1 }
	}
	if = {
		limit = { has_province_modifier = ghavaanaj_gray_herd_unlocked owner = { NOT = { has_country_flag = ghavaanaj_gray_herd_unlocked_flag } } }
		remove_province_modifier = ghavaanaj_gray_herd_unlocked
		add_permanent_province_modifier = { name = ghavaanaj_gray_herd_locked duration = -1 }
	}

	#Restore the herds if you lose but reconquer them
	if = {
		limit = { has_province_modifier = ghavaanaj_white_herd_locked owner = { has_country_flag = ghavaanaj_white_herd_unlocked_flag } }
		remove_province_modifier = ghavaanaj_white_herd_locked
		add_permanent_province_modifier = { name = ghavaanaj_white_herd_unlocked duration = -1 }
	}
	if = {
		limit = { has_province_modifier = ghavaanaj_red_herd_locked owner = { has_country_flag = ghavaanaj_red_herd_unlocked_flag } }
		remove_province_modifier = ghavaanaj_red_herd_locked
		add_permanent_province_modifier = { name = ghavaanaj_red_herd_unlocked duration = -1 }
	}
	if = {
		limit = { has_province_modifier = ghavaanaj_purple_herd_locked owner = { has_country_flag = ghavaanaj_purple_herd_unlocked_flag } }
		remove_province_modifier = ghavaanaj_purple_herd_locked
		add_permanent_province_modifier = { name = ghavaanaj_purple_herd_unlocked duration = -1 }
	}
	if = {
		limit = { has_province_modifier = ghavaanaj_black_herd_locked owner = { has_country_flag = ghavaanaj_black_herd_unlocked_flag } }
		remove_province_modifier = ghavaanaj_black_herd_locked
		add_permanent_province_modifier = { name = ghavaanaj_black_herd_unlocked duration = -1 }
	}
	if = {
		limit = { has_province_modifier = ghavaanaj_palace_herd_locked owner = { has_country_flag = ghavaanaj_palace_herd_unlocked_flag } }
		remove_province_modifier = ghavaanaj_palace_herd_locked
		add_permanent_province_modifier = { name = ghavaanaj_palace_herd_unlocked duration = -1 }
	}
	if = {
		limit = { has_province_modifier = ghavaanaj_castle_herd_locked owner = { has_country_flag = ghavaanaj_castle_herd_unlocked_flag } }
		remove_province_modifier = ghavaanaj_castle_herd_locked
		add_permanent_province_modifier = { name = ghavaanaj_castle_herd_unlocked duration = -1 }
	}
	if = {
		limit = { has_province_modifier = ghavaanaj_gray_herd_locked owner = { has_country_flag = ghavaanaj_gray_herd_unlocked_flag } }
		remove_province_modifier = ghavaanaj_gray_herd_locked
		add_permanent_province_modifier = { name = ghavaanaj_gray_herd_unlocked duration = -1 }
	}


	ghavaanaj_update_herd_size_provinces_on_province_owner_change = yes

	#Seinathil Sheetmusic Bonuses
	if = {
		limit = {
			NOT = { has_province_modifier = A90_sheet_music_1 }
			owner = { has_country_flag = seinathil_paper1 }
		}
		hidden_effect = {
			if = {
				limit = {
					trade_goods = paper
				}
				add_province_modifier = {
					name = A90_sheet_music_1
					duration = -1
					hidden = yes
				}
			}
		}
	}
	if = {
		limit = {
			NOT = { has_province_modifier = A90_sheet_music_2 }
			owner = { has_country_flag = seinathil_paper2 }
		}
		hidden_effect = {
			if = {
				limit = {
					trade_goods = paper
				}
				add_province_modifier = {
					name = A90_sheet_music_2
					duration = -1
					hidden = yes
				}
			}
		}
	}

	#Y98 - Y91 - Daxugo - Nuugdan - Remove in next update
	if = {
		limit = {
			owner = { mission_completed = Y98_silk_road }
			trade_goods = silk
		}
		add_province_modifier = {
			name = Y98_improved_silk_mod
			duration = -1
		}
	}

	# Removed degenerated Ruinborn from province and potentially infestation
	if = {
		limit = { culture = bloodfeeders }
		province_event = { id = infestation_bloodfeeder.2001 }
	}
	if = {
		limit = { culture = silent_watchers }
		province_event = { id = infestation_silent_watcher.2001 }
	}
	if = {
		limit = { culture = ice_sleepers }
		province_event = { id = infestation_ice_sleeper.2001 }
	}

	if = {
		limit = { owner = { is_subject_of_type = acolyte_dominion } }
		owner = {
			change_variable = { aInfluence = 2 }
			every_known_country = {
				limit = { is_subject_of_type = acolyte_dominion }
				ROOT = { remove_claim = PREV }
			}
		}
	}

	if = {
		limit = {
			region = akasik_region
			has_terrain = mountain
			religion = mother_akasik
			owner = { religion = mother_akasik }
			NOT = { has_province_flag = akasik_controlled }
		}
		REB = { change_variable = { akasik_mountains = 1 } }
		set_province_flag = akasik_controlled
		clr_province_flag = not_akasik_controlled
		every_country = {
			limit = { religion = mother_akasik }
			country_event = { id = mother_akasik.3 }
		}
	}
	if = {
		limit = {
			region = akasik_region
			has_terrain = mountain
			NOT = { owner = { religion = mother_akasik } }
			NOT = { has_province_flag = not_akasik_controlled }
		}
		REB = { subtract_variable = { akasik_mountains = 1 } }
		set_province_flag = not_akasik_controlled
		clr_province_flag = akasik_controlled
		every_country = {
			limit = { religion = mother_akasik }
			country_event = { id = mother_akasik.3 }
		}
	}

	if = {
		limit = {
			province_id = 912
			has_province_modifier = incomplete_hold
			NOT = { owned_by = A73 }
		}
		remove_province_modifier = incomplete_hold
		add_permanent_province_modifier = {
			name = incomplete_hold_0
			duration = -1
		}
	}

	if = {
		limit = {
			province_id = 234
			has_province_modifier = clstc_colonial_port
		}
		if = {
			limit = {
				owner = {
					OR = {
						is_part_of_hre = yes
						tag = Z01
					}
				}
			}
			owner = {
				country_event = {
					id = hre_event.100
				}
			}
		}
		else = {
			owner = {
				country_event = {
					id = hre_event.101
				}
			}
		}
	}

	if = {
		limit = {
			province_id = 912
			has_province_modifier = incomplete_hold_0
			owned_by = A73
		}
		remove_province_modifier = incomplete_hold_0
		add_permanent_province_modifier = {
			name = incomplete_hold
			duration = -1
		}
	}

	if = {
		limit = { owner = { has_reform = roadwarrior_great_convoy } }
		province_event = { id = roadwarrior.6 days = 3 } #Roadwarrior looting stuff
	}

	#reapply dungeon flags
	if = {
		limit = { has_dwarovar_dungeon = yes }
		dungeon_ownership_reset_effect = yes
	}

	#dwarovar expeditions
	if = {
		limit = {
			OR = {
				has_province_modifier = expedition_target
				has_dwarovar_dungeon = yes
			}
		}
		generate_expedition = { base_floor = 1 base_danger = 1 }
		expedition_dead_effect = yes
		FROM = { clr_country_flag = expedition_happening }
		clr_province_flag = sent_expedition_@FROM
		clr_province_flag = generated_party_stats_@FROM
		if = { #re-add country flag to new owner if they already have an expedition elsewhere
			limit = {
				owner = { any_owned_province = { has_province_flag = sent_expedition_@owner } }
			}
			owner = { set_country_flag = expedition_happening }
		}
		if = { #re-add country flag to old owner if necessary
			limit = {
				FROM = { any_owned_province = { has_province_flag = sent_expedition_@owner } }
			}
			FROM = { set_country_flag = expedition_happening }
		}
		#reapply gems
		respawn_dwarovkron_fragments = yes
	}

	#hold migration digging/repairing exploits
	if = {
		limit = {
			province_group = hold_province
			is_city = no
		}
		if = {
			limit = { has_advanced_hold_infrastructure = yes }
			set_province_flag = specialized_hold
		}
		if = {
			limit = {
				FROM = {
					capital_scope = {
						OR = {
							has_construction = digging_deeper
							has_construction = restoring_hold
						}
					}
					NOT = { num_of_cities = 2 } #abandoned colony
				}
			}
			FROM = {
				capital_scope = { cancel_construction = yes }
				if = {
					limit = { has_country_flag = is_digging }
					FROM = { clr_hold_digging_modifiers = yes }
				}
			}
		}
	}
	#performance fix for clearing/restoring potential
    if = {
        limit = { province_group = hold_province }
        owner = { set_country_flag = owns_hold_province }
		FROM = { country_event = { id = diggy.111 } }
    }
	#seghdihr military modifiers
	if = {
		limit = {
			owned_by = H78
			H78 = { has_reform = seghdihr_segbandalic_military }
		}
		if = {
			limit = { province_group = segbandal_hold_province }
			add_province_modifier = { name = seghdihr_reform_holds duration = -1 hidden = yes }
		}
		else_if = {
			limit = {
				OR = {
					has_terrain = dwarven_road
					province_group = hold_province
				}
			}
			add_province_modifier = { name = seghdihr_reform_secondary duration = -1 hidden = yes }
		}
		else = { add_province_modifier = { name = seghdihr_reform_other duration = -1 hidden = yes } }
	}

	#azjakuma events
	if  = {
		limit = {
			OR = {
				owned_by = Y01
				FROM = { tag = Y01 }
				owner = {
					is_subject_of = Y01
					NOT = { is_subject_of_type = tributary_state_anb }
				}
			}
		}
		province_event = {
			id = flavor_azjakuma.2500
		}
	}
	if = {
		limit = {
			owner = {
				tag = Y01
				ai = no
				any_owned_province = {
					culture = goldscale_kobold
					base_production = 2
				}
			}
		}
		owner = { country_event = { id = flavor_azjakuma.2801 days = 5 } }
	}

	#Dhenijanrai events
	if = {
		limit = {
			province_id = 4265 # Grozumdihr
			owner = { mission_completed = R51_peridot_king }
			NOT = { exists = I18 }
		}
		owner = { country_event = { id = flavor_dhenijanraj.300 } }
	}

	#Mandate mothers sorrow counter
	if = {
		limit = { province_group = mothers_sorrow_group }
		update_sorrow_province_modifiers = yes
		owner = { update_sorrow_province_count = yes }
		FROM = { update_sorrow_province_count = yes }
	}

	#Ynn
	owner = { country_event = { id = ynn_events.2 } }
	FROM = { country_event = { id = ynn_events.2 } }
	province_event = { id = ynn_events.23 }	#Pomentere Estates modifier

	#Drozma Tur
	if = {
		limit = {
			owner = {
				religion = drozma_tur
				has_church_aspect = community_triumph_aspect_adm
			}
			nationalism = 1
		}
		add_province_modifier = {
			name = dt_rebels_to_the_banner
			duration = -1
		}
	}

	if = {
		limit = {
			owner = {
				religion = drozma_tur
				has_church_aspect = community_recognition_aspect_adm
			}
			NOT = {
				has_owner_culture = yes
				has_owner_accepted_culture = yes
			}
		}
		add_province_modifier = {
			name = dt_recognised_nationalism
			duration = -1
		}
	}

	
	if = {
		limit = {
			owner = { has_reform = bloodgroves_law }
			has_terrain = bloodgroves
		}
		add_province_modifier = {
			name = bloodgroves_law_modifier
			duration = -1
		}
	}
	
	#Amacimst Prov Modifiers
	if = {
		limit = {
			FROM = {
				OR = {
					has_country_flag = G26_lordly_oversight_flag
					overlord = {
						has_country_flag = G26_lordly_oversight_flag
					}
				}
			}
			has_province_modifier = G26_lordly_oversight
		}
		remove_province_modifier = G26_lordly_oversight
	}
	else_if = {
		limit = {
			owner = {
				OR = {
					has_country_flag = G26_lordly_oversight_flag
					overlord = {
						has_country_flag = G26_lordly_oversight_flag
					}
				}
			}
			OR = {
				culture = sarda
				culture = dolindhan
			}
		}
		add_province_modifier = {
			name = G26_lordly_oversight
			duration = -1
		}
	}
	else_if = {
		limit = {
			FROM = {
				OR = {
					has_country_flag = G26_traditional_ynnic_values_flag
					overlord = {
						has_country_flag = G26_traditional_ynnic_values_flag
					}
				}
			}
			has_province_modifier = G26_traditional_ynnic_values
		}
		remove_province_modifier = G26_traditional_ynnic_values
	}
	else_if = {
		limit = {
			owner = {
				OR = {
					has_country_flag = G26_traditional_ynnic_values_flag
					overlord = {
						has_country_flag = G26_traditional_ynnic_values_flag
					}
				}
			}
			OR = {
				culture = sarda
				culture = dolindhan
			}
		}
		add_province_modifier = {
			name = G26_traditional_ynnic_values
			duration = -1
		}
	}

	g27_breluslad_integration_effect = yes	#Breluslad integrating provinces stuff
	g27_iron_mines_effect = yes #Brelari Iron mines stronk

	#reduced dev cost in capital state, adds modifier when gaining provinces in capital state
	if = {
		limit = {
			owner = { has_government_attribute = lower_dev_cost_in_capital_state }
			area_for_scope_province = {
				has_province_modifier = lower_dev_cost_in_capital_state_modifier
			}
			NOT = { has_province_modifier = lower_dev_cost_in_capital_state_modifier }
		}
		add_province_modifier = {
			name = lower_dev_cost_in_capital_state_modifier
			duration = -1
			hidden = yes
		}
	}

	#Reduced dev cost in the capital area of Sri Baginda
	if = {
		limit = {
			owner = { is_sri_baginda = yes }
			area_for_scope_province = {
				has_province_modifier = sri_baginda_lower_dev_cost_capital_mod
			}
			NOT = { has_province_modifier = sri_baginda_lower_dev_cost_capital_mod }
		}
		add_province_modifier = {
			name = sri_baginda_lower_dev_cost_capital_mod
			duration = -1
			hidden = yes
		}
	}

	#reduced gov cost in capital region, adds modifier when gaining provinces in capital region
	if = {
		limit = {
			owner = { has_government_attribute = lower_gov_cost_in_home_region }
			region_for_scope_province = {
				has_province_modifier = lower_gov_cost_in_home_region_modifier
			}
			NOT = { has_province_modifier = lower_gov_cost_in_home_region_modifier }
		}
		add_province_modifier = {
			name = lower_gov_cost_in_home_region_modifier
			duration = -1
			hidden = yes
		}
	}

	#Orlghelovar (I12)
	if = {
		limit = {
			trade_goods = glass
			owner = { tag = I12 }
		}
		if = {
			limit = {
				owner = {
					OR = {
						has_reform = orlghelovar_glasslords
						has_reform = orlghelovar_science
					}
				}
				NOT = { has_province_modifier = orlghelovar_glasslord_glass }
			}
			add_province_modifier = { name = orlghelovar_glasslord_glass duration = -1 hidden = yes }
		}
		if = {
			limit = {
				owner = { has_reform = orlghelovar_glass_worker_reform }
				NOT = { has_province_modifier = orlghelovar_reformed_glassworkers }
			}
			add_province_modifier = { name = orlghelovar_reformed_glassworkers duration = -1 hidden = yes }
		}
		if = {
			limit = {
				owner = { has_country_modifier = orlghelovar_sapphire_glass }
				NOT = { has_province_modifier = orlghelovar_glass_value }
			}
			add_province_modifier = { name = orlghelovar_glass_value duration = -1 hidden = yes }
		}
	}

	if = {
		limit = {
			culture = no_culture
		}
		change_culture = owner
	}
	if = {
		limit = {
			religion = no_religion
		}
		change_religion = owner
	}
	#Add Grain to Grain Lords
	if = {
        limit = {
            NOT = { has_province_modifier = barumand_lord_grain }
                owner = { has_reform = barumand_grain_lords_reform }
        }
        hidden_effect = {
            if = {
                limit = {
                    trade_goods = grain
                }
                add_province_modifier = {
                    name = barumand_lord_grain
                    duration = -1
                    hidden = yes
                }
            }
        }
    }
	#Newshire
	if = {
		limit = {
			OR = {
				trade_goods = grain
				trade_goods = livestock
			}
			owner = { 
				OR = {
					has_reform = newshire_stewardship
					has_reform = newshire_high_stewardship
				}
			}
		}
		add_province_modifier = {
			name = newshire_stewardship_boost
			duration = -1
			hidden = yes
		}
	}

	#Bianfang Harpy vassal Stuff
	if = {
		limit = {
			province_id = 4826
			NOT = {
				owned_by = Y09
			}
			R83 = { is_subject_of = Y09 }
		}
		Y09 = { 
			country_event = {
				id = bianfang.311
			}
		}
		R83 = {
			country_event = {
				id = bianfang.312
			}
		}
	}

	#AI EWoC cores
	if = {
		limit = { province_group = escann_proper }
		owner = {
			country_event = { id = escanni_wars.4 }
		}
	}
	#broken masquerade vampires t3 tier down
	if = {
		limit = {
			has_province_modifier = aw_vampires_3
		}
		spawn_rebels = {
			type = vampires_nobles
			size = 1
		}
		
		remove_province_modifier = aw_vampires_3
		add_permanent_province_modifier  = {
			name = aw_vampires_2
			duration = -1  
		}

		province_event = { id = disaster_vampire_masquerade.99 days = 7 }
	}

	#zyujyut culture flip after 10 years tracker
	if = {
		limit = {
			province_group = zyujyut_bokai_provinces
		}
		
		if = {
			limit = { owner = { culture_group = yan } }
			set_province_flag = zyujyut_integrating_bokai_flag
		}
		else = {
			clr_province_flag = zyujyut_integrating_bokai_flag	
		}
	}

	#Haraf finished integration event 
	if = {
		limit = {
			owner = {
				ai = no
				tag = G43
				NOT = {
				    haraf_region = {
				        culture = harafe
				        NOT = { country_or_non_sovereign_subject_holds = PREV }
				    }
				}
			}
		}
		owner = {
			country_event = {
				id = haraf_events.6
			}
		}
	}

	#Urdea Samrad Haraf colony
	if= {
		limit = {
			has_global_flag = urdea_samrad_released
			colonial_region = colonial_haraf
			is_city = yes
			owner = { overlord_of = U42 }
			U42 = { is_subject_of_type = colony }
		}
		cede_province = U42
	}

	# Allclan
	if = {
		limit = {
			owner = {
				tag = I98
				mission_completed = I98_involuntary_revenue_service
			}
			has_tax_building_trigger = yes
		}
		if = {
			limit = {
				NOT = { mission_completed = I98_IRS_ceasefire }
			}
			remove_province_modifier = I98_IRS_activities
			add_province_modifier = {
				name = I98_IRS_activities_improved
				duration = -1
			}
		}
		else = {
			add_province_modifier = {
				name = I98_IRS_activities
				duration = -1
			}
		}
	}
	if = {
		limit = {
			owner = { NOT = { tag = I98 } }
			OR = {
				has_province_modifier = I98_IRS_activities
				has_province_modifier = I98_IRS_activities_improved
			}
		}
		remove_province_modifier = I98_IRS_activities
		remove_province_modifier = I98_IRS_activities_improved
	}
	if = {
		limit = {
			owner = {
				has_estate_privilege = estate_adventurers_allclan_bestiary_crawler
			}
			has_terrain = cavern
		}
		add_province_modifier = {
			name = I98_crawlers
			duration = -1
		}
	}
	if = {
		limit = {
			has_province_modifier = I98_crawlers
			owner = {
				NOT = {
					has_estate_privilege = estate_adventurers_allclan_bestiary_crawler
				}
			}
		}
	}
	
	#Effelai Worship holy sites event manager trigger
	if = {
		limit = {
			owner = {
				OR = {
					religion = chahinanito
					religion = tswohvwohii
					religion = senanset
				}
				NOT = {
					num_of_cities = 2
				}
				NOT = {
					check_variable = {
						which = effelai_holy_sites_visited
						value = 7
					}
				}
				if = {
					limit = {
						tag = G15
					}
					mission_completed = effelai_parura_cut_off_one_head
				}
			}
		}
		owner = {
			country_event = {
				id = effelai_worship.1
				days = 1
			}
			country_event = {
				id = effelai_worship.3
				days = 140
			}
			
		}
	}
	#Effelai Worship Tags Mechanics
	if = {
		limit = {
			owner = {
				OR = {
					tag = G17
					was_tag = G17
				}
			}
		}
		if = {
			limit = { # if its a sapling spot, is taken by G17, G17 is settled, then give them the event to rediscover their gardens
				has_province_modifier = effelai_effei_planted_saplings
				OR = {
					is_colony = yes 
					owner = {
						num_of_cities = 2
					}
				}
			}
			province_event = {
				id = effelai_worship.512
				days = 15
			}
		}
		if = { #if the effei migrate to a sapling spot, let them try to plant seeds
			limit = {
				has_province_modifier = effelai_effei_sapling_spot
				owner = {
					NOT = {
						num_of_cities = 2
					}
					check_variable = {
						which = effelai_effei_seeds
						value = 1
					}
				}
			}
			owner = {
				country_event = { #
					id = effelai_worship.510
					days = 15
				}
			}
		}
	}
	if = {#soruinic festival site manager
		limit = {
			owner = { 
				OR = {
					was_tag = G16
					tag = G16
				}
			}
		}
		if = {
			limit = { #if soruinics rediscover festival site after settling, upgrade the site
				has_province_modifier = effelai_soruinic_ancestral_veneration 
				OR = {
					is_colony = yes 
					owner = {
						num_of_cities = 2
					}
				}
			}
			province_event = {
				id = effelai_worship.523
				days = 10
			}
		}
		if = { #if soruinics visit a possible festival site for the first time before settling, hold a festival
			limit = {
				has_province_modifier = effelai_soruinic_festival_site
				owner = {
					NOT = {
						num_of_cities = 2
					}
				}
			}
			province_event = {
				id = effelai_worship.522
				days = 10
			}
		}
	}
	if = {#failsave for beast hunt if player dont go intended way
		limit = {
			owner = { 
				is_or_was_tag = { tag = G18 }
				religion = tswohvwohii
			}
		}
		if = {
			limit = {
				OR = {
					province_id = 2219
					province_id = 2265
					province_id = 2225
					province_id = 2211
				}
			}
			owner = {
				country_event = {
					id = effelai_worship.533 #leechden
					days = 1
				}
			}
		}
		if = {
			limit = {
				OR = {
					province_id = 2344
					province_id = 2338
					province_id = 2294
					province_id = 2225
				}
			}
			owner = {
				country_event = {
					id = effelai_worship.534 #East 
					days = 1
				}	
			}
		}
		if = {
			limit = {
					province_id = 2211
				}
			owner = {
				country_event = {
					id = effelai_worship.532 # West
					days = 1
				}
			}
		}
	}
	#Effelai Settlers Culture And Religion Fix
	if = {
		limit = {
			owner = {
				has_reform = settlers_of_effelai
			}
			NOT = {
				FROM = {
					num_of_owned_provinces_with = {
						value = 1
						is_city = yes
					}
				}
			}
		}
		change_culture = owner
		change_religion = owner
	}
	#Mulen (F50)
	if = {
		limit = {
			owner = {
				OR = {
					was_tag = F50
					tag = F50
				}
			}
			OR = {
				trade_goods = gems
				trade_goods = ivory
				trade_goods = copper
				trade_goods = wool
			}
		}
		if = {
			limit = {
				owner = { mission_completed = mulen_jewelry_industry }
				NOT = { has_province_modifier = mulen_jewelry_line }
			}
			add_province_modifier = { name = mulen_jewelry_line duration = -1 }
		}
	}

	#Halflings nakavy_avo shrines
	if = {
		limit = { #Should there be a shrine there?
			OR = {
				province_group = shrine_provinces
				continent = africa
			}
			has_any_nakavy_avo_shrine_in_province_trigger = yes
		}

		if = { #While the active modifiers are here:
			limit = {
				FROM = { religion = nakavy_avo } #Check the country is nakavy_avo
				has_any_active_nakavy_avo_shrine_in_province_trigger = yes #and lost an active shrine
			}
			FROM = { country_event = { id = fahvanosy.11 } } #Check if FROM owns a valid shrine before removing the ruler mod
		}
		nakavy_avo_shrines_deactivate_all_province_effect = yes #deactivate all because only 1/12 chance to keep even if avo nakavy
		
		if = {
			limit = { owner = { has_reform = shrine_guardians_reform } }
			add_province_modifier = { name = shrine_guard_garisson duration = -1 }
		}

		if = {
			limit = { owner = { religion = nakavy_avo } }
			if = {
				limit = {
					has_province_modifier = lel_shrine_province
					owner = { has_personal_deity = lel }
				}
				owner = { add_ruler_modifier = { name = lel_shrine } }
				nakavy_avo_shrines_activate_specific_deity_province_effect = { deity = lel }
			}
			else_if = {
				limit = {
					has_province_modifier = kolo_shrine_province
					owner = { has_personal_deity = kolo }
				}
				owner = { add_ruler_modifier = { name = kolo_shrine } }
				nakavy_avo_shrines_activate_specific_deity_province_effect = { deity = kolo }
			}
			else_if = {
				limit = {
					has_province_modifier = the_nakazy_shrine_province
					owner = { has_personal_deity = the_nakazy }
				}
				owner = { add_ruler_modifier = { name = the_nakazy_shrine } }
				nakavy_avo_shrines_activate_specific_deity_province_effect = { deity = the_nakazy }
			}
			else_if = {
				limit = {
					has_province_modifier = turozi_shrine_province
					owner = { has_personal_deity = turozi }
				}
				owner = { add_ruler_modifier = { name = turozi_shrine } }
				nakavy_avo_shrines_activate_specific_deity_province_effect = { deity = turozi }
			}
			else_if = {
				limit = {
					has_province_modifier = yuye_shrine_province
					owner = { has_personal_deity = yuye }
				}
				owner = { add_ruler_modifier = { name = yuye_shrine } }
				nakavy_avo_shrines_activate_specific_deity_province_effect = { deity = yuye }
			}
			else_if = {
				limit = {
					has_province_modifier = ozamdi_shrine_province
					owner = { has_personal_deity = ozamdi }
				}
				owner = { add_ruler_modifier = { name = ozamdi_shrine } }
				nakavy_avo_shrines_activate_specific_deity_province_effect = { deity = ozamdi }
			}
			else_if = {
				limit = {
					has_province_modifier = jyva_shrine_province
					owner = { has_personal_deity = jyva }
				}
				owner = { add_ruler_modifier = { name = jyva_shrine } }
				nakavy_avo_shrines_activate_specific_deity_province_effect = { deity = jyva }
			}
			else_if = {
				limit = {
					has_province_modifier = ytrai_shrine_province
					owner = { has_personal_deity = ytrai }
				}
				owner = { add_ruler_modifier = { name = ytrai_shrine } }
				nakavy_avo_shrines_activate_specific_deity_province_effect = { deity = ytrai }
			}
			else_if = {
				limit = {
					has_province_modifier = drongray_shrine_province
					owner = { has_personal_deity = drongray }
				}
				owner = { add_ruler_modifier = { name = drongray_shrine } }
				nakavy_avo_shrines_activate_specific_deity_province_effect = { deity = drongray }
			}
			else_if = {
				limit = {
					has_province_modifier = elinao_shrine_province
					owner = { has_personal_deity = elinao }
				}
				owner = { add_ruler_modifier = { name = elinao_shrine } }
				nakavy_avo_shrines_activate_specific_deity_province_effect = { deity = elinao }
			}
			else_if = {
				limit = {
					has_province_modifier = begga2_shrine_province
					owner = { has_personal_deity = begga2 }
				}
				owner = { add_ruler_modifier = { name = begga2_shrine } }
				nakavy_avo_shrines_activate_specific_deity_province_effect = { deity = begga2 }
			}
			else_if = {
				limit = {
					has_province_modifier = nakinta_shrine_province
					owner = { has_personal_deity = nakinta }
				}
				owner = { add_ruler_modifier = { name = nakinta_shrine } }
				nakavy_avo_shrines_activate_specific_deity_province_effect = { deity = nakinta }
			}
		}
	}
	
	# Aelantir culture conversion event
	province_event = { id = marcher.5 }
	
	#Powerful clanbosses goblin reform
	if = {
		limit = {
			owner = { has_reform = powerful_clan_bosses }
			province_is_or_accepts_culture = no
			NOT = { has_province_modifier = weak_clan_bosses }
		}
		add_province_modifier = {
			name = weak_clan_bosses
			duration = -1
		}
	}
	#Ranger Lordship
	if = {
		limit = {
			owner = { has_reform = ranger_lordship }
				NOT = { has_province_modifier = ranger_lordship_modifier }
				OR = {
					has_terrain = forest
					has_terrain = woods
				}
		}
		add_province_modifier = {
			name = ranger_lordship_modifier
			duration = -1
		}
	}
	if = {
		limit = {
			NOT = { 
				owner = { 
					has_reform = ranger_lordship 
				} 
			}
			has_province_modifier = ranger_lordship_modifier
		}
		remove_province_modifier = ranger_lordship_modifier
	}
	#i
	#isobelin - add control modifier to coast of isobel if it is reconquered after being lost

	if = {
		limit = {
			owner = {
				tag = G91
				mission_completed = isobelin_mission_the_ladys_landing		
			}
			area = coast_of_isobel_area
		}
		add_province_modifier = {
			name = isobelin_modifier_complete_control
			duration = -1
		}
	}
	if = {
		limit = {
			owner = {
				has_reform = vermillion_throne_reform
			}
			province_id = 4951
		}
		add_province_modifier = {
			name = vermillion_throne_lamwun_ownership
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			province_group = dwarovrod_group
			owner = { has_country_flag = I98_gobgorod }
		}
		I98_rename_gobgorod = yes
	}	
	
	#cardesti system monstrous annex
	if = {
		limit = {
			has_province_modifier = cardesti_minority_modifier
			owner = {
				OR = {
					has_country_modifier = monstrous_nation
					has_country_modifier = racial_pop_human_purge
					has_country_modifier = racial_pop_human_expulsion 
				}
			}
		}
		remove_province_modifier = cardesti_minority_modifier
		cardesti_remove_event_modifiers_scripted_effect = yes
		province_event = { id = cardesti_events.4 }
	}

	cleanup_empty_province = yes

	if = {
		limit = { 
			owner = {
				religion_group = bulwari
			}
			NOT = { superregion = bulwar_superregion } 
			religion = xhazobkult
		}
		set_province_flag = bulwar_evil_religion_xhazobkult
	}
	if = {
		limit = { 
			owner = {
				religion_group = bulwari
			}
			NOT = { superregion = bulwar_superregion } 
			OR = { 
				religion = tswohvwohii
				religion = chahinanito
				religion = song_servants
				religion = leechfather
			}
		}
		set_province_flag = bulwar_evil_religion_effelai
	}
	if = {
		limit = { 
			owner = {
				religion_group = bulwari
			}
			NOT = { superregion = bulwar_superregion } 
			religion = devouring_path
		}
		set_province_flag = bulwar_evil_religion_devouring_path
	}

	# Mountainshark T4 Gov Reform
	if = {
		limit = {
			owner = { has_reform = mountainshark_avatars_of_the_great_shark }
			development = 10
		}
		add_province_modifier = {
			name = H84_avatars_of_the_great_shark
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = {
			NOT = { owner = { has_reform = mountainshark_avatars_of_the_great_shark } }
			has_province_modifier = H84_avatars_of_the_great_shark
		}
		remove_province_modifier = H84_avatars_of_the_great_shark
	}

	#centaur NZOC
	if = {
		limit = {
			owner = {
				has_government_attribute = centaur_nomadism_attribute
			}
		}
		owner = { save_event_target_as = conquering_centaur }
		if = {
			limit = {
				OR = {
					#if 1 province that is either in the area or adjacent to the province that you just conquered is the nomadic capital of the conquering country, add the conquered buff.
					calc_true_if = {
						amount = 1
						all_province_in_state = {
								owned_by = event_target:conquering_centaur
								has_province_flag = is_nomadic_capital
						}
					}
					calc_true_if = {
						amount = 1
						all_neighbor_province = {
							owned_by = event_target:conquering_centaur
							has_province_flag = is_nomadic_capital
						}
					}
				}	
			}
			add_province_modifier = {
				name = base_nomadic_zone_of_control
				duration = 1825
			}
			FROM = {
				area = {
					limit = {
						NOT = {
							owned_by = event_target:conquering_centaur
						}
					}
					owner = { apply_debuff_NZOC_country_scope = yes }
				}
				every_neighbor_province = { #add modifiers and claims to all unowned neighbor provinces
					limit = {
						NOT = { country_or_non_sovereign_subject_holds = event_target:conquering_centaur }
					}
					owner = { apply_debuff_NZOC_country_scope = yes }
				}
			}
		}
	}
	#Centaur bonus wool production
	if = {
		limit = {
			has_province_modifier = centaur_wool_bonus_prod
			NOT = { owner = { has_country_flag = centaur_wool_bonus } }
		}
		remove_province_modifier = centaur_wool_bonus_prod
	}
	if = {
		limit = { 
			owner = { has_country_flag = centaur_wool_bonus } 
			trade_goods = wool
		}
		add_province_modifier = { 
			name = centaur_wool_bonus_prod
			duration = -1
			hidden = yes
		}
	}
	#High Temple decision performance
    if = {
        limit = { province_group = temple_province_group }
        owner = { set_country_flag = owns_high_temple }
		if = {
			limit = {
				has_province_flag = temple_being_plundered
			}
			owner = { country_event = { id = spirits.010 } }
		}
		FROM = { country_event = { id = spirits.020 days = 1 } } #Evaluate the flag for the other person
		if = {
			limit = {
				has_province_modifier = corrupted_temple_complex_inactive
				religion = devouring_path
				owner = { religion = devouring_path }
			}
			remove_province_modifier = corrupted_temple_complex_inactive
			add_permanent_province_modifier = { name = corrupted_temple_complex duration = -1 }
		}
		else_if = {
			limit = {
				has_province_modifier = corrupted_temple_complex
				NOT = {
					AND = {
						religion = devouring_path
						owner = { religion = devouring_path }
					}
				}
			}
			remove_province_modifier = corrupted_temple_complex
			add_permanent_province_modifier = { name = corrupted_temple_complex_inactive duration = -1 }
		}
    }

	if = {
		limit = {
			owner = { tag = H61 has_country_flag = H61_moonlit_river_flag }
			OR = {
				religion = ynn_river_worship
				religion = ynn_river_reformed
			}
			owner = { NOT = { mission_completed = H61_convincing_the_unconvinced } }
		}
		owner = {
			every_owned_province = {
				limit = {
					OR = {
						religion = ynn_river_worship
						religion = ynn_river_reformed
					}
					NOT = { has_province_modifier = H61_moonlit_river_agreement }
					NOT = { has_province_flag = H61_moonlit_river_agreement_done }
				}
				add_province_modifier = {
					name = H61_moonlit_river_agreement
					duration = 36500 #100 years
				}
				set_province_flag = H61_moonlit_river_agreement_done
			}
		}
	}

	#Deyeion change variable to add years to modifier
	if = {
		limit = { 
			is_city = yes
			owner = { 
				NOT = { is_core = PREV }
				has_country_modifier = G56_independence_movement_post_mt 
			} 
		}
		owner = {
			change_variable = {
				which = G56_independence_movement_variable_temp
				value = 1
			}
			country_event = {
				id = deyeion_events.99 #Update modifier
				days = 1
			}
		}
	}
	
	province_event = { id = amadia.2 } #Amadian Damestear

	#ANBENNAR - Remove Allclan Befuddling flag if the province is conquered
	if = {
		limit = {
			province_group = hold_province
			owner = { NOT = { tag = I98 } }
			has_province_flag = I98_befuddling_hold_flag
		}
		clr_province_flag = I98_befuddling_hold_flag
	}

	#Command
	if = { #Command feeding land to Azjakuma
		limit = {
			owner = {
				tag = Y01
				is_subject_of_type_with_overlord = {
					who = R62
					type = slave_state
				}
			}
			NOT = { region = demon_hills_region }
		}
		R62 = { country_event = { id = the_command.102 days = 1 } }
	}
	if = {
		limit = { owner = { tag = R62 } }
		if = { #Command Post-Edict-of-X Laws of Ninun
			limit = {
				has_global_flag = R62_the_edict_of_x_flag
				command_not_yet_wuhyunized = yes
			}
			add_province_modifier = {
				name = command_not_yet_wuhyunized_mod
				duration = -1
			}
		}
		if = {
			limit = { province_id = 4941 }
			province_event = { id = the_command.201 }
		}
		if = { #AI Command gives dwarovar to Jade March
			limit = {
				superregion = east_serpentspine_superregion
				R62 = { ai = yes }
				R81 = { is_subject_of = R62 }
			}
			owner = { country_event = { id = the_command.3004 days = 1 } }
		}
		if = {
			limit = { fast_has_pop_of_race = { race = hobgoblin } region = jade_mines_region owner = { mission_completed = R62_moving_camp } }
			add_province_triggered_modifier = command_migration_randomness_ptm
		}
		if = {
			limit = { province_group = temple_province_group owner = { has_country_flag = command_oni_temple_stewardship_flag } }
			generic_add_race_minority_size_effect = { race = ogre }
		}
	}
	if = { #Command Pre-Edict-of-X Laws of Ninun
		limit = { has_state_edict = laws_of_ninun_edict }
		province_event = { id = the_command.34 days = 219 random = 438 }
	}
	clr_province_flag = ai_command_wuhyunize_this_province_flag #no AI stuff polluting save files
	clr_province_flag = ai_command_currently_wuhyunizing_this_province_flag
	if = {
		limit = { 
			OR = { 
				province_id = 2007
				province_id = 2092
				province_id = 2088
				province_id = 2062
			   }
			   NOT = { has_province_modifier = gathgob_lighthouse_modifier }
			owner = {
				any_owned_province = {
					has_great_project = {
						type = gathgob_lighthouse
						tier = 3
					}
				}
			}
		}
		add_permanent_province_modifier = {
			name = gathgob_lighthouse_modifier
			duration = -1
		}
	}
	if = {
		limit = {
			OR = {
				province_id = 2037
				province_id = 2825
			}
			NOT = { has_province_modifier = gathgob_lighthouse_modifier }
			owner = {
				any_owned_province = {
					has_great_project = {
						type = gathgob_lighthouse
						tier = 2
					}
				}
			}
		}
		add_permanent_province_modifier = {
			name = gathgob_lighthouse_modifier
			duration = -1
		}
	}

	#Ravelian
	if = {
		limit = {
			owner = { religion = ravelian }
			has_province_modifier = god_fragment_chamber
		}
		province_event = { id = ravelian.25 }
	}
	if = { #Making the societies go away if conquered by a tag that banned them, we must stop ravioli proliferation
		limit = {
			owner = { has_country_flag = denied_ravelian_society }
			has_province_modifier = ravelian_society
		}
		remove_province_modifier = ravelian_society
	}
	# Reduced gov cap in primary culture
	if = {
		limit = { owner = { has_government_attribute = reduced_gov_cost_in_primary_culture } }
		if = {
			limit = { has_owner_culture = yes }
			add_province_modifier = {
				name = cultural_colonies_mod
				duration = -1
			}
		}
		else = {
			if = {
				limit = { has_province_modifier = cultural_colonies_mod }
				remove_province_modifier = cultural_colonies_mod
			}
		}
	}
	if = {
		limit = { province_id = 4551 has_building = naval_battery owner = { mission_completed = R38_relock_the_gate } }
		add_province_modifier = { name = bhuvauri_gatehouse_of_rahen duration = -1 }
	}
	if = {
		limit = { has_building = soldier_households owner = { mission_completed = R38_raheni_regiments } }
		add_province_modifier = { name = bhuvauri_adasa_workforce duration = -1 }
	}
	if = { #Eordand stuff goes here
		limit = { owner = { tag = H21 } }
		if = {
			limit = { #Handing land to Salla tag
				superregion = deepwoods_superregion
				owner = { has_country_flag = eordand_deepwoods_ally }
			}
			owner = { country_event = { id = eordand.101 } }
		}
	}
	
	if = { #Cannorian holy site performance
		limit = { province_group = cannorian_holy_sites }
		FROM = { country_event = { id = regent_court.3 } }
		if = {
			limit = { is_empty = yes } #this is why the if statements can't be inside the scripted effects
			make_cannorian_holy_site_inactive = yes
		}
		else_if = {
			limit = { owner = { has_country_flag = owns_cannorian_holy_site } }
			if = {
				limit = { owner = { has_country_flag = can_use_cannorian_holy_site } }
				if = {
					limit = { NOT = { has_province_flag = active_cannorian_holy_site } }
					make_cannorian_holy_site_active = yes
				}
			}
			else_if = {
				limit = { has_province_flag = active_cannorian_holy_site }
				make_cannorian_holy_site_inactive = yes
			}
		}
		else = {
			owner = { set_country_flag = owns_cannorian_holy_site }
			if = {
				limit = { owner = { can_use_cannorian_holy_site_trigger = yes } }
				owner = { set_country_flag = can_use_cannorian_holy_site }
				if = {
					limit = { NOT = { has_province_flag = active_cannorian_holy_site } }
					make_cannorian_holy_site_active = yes
				}
			}
			else_if = {
				limit = { has_province_flag = active_cannorian_holy_site }
				make_cannorian_holy_site_inactive = yes
			}
		}
	}
	#simplified version of cannorian code above, unlikely than more than 1 such modifier will exist, if it does replace this code with one like above
	if = {
		limit = {
			province_id = 976
		}
		if = {
			limit = {
				is_empty = yes
			}
			remove_province_modifier = skaldol_temple
			add_permanent_province_modifier = {
				name = skaldol_temple_inactive
				duration = -1
			}
		}
		else_if = {
			limit = {
				owner = {
					religion = skaldhyrric_faith
				}
			}
			remove_province_modifier = skaldol_temple_inactive
			add_permanent_province_modifier = {
				name = skaldol_temple
				duration = -1
			}
		}
		else = {
			remove_province_modifier = skaldol_temple
			add_permanent_province_modifier = {
				name = skaldol_temple_inactive
				duration = -1
			}
		}
	}

	else_if = { #Flooded Province Performance
		limit = {
			OR = {
				has_province_modifier = flooded_province
				has_province_modifier = flooded_province_inactive
			}
		}
		if = {
			limit = { is_empty = yes }
			remove_province_modifier = flooded_province_inactive
			add_permanent_province_modifier = { name = flooded_province duration = -1 }
			set_province_flag = flooded_province #Re-applied because it gets removed on decolonization
		}
		else_if = {
			limit = {
				culture = mossmouth_ogre
				owner = { culture = mossmouth_ogre }
			}
			remove_province_modifier = flooded_province
			add_permanent_province_modifier = { name = flooded_province_inactive duration = -1 }
		}
		else = {
			remove_province_modifier = flooded_province_inactive
			add_permanent_province_modifier = { name = flooded_province duration = -1 }
		}
	}
	if = { #Giberd
		limit = {
			owner = {
				has_country_flag = giberd_gnomes_ae
			}
			fast_has_pop_of_race = { race = gnomish }
		}
		owner = { add_ae_for_known_countries_with_limit = { value = -5 apply_calc = no } }
	}
	
	if = { #Raheni holy sites
		limit = {
			province_group = raheni_school_origin_provinces
			owner = { religion = suhans_praxis }
		}
		add_province_modifier = { name = raheni_school_origin_suhans_praxis duration = -1 }
	}
	
	#Stalbor Stuff
	if = {
		limit = {
			owner = {
				has_country_flag = B47_vampire_lords_on_the_run
			}
			region = dostanor_region
		}
		random = {
			chance = 40
			spawn_rebels = {
				type = vampires_thralls
				size = 1
			}
		}
		add_province_modifier = {
			name = B47_old_lord_loyalists
			duration = -1
		}
	}
	#Strenghten Elven Privilleges reform
	if = { 
	    limit = { 
			religion = elven_forebears
			owner = { has_reform = strengthen_elves_privileges } 
		}
		add_province_modifier = {
			name = gov_moon_elven_religion_tolerance
			duration = -1
		} 
	}
	if = { 
	    limit = { 
			culture = moon_elf
			owner = { has_reform = strengthen_elves_privileges } 
		}
		add_province_modifier = {
			name = gov_moon_elf_tolerance
			duration = -1
		} 
	}
	#Ties with Anbennarian Nobility
	if = { 
	    limit = { 
			has_owner_religion = no
			is_anbennarian_imperial_culture = yes
			NOT = { has_province_modifier = gov_empire_heretic }
			owner = { has_reform = ties_with_anbennarian_nobility } 
		}
		add_province_modifier = {
			name = gov_empire_heretic
			duration = -1
		}
	}
	#Kherka Stuff
	if = {
		limit = {
			province_id = 2666
			owner = { has_country_flag = G48_hfaesban_conquer }
		}
		owner = {
			add_country_modifier = {
				name = G48_magic_and_steel
				duration = -1
			}
		}
	}
	#Kheionist
	if = {
		limit = { owner = { religion = kheionism } }
		owner = { country_event = { id = kheionism.5 } }
	}
	if = {
		limit = { FROM = { religion = kheionism } }
		FROM = { country_event = { id = kheionism.5 } }
	}

	#Rezankand
	if = {
		limit = {
			religion = oren_nayiru
			owner = { is_incident_active = incident_one_sun }
		}
		if = {
			limit = {
				owner = { has_country_flag = rezankand_supported_on }
			}
			add_province_modifier = {
				name = rezankand_supporting_oren_prov_mod
				duration = -1
			}
		}
		else_if = {
			limit = {
				owner = { has_country_flag = rezankand_stomping_on }
			}
			add_province_modifier = {
				name = rezankand_stomping_oren_prov_mod
				duration = -1
			}
		}
	}

	command_dewuhyunization_effect = yes

	#Khadisrapur
	if = {
		limit = { owned_by = R11 }
		if = {
			limit = { region = shamakhad_region }
			if = {
				limit = {
					has_province_flag = rajnadhaga_rightful_territory #Gambit to Unification
					R07 = {
						OR = {
							exists = no
							alliance_with = R11
						}
					}
				}
				owner = { country_event = { id = khadisrapur.17 } }
			}
			if = {
				limit = { owner = { has_estate_privilege = estate_uppercastes_khedarid_architecture } }
				trigger_switch = {
					on_trigger = has_terrain
					mountain = { add_province_modifier = { name = uppercastes_khedarid_architecture_mod_1 duration = -1 } }
					hills = { add_province_modifier = { name = uppercastes_khedarid_architecture_mod_2 duration = -1 } }
					highlands = { add_province_modifier = { name = uppercastes_khedarid_architecture_mod_2 duration = -1 } }
				}
			}
			else_if = {
				limit = { owner = { has_estate_privilege = estate_middlecastes_khedarid_architecture } }
				if = {
					limit = { has_terrain = desert }
					add_province_modifier = { name = middlecastes_khedarid_architecture_mod_2 duration = -1 }
				}
				else_if = {
					limit = { has_winter = mild_winter }
					add_province_modifier = { name = middlecastes_khedarid_architecture_mod_1 duration = -1 }
				}
				else_if = {
					limit = {
						OR = {
							has_terrain = farmlands
							has_terrain = grasslands
							has_terrain = drylands
							has_terrain = savannah
							has_terrain = steppe
							has_terrain = dwarven_road
						}
					}
					add_province_modifier = { name = middlecastes_khedarid_architecture_mod_3 duration = -1 }
				}
			}
			else_if = {
				limit = { owner = { has_estate_privilege = estate_lowercastes_khedarid_architecture } }
				if = {
					limit = { province_group = temple_province_group }
					add_province_modifier = { name = lowercastes_khedarid_architecture_mod_1 duration = -1 }
				}
				if = {
					limit = {
						OR = {
							development = 30
							has_terrain = city_terrain
						}
					}
					add_province_modifier = { name = lowercastes_khedarid_architecture_mod_2 duration = -1 }
				}
			}
		}
		if = {
			limit = {
				province_has_center_of_trade_of_level = 1
				has_estate_privilege = estate_adventurers_escort_missions
			}
			add_province_modifier = { name = trade_escort_missions_mod duration = -1 }
		}
	}
	#Ikogshaantus
	if = {
		limit = { owner = { is_or_was_tag = { tag = J52 } } } #Ikogshaantus
		if = {
			limit = { owner = { has_country_flag = J52_release_zabutodask_flag } }
			owner = { country_event = { id = ikogshaantus_events.7 } }
		}
		if = {
			limit = { 
				owner = { has_estate_privilege = estate_merchant_J52_nuzurbokh_argiculture_guild } 
				region = nuzurbokh_region
				J52_is_agriculture_province = yes
			}
			add_province_modifier = {
				name = J52_nuzurbokh_argiculture_guild_mod
				duration = -1
			}
		}
		if = {
			limit = {
				OR = {
					AND = {
						owner = { has_country_flag = J52_integrating_eagle_hobgoblins_flag }
						culture = eagle_command
					}
					AND = {
						owner = { has_country_flag = J52_integrating_soulseeker_ogres_flag }
						culture = soulseeker_ogre
					}
				}
			}
			add_province_modifier = {
				name = J52_integration_efforts
				duration = -1
			}
		}
	}

	#Rezankand
	if = {
		limit = {
			owner = { 
				tag = H67 
			}
			has_building = mage_tower
		}
		if = {
			limit = {
				owner = { 
					mission_completed = rezankand_architects_of_the_future 
					mission_completed = rezankand_faster_than_thought 
				}
			}
			add_province_modifier = {
				name = rezankand_light_matrix_upgraded
				duration = -1
			}
		}
		else_if = {
			limit = {
				owner = { 
					mission_completed = rezankand_architects_of_the_future 
				}
			}
			add_province_modifier = {
				name = rezankand_light_matrix
				duration = -1
			}
		}
	}

	if = {
		limit = {
			FROM = { 
				tag = H67
				OR = {
					has_estate_privilege = artifice_invention_light_matrix_supply
					has_estate_privilege = artifice_invention_light_matrix_logistic 
				}  
			} 
			has_building = mage_tower
		}
		every_neighbor_province = {
			limit = {
				owned_by = H67
				NOT = {
					any_neighbor_province = {
						owned_by = H67
						has_building = mage_tower
					}
				}
			}
			remove_province_modifier = rezankand_light_matrix_supply
			remove_province_modifier = rezankand_light_matrix_supply_upgraded
			remove_province_modifier = rezankand_light_matrix_logistic
			remove_province_modifier = rezankand_light_matrix_logistic_upgraded
		}
	}

	#Copperlords
	if = {
		limit = {
			owner = { has_reform = copperlord_reform }
			trade_goods = copper
		}
		add_province_modifier = { 
			name = copperlord_copper
			duration = -1
			hidden = yes
		}
	}

	#Xia stuff
	apply_appropriate_xia_mods_to_province = yes
	if = {
		limit = { has_province_flag = is_xia_origin }
		owner = {
			change_variable = { which = num_xia_origins_owned value = 1 }
			country_event = { id = one_xia.3002 }
		}
		FROM = {
			change_variable = { which = num_xia_origins_owned value = -1 }
			country_event = { id = one_xia.3002 }
		}
	}

	if = { #Merfolk - flag gets automatically removed when province is decolonized this readds it
		limit = {
			OR = {
				has_province_modifier = offcoast_merfolk_allied
				has_province_modifier = offcoast_merfolk_isolated
				has_province_modifier = offcoast_merfolk_neutral
			}
			NOT = { has_province_flag = merfolk_settlement }
		}
		set_province_flag = merfolk_settlement
	}
	if = {
		limit = { has_province_flag = merfolk_settlement }
		owner = {
			if = {
				limit = { NOT = { check_variable = { which = merfolkOpinionVar value = 1 } } }
				set_country_flag = merfolk_opinion_isolated
				set_variable = {
					which = merfolkOpinionVar
					value = 0
				}
			}
		}
		if = {
			limit = { has_province_modifier = offcoast_merfolk_allied }
			if = {
				limit = { owner = { NOT = { has_country_flag = offcoast_merfolk_allied } } }
				remove_province_modifier = offcoast_merfolk_allied
				merfolk_spawn_modifier = yes
			}
		}
		else_if = {
			limit = { has_province_modifier = offcoast_merfolk_neutral }
			if = {
				limit = { owner = { NOT = { has_country_flag = offcoast_merfolk_neutral } } }
				remove_province_modifier = offcoast_merfolk_neutral
				merfolk_spawn_modifier = yes
			}
		}
		else_if = {
			limit = { has_province_modifier = offcoast_merfolk_isolated }
			if = {
				limit = { owner = { NOT = { has_country_flag = offcoast_merfolk_isolated } } }
				remove_province_modifier = offcoast_merfolk_isolated
				merfolk_spawn_modifier = yes
			}
		}
	}

	#Eltikanized Taychendi
	if = {
		limit = {
			owner = {
				culture_group = eltibhari_ruinborn_elf
			}
			culture = macamairghe
		}
		add_province_modifier = { name = eltikan_macamairghe duration = -1 hidden = yes }
	}

	# Zokka
	if = {
		limit = { trade_goods = slaves owner = { has_government_attribute = enables_corrivalry } }
		add_province_modifier = {
			name = zokka_ekxiem_zokka_boost
			duration = -1
			hidden = yes
		}
	}
	if = {
		limit = { fast_has_pop_of_race = { race = human } }
		if = {
			limit = { owner = { has_reform = zokka_hand_feeds } }
			if = {
				limit = { has_small_human_minority_trigger = yes }
				add_province_modifier = {
					name = zokka_hand_feeds_boost
					duration = -1
					hidden = yes
				}
			}
			else = {
				add_province_modifier = {
					name = zokka_hand_feeds_better_boost
					duration = -1
					hidden = yes
				}
			}
		}
		else_if = {
			limit = { owner = { has_reform = zokka_hand_feeds2 } }
			if = {
				limit = { has_small_human_minority_trigger = yes }
				add_province_modifier = {
					name = zokka_hand_feeds_boost2
					duration = -1
					hidden = yes
				}
			}
			else = {
				add_province_modifier = {
					name = zokka_hand_feeds_better_boost2
					duration = -1
					hidden = yes
				}
			}
		}
	}
	
	if = {
		limit = { #Events on temples converted to JAD
			religion = the_jadd
			owner = {
				religion = the_jadd
			}
			OR = {
				province_id = 643 #Azka Sur
				province_id = 631 #Eduz Vacyn
				province_id = 601 #Bulwar
			}
		}
		owner = {
			country_event = {
				id = bulwar_flavour.145
			}
			country_event = {
				id = bulwar_flavour.146
			}
			country_event = {
				id = bulwar_flavour.147
			}
		}
	} 
	
	#Telgeir Big Iron 
	if = {
		limit = {
			owner = { has_reform = steel_monarchy_reform }
		}
		if = {
			limit = {
				OR = {
					trade_goods = iron
					trade_goods = copper
					trade_goods = mithril
					trade_goods = coal
				}
			}
			add_province_modifier = {
				name = gov_vg_efficiency
				duration = -1
			}
		}
	}
	if = {
		limit = {
			owner = {
				is_subject_of_type = space_colony
			}
			S81 = { NOT = { has_disaster = the_hivemind } }
			NOT = {
				province_id = 5921
				province_id = 5763
				province_id = 5863
				province_id = 5585
				province_id = 5971
				province_id = 6032
				province_id = 6685
				province_id = 5650
			}
		}
		cede_province = S81
	}
	#Salla Ayeth
	if = {
		limit = {
			owner = { tag = I33 }
			has_province_modifier = I33_constant_harassment
		}
		I33 = { add_army_tradition = 1 }
		remove_province_modifier = I33_constant_harassment
	}
	
	#Pashaine
	if = {
		limit = {
			culture = vernman
			owner = { has_country_flag = pashaine_vernmen_succesors }
		}
		add_province_modifier = {
			name = pashaine_successors_of_vernmen_mod
			duration = -1
		}
	}
	#Tiboktsamo
	if = {
		limit = { owner = { is_or_was_tag = { tag = L53 } } }
		if = { #Naughty naughty, you're not supposed to go to the islands~
			limit = {
				region = fahvanosy_region
				owner = { has_country_modifier = L53_the_tower_stands_alone }
			}
			owner = { country_event = { id = flavour_tiboktsamo.15 } }
		}
		if = {
			limit = {
				has_province_modifier = L53_mainland_reclamation_permanent
				OR = {
					area = dogo_babolo_area
					area = asanbosom_tu_area
				}
			}
			add_province_modifier = {
				name = L53_mainland_reclamation
				duration = 9125
			}
		}
		if = {
			limit = { province_id = 5758 }
			province_event = { id = flavour_tiboktsamo.100 }
		}
	}
	
	#Konolkhatep
	if = {
		limit = {
			owner = {
				tag = F66
			}
		}
		if = {
			limit = {
				owner = {
					owns = 473
				}
				473 = { has_province_modifier = konolkhatep_high_temple_of_the_two }
			}
			if = {
				limit = {
					religion = nirakhetist
				}
				add_province_modifier = {
					name = konolkhatep_high_temple_of_the_two_nirakhetist
					duration = -1
				}
			}
			else_if = {
				limit = {
					religion = elikhetist
				}
				add_province_modifier = {
					name = konolkhatep_high_temple_of_the_two_elikhetist
					duration = -1
					hidden = yes
				}
			}
		}
		if = {
			limit = {
				empire_of_china_reform_passed = medasi_peak_civilization_reform
				OR = {
					culture = sorrowmane_gnoll
					culture_group = kheteratan
				}
			}
			add_province_modifier = {
				name = medasi_peak_civilization_reform_modifier
				duration = -1
				hidden = yes
			}
		}
	}
	if = {
		limit = {
			owner = {
				OR = {
					tag = F66
					is_subject_of = F66
				}
			}
		}
		if = {
			limit = {
				empire_of_china_reform_passed = luxuries_depths_reform
				continent = africa
				has_port = yes
			}
			add_province_modifier = {
				name = konolkhatep_luxuries_depths_modifier
				duration = -1
				hidden = yes
			}
		}
		if = {
			limit = { F66 = { has_country_flag = horutep_title_flag_icelord } }
			if = {
				limit = { has_winter = mild_winter }
				add_province_modifier = { name = konolkhatep_horutep_icelord_mild duration = -1 }
			}
			if = {
				limit = { has_winter = normal_winter }
				add_province_modifier = { name = konolkhatep_horutep_icelord_normal duration = -1 }
			}
			if = {
				limit = { has_winter = severe_winter }
				add_province_modifier = { name = konolkhatep_horutep_icelord_severe duration = -1 }
			}
		}
		if = {
			limit = { F66 = { has_country_flag = horutep_title_flag_guider_storms } }
			if = {
				limit = { has_monsoon = mild_monsoon }
				add_province_modifier = { name = konolkhatep_horutep_guider_of_storms_mild duration = -1 }
			}
			if = {
				limit = { has_monsoon = normal_monsoon }
				add_province_modifier = { name = konolkhatep_horutep_guider_of_storms_normal duration = -1 }
			}
			if = {
				limit = { has_monsoon = severe_monsoon }
				add_province_modifier = { name = konolkhatep_horutep_guider_of_storms_severe duration = -1 }
			}
		}
		if = {
			limit = { F66 = { has_country_flag = horutep_title_flag_banisher_darkness } }
			remove_province_modifier = aw_vampires_1
			remove_province_modifier = aw_vampires_2
			remove_province_modifier = aw_vampires_3
		}
		if = {
			limit = { F66 = { has_country_flag = horutep_title_flag_master_rivers } }
			if = {
				limit = { has_river_estuary_trigger = yes }
				add_province_modifier = { name = konolkhatep_horutep_master_of_rivers_modifier duration = -1 }
			}
		}
		if = {
			limit = { owner = { has_reform = F66_words_of_horutep } }
			if = {
				limit = {
					owner = { religion = elikhetist }
					religion = nirakhetist
				}
				add_province_modifier = { name = konolkhatep_voice_horutep_nirakhetist duration = -1 }
			}
			if = {
				limit = {
					owner = { religion = nirakhetist }
					religion = elikhetist
				}
				add_province_modifier = { name = konolkhatep_voice_horutep_elikhetist duration = -1 }
			}
		}
	}
	
	if = {
		limit = { owner = { mission_completed = ap_xiaken_temple_grounds } }
		add_province_modifier = { name = xiaken_temple_grounds_mod duration = -1 }
	}

	#Fangaulan Pantheon Holy Site Activation
	if = {
		limit = {
			province_group = fangaulan_pantheon_holy_sites
		}
		if = { #If the owner is fangaulan and the holy site is not active, activate it
			limit = {
				owner = { religion = fangaulan_pantheon }
				has_province_flag = fangaulan_pantheon_inactive_holy_site
			}
			fangaulan_pantheon_activate_holy_site = yes
		}
		else_if = { #If the owner is not fangaulan and the holy site is active, disable it
			limit = { 
				owner = {
					NOT = { religion = fangaulan_pantheon }
				}
				has_province_flag = fangaulan_pantheon_active_holy_site
			}
			fangaulan_pantheon_deactivate_holy_site = yes
		}
	}
}

on_primary_culture_changed_effect = {
	
	if = {
		limit = {
			OR = {
				has_reform = black_demesne_reform
				has_reform = black_acolyte_reform
			}
			NOT = { primary_culture = black_demesner }
		}
		change_primary_culture = black_demesner
	}

	#Khet mandate opinion modifier for enforcing culture
	if = {
		limit = { 
			is_subject_of_type = tributary_state 
			overlord = { primary_culture = ROOT }
		}
		add_opinion = { who = overlord modifier = khet_forced_culture }
	}
	# Reduced gov cap in primary culture
	if = {
		limit = { has_government_attribute = reduced_gov_cost_in_primary_culture }
		every_owned_province = { 
			if = {
				limit = { has_province_modifier = cultural_colonies_mod } 
				remove_province_modifier = cultural_colonies_mod
			}
			if = {
				limit = { has_owner_culture = yes }
				add_province_modifier = {
					name = cultural_colonies_mod
					duration = -1
				}
			}
		}
	}
	assign_dvp_cultural_aspects = yes

	if = {
		limit = { primary_culture = mossmouth_ogre }
		set_country_flag = was_mossmouth_ogre
		every_owned_province = {
			limit = {
				has_province_modifier = flooded_province
				culture = mossmouth_ogre
			}
			remove_province_modifier = flooded_province
			add_permanent_province_modifier = { name = flooded_province_inactive duration = -1 }
		}
	}
	else_if = {
		limit = {
			has_country_flag = was_mossmouth_ogre
			NOT = { primary_culture = mossmouth_ogre }
		}
		clr_country_flag = was_mossmouth_ogre
		every_owned_province = {
			limit = { has_province_modifier = flooded_province_inactive }
			remove_province_modifier = flooded_province_inactive
			add_permanent_province_modifier = { name = flooded_province duration = -1 }
		}
	}

	# Roosts activating/deactivating when you change to/from Harpy culture.
	harpy_roost_se_on_primary_culture_changed_effect = yes

	if = {
		limit = { primary_culture = sunrise_elf }
		set_country_flag = cannot_change_to_elven_military_unless_enough_dev
	}

	if = {
		limit = {
			OR = {
				has_reform = z22_prince_elect
				has_reform = z22_prince_elect_improved
			}
			NOT = {
				culture_is_elven = yes
			}
		}
		remove_country_modifier = z22_election_cycle_modifier
	}
}

#1.37 Diff new stuff
#Looks useful, but needs to be implemented elsewhere since we didn't properly carry this over before it seems? And so so so many edgecases.
#on_native_government_change_effect = {
#	hidden_effect = {
#		every_owned_province = {
#			if = { limit = { has_building = native_palisade } set_province_flag = native_palisade_flag }
#			if = { limit = { has_building = native_fortified_house } set_province_flag = native_fortified_house_flag }
#			if = { limit = { has_building = native_ceremonial_fire_pit } set_province_flag = native_ceremonial_fire_pit_flag }
#			if = { limit = { has_building = native_storehouse } set_province_flag = native_storehouse_flag }
#			if = { limit = { has_building = native_longhouse } set_province_flag = native_longhouse_flag }
#			if = { limit = { has_building = native_sweat_lodge } set_province_flag = native_sweat_lodge_flag }
#			if = { limit = { has_building = native_great_trail } set_province_flag = native_great_trail_flag }
#		}
#		country_event = {
#			id = native_americans.999
#			days = 35
#		}
#	}
#}

on_convert_by_trade_policy_effect = {
	FROM = { change_variable = { which = propogation_counter value = 1 } }
	# if = {
	# 	limit = {
	# 		trade_company_region = trade_company_moluccas
	# 		FROM = { is_defender_of_faith = yes }
	# 	}
	# 	FROM = {
	# 		if = {
	# 			limit = {
	# 				ai = no
	# 				NOT = { check_variable = { which = religion_propagated_in_moluccas value = 1 } }
	# 			}
	# 			set_variable = {
	# 				which = religion_propagated_in_moluccas value = 1
	# 			}
	# 		}
	# 		else_if = {
	# 			limit = {
	# 				ai = no
	# 				check_variable = { which = religion_propagated_in_moluccas value = 1 }
	# 				NOT = { check_variable = { which = religion_propagated_in_moluccas value = 6 } }
	# 			}
	# 			change_variable = {
	# 				which = religion_propagated_in_moluccas value = 1
	# 			}
	# 		}
	# 	}
	# }
	# if = {
	# 	limit = { FROM = { has_country_flag = YEM_propagation_gives_navy_tradition } }
	# 	FROM = { add_navy_tradition = 1 }
	# }
	# if = {
	# 	limit = {
	# 		FROM = { has_country_flag = orm_better_sea_religious_propagation }
	# 		OR = {
	# 			region = indonesia_region
	# 			region = moluccas_region
	# 			region = malaya_region
	# 		}
	# 	}
	# 	FROM = { add_piety = 0.005 }
	# }
	# if = {
	# 	limit = { FROM = { has_country_flag = hormuz_religious_propagations_buffs_flag } }
	# 	add_province_modifier = {
	# 		name = orm_hormuz_merchants_influence
	# 		duration = 7300
	# 	}
	# }
}

on_age_ability_taken_age_of_discovery = { } #for future use (and modders!) :)
on_age_ability_taken_age_of_reformation = { }
on_age_ability_taken_age_of_absolutism = { }
on_age_ability_taken_age_of_revolutions = { }
on_age_ability_taken = {
	on_age_ability_taken_$age$ = yes

}

on_scorch_earth_effect = {
	if = {
		limit = { ROOT = { has_country_flag = I33_clan_of_archers_reward } }
		ROOT = { add_mil_power = 5 }
	}
	if = {
		limit = {
			ROOT = { has_government_mechanic = karakhanbar_flames_of_the_black_hearth_mechanic }
		}
		if = {
			limit = { has_terrain = ancient_forest }
			ROOT = {
				add_government_power = {
					mechanic_type = karakhanbar_flames_of_the_black_hearth_mechanic
					power_type = karakhanbar_flames_of_the_black_hearth_power
					value = 10
				}
			}
		}
		else = {
			ROOT = {
				add_government_power = {
					mechanic_type = karakhanbar_flames_of_the_black_hearth_mechanic
					power_type = karakhanbar_flames_of_the_black_hearth_power
					value = 5
				}
			}
		}
	}
	if = {
		limit = {
			ROOT = { has_government_attribute = scorch_earth_slash_and_burn_effect }
			OR = {
				has_terrain = forest
				has_terrain = bloodgroves
				has_terrain = fey_gladeway
				has_terrain = gladeway
				has_terrain = ancient_forest
				has_terrain = woods
				has_terrain = mushroom_forest_terrain
				has_terrain = jungle
			}
			owned_by = ROOT
		}
		add_province_modifier = {
			name = karakhanbar_slash_and_burn
			duration = 1825
		}
	}
	if = {
		limit = {
			ROOT = { has_country_flag = karakhanbar_moderates_won }
			owned_by = ROOT
		}
		add_devastation = -5 
	}
	if = {
		limit = {
			ROOT = { has_country_flag = karakhanbar_hardliners_won }
			NOT = { owned_by = ROOT }
		}
		add_devastation = 10
	}
	if = {
		limit = {
			has_province_modifier = karakhanbar_feyinfused_grove
			controlled_by = ROOT
		}
		remove_province_modifier = karakhanbar_feyinfused_grove
	}
}

S53_won_battle_against_trolls = {
	change_variable = {
		trollBattlesWon = 1
	}	
}
on_province_owner_change_monuments = {
	##### When monument changes owner #####
	if = { #Ash Palace
		limit = { province_id = 625 }
		FROM = {
			every_owned_province = {
				remove_province_modifier = golden_highway_v2
			}
		}
	}
	if = { #Library of Aqatbar
		limit = { province_id = 536 }
		FROM = {
			every_owned_province = {
				remove_province_modifier = eduz_ginakku_university
			}
		}
	}
	if = { #PORT JAHER
		limit = { 
			province_id = 365
		}
		FROM = {
			every_owned_province = {
				ascajar_remove_culture_modifier = yes
			}
		}
		if = {
			limit = {
				has_great_project = {
					type = ascajar
					tier = 1
				}
			}
			owner = {
				every_owned_province = {
					limit = {
						OR = {
							has_owner_accepted_culture = yes
							has_owner_culture = yes
						}
					}
					ascajar_accepted_culture_modifier = yes
				}
			}
		}
	}
	if = {
		limit = { province_id = 5808 } #Dendugma Monastery
		FROM = {
			every_owned_province = {
				dendugma_monastery_remove_modifier = yes
			}
		}
		if = {
			limit = { 
				has_great_project = {
					type = dendugma_monastery
					tier = 2
				}
			}
			owner = {
				every_owned_province = {
					limit = {
						has_province_modifier = ironwood_trees
					}
					dendugma_monastery_ironwood_modifier = yes
				}
			}
		}
	}
	if = { #Grave Forest of Ilvandet
		limit = { province_id = 31 }
		if = {
			limit = {
				grave_forest_of_ilvandet_is_active = yes
				has_great_project = { type = grave_forest_of_ilvandet tier = 1 }
			}
			if = { #stricly level one
				limit = { NOT = { has_great_project = { type = grave_forest_of_ilvandet tier = 2 } } }
				owner = {
					every_owned_province = {
						limit = { OR = { region = lencenor_region region = west_dameshead_region } has_terrain = ancient_forest }
						add_province_modifier = {
							name = grave_forest_expanded_infrastructure
							duration = -1
							hidden = yes
						}
					}
				}
			}
			else_if = { #level two
				limit = { NOT = { has_great_project = { type = grave_forest_of_ilvandet tier = 3 } } }
				owner = { 
					every_owned_province = {
						limit = {
							OR = { region = lencenor_region region = west_dameshead_region }
							OR = {
								has_terrain = forest
								has_terrain = woods
								has_terrain = ancient_forest
							}
						}
						add_province_modifier = {
							name = grave_forest_expanded_infrastructure
							duration = -1
							hidden = yes
						}
					}
				}
			}
			else = { #level three
				owner = {
					every_owned_province = {
						limit = {
							OR = { region = lencenor_region region = west_dameshead_region }
							OR = {
								has_terrain = forest
								has_terrain = woods
								has_terrain = ancient_forest
							}
						}
						add_province_modifier = {
							name = grave_forest_expanded_infrastructure
							duration = -1
							hidden = yes
						}
					}
					every_owned_province = {
						limit = {
							has_terrain = forest
						}
						add_province_modifier = {
							name = grave_forest_forest
							duration = -1
						}
					}
					every_owned_province = {
						limit = {
							has_terrain = woods
						}
						add_province_modifier = {
							name = grave_forest_wood
							duration = -1
						}
					}
					every_owned_province = {
						limit = {
							has_terrain = ancient_forest
						}
						add_province_modifier = {
							name = grave_forest_ancient_forest
							duration = -1
						}
					}
				}
			}
		}
		FROM = { #remove from prev owner
			every_owned_province = {
				remove_province_modifier = grave_forest_expanded_infrastructure
				remove_province_modifier = grave_forest_forest
				remove_province_modifier = grave_forest_wood
				remove_province_modifier = grave_forest_ancient_forest
			}
			clr_country_flag = unlocked_privilege_estate_burghers_forest_expansion
		}
	}
	if = { #Imperial Palace
		limit = {
			province_id = 8
		}
		every_country = {
			remove_country_modifier = imperial_palace_prince_modifier_tier_1
			remove_country_modifier = imperial_palace_prince_modifier_tier_2
			remove_country_modifier = imperial_palace_prince_modifier_tier_3
		}
		emperor = {
			remove_country_modifier = imperial_palace_modifier_tier_1
			remove_country_modifier = imperial_palace_modifier_tier_2
			remove_country_modifier = imperial_palace_modifier_tier_3
		}
		if = {
			limit = { owner = { is_part_of_hre = yes } }
			if = { #tier 3
				limit = {
					has_great_project = { type = imperial_palace_anbenncost tier = 3 }
				}
				every_country = {
					limit = { is_part_of_hre = yes }
					add_country_modifier = {
						name = imperial_palace_prince_modifier_tier_3
						duration = -1
					}
				}
				emperor = {
					add_ruler_modifier = {
						name = imperial_palace_modifier_tier_3
						duration = -1
					}
				}
			}
			else_if = { #tier 2
				limit = {
					has_great_project = { type = imperial_palace_anbenncost tier = 2 }
				}
				every_country = {
					limit = { is_part_of_hre = yes }
					add_country_modifier = {
						name = imperial_palace_prince_modifier_tier_2
						duration = -1
					}
				}
				emperor = {
					add_ruler_modifier = {
						name = imperial_palace_modifier_tier_2
						duration = -1
					}
				}
			}
			else_if = { #exactly tier 1
				limit = {
					has_great_project = { type = imperial_palace_anbenncost tier = 1 }
				}
				every_country = {
					limit = { is_part_of_hre = yes }
					add_country_modifier = {
						name = imperial_palace_prince_modifier_tier_1
						duration = -1
					}
				}
				emperor = {
					add_ruler_modifier = {
						name = imperial_palace_modifier_tier_1
						duration = -1
					}
				}
			}
		}
	}
	if = { #Refuge of the Glasslords
		limit = {
			province_id = 86
			has_great_project = { type = refuge_of_the_glasslords tier = 1 } # because tier 1 does nothing, if the monument is tier 0 it was giving no bonuses before even if it dropped a level from being conquered
		}
		FROM = {
			every_owned_province = {
				limit = { trade_goods = wine }
				remove_province_modifier = generic_production_25
				remove_province_modifier = generic_production_50
			}
		}
		set_variable = {
			which = glasslord_wine_CoTs
			value = 0
		}
		clear_glasslord_network = yes #in case the monument was tier 3 before
		if = { #can use monument
			limit = {
				refuge_of_the_glasslords_is_active = yes
				has_great_project = { type = refuge_of_the_glasslords tier = 2 } #because tier 1 does nothing
			}
			if = { #in case of diplo annexing
				limit = { has_great_project = { type = refuge_of_the_glasslords tier = 3 } }
				owner = {
					every_owned_province = {
						limit = { trade_goods = wine }
						add_province_modifier = {
							name = generic_production_50
							duration = -1
						}
						if = {
							limit = { province_has_center_of_trade_of_level = 1 }
							add_dwarven_minority_size_effect = yes
							86 = {
								change_variable = {
									which = glasslord_wine_CoTs
									value = 1
								}
							}
						}
					}
				}
				add_glasslord_network = yes
			}
			else = { #level 2
				owner = {
					every_owned_province = {
						limit = { trade_goods = wine }
						add_province_modifier = {
							name = generic_production_25
							duration = -1
						}
					}
				}
			}
		}
	}
	if = { #Nimsnoms in case of diplo annex
		limit = {
			province_id = 129
		}
		if = {
			limit = {
				has_great_project = {
					type = nimsnoms_theatre
					tier = 3
				}
				nimsnoms_theatre_is_active = yes
			}
			owner = { set_country_flag = unlocked_wip_god }
		}
		else_if = {
			limit = {
				has_great_project = {
					type = nimsnoms_theatre
					tier = 2
				}
			}
			FROM = { clr_country_flag = unlocked_wip_god }
		}
	}
	if = {
		limit = { 
			FROM = { is_or_was_tag = { tag = B59 } } #Pashaine
		}
		if = { #Baths Of Verinus
			limit = { province_id = 394 } #Eastbright
			FROM = {
				if = {
					limit = { has_country_flag = pashaine_bathouse }
					every_owned_province = {
						remove_province_modifier = pashaine_baths_of_verinus_tier_2_mod
						remove_province_modifier = pashaine_baths_of_verinus_tier_3_mod
					}
				}
			}
		}
		if = { #Unlikely to happend, but might as well
			limit = {
				has_great_project = {
					type = palace_of_unity
				}
			}
			FROM = { clr_country_flag = pashaine_bonus_dev_on_anbennarian }
		}
	}
	if = { #Yidablaerun, The Broodmother's Nest
		limit = {
			has_great_project = { #Remove flag from annexed country. Don't bother changing flags for tier 0
				type = dd_yidablaerun
				tier = 1
			}
		}
		FROM = { clr_country_flag = yidablaerun_poor_uniforms_disabled }
		
		if = {
			limit = {
				has_great_project = {
					type = dd_yidablaerun
					tier = 2
				}
				owner = { can_use_dungeons = yes }
			}
			owner = { set_country_flag = yidablaerun_poor_uniforms_disabled }
		}
	}

	##### When you have monument #####
	if = { #Ascajar
		limit = {
			owner = {
				owns = 365
				365 = {
					has_great_project = {
						type = ascajar
						tier = 1
					}
				}
			}
			has_owner_accepted_culture = yes
			has_owner_culture = yes
		}
		ascajar_accepted_culture_modifier = yes
	}
	if = { #Ash Palace
		limit = {
			has_province_modifier = golden_highway
			owner = {
				owns = 625
			}
			625 = {
				has_great_project = {
					type = ash_palace
					tier = 3
				}
			}
		}
		add_province_modifier = {
			name = golden_highway_v2
			duration = -1
			hidden = yes
		}
	}
	if = { #Dendugma Monastery
		limit = {
			has_province_modifier = ironwood_trees
			owner = {
				owns = 5808
			}
			5808 = {
				has_great_project = {
					type = dendugma_monastery
					tier = 2
				}
			}
		}
		dendugma_monastery_ironwood_modifier = yes
	}
	if = { #Grave Forest of Ilvandet addition
		limit = {
			OR = {
				has_terrain = ancient_forest
				has_terrain = woods
				has_terrain = forest
			}
			owner = { owns = 31 }
			31 = {
				has_great_project = { type = grave_forest_of_ilvandet tier = 1 }
				grave_forest_of_ilvandet_is_active = yes
			}
		}
		if = { #if tier 1 only on ancient forest
			limit = {
				NOT = { 31 = { has_great_project = { type = grave_forest_of_ilvandet tier = 2 } } }
				OR = { region = lencenor_region region = west_dameshead_region }
				has_terrain = ancient_forest
			}
			add_province_modifier = {
				name = grave_forest_expanded_infrastructure
				duration = -1
				hidden = yes
			}
		}
		else_if = { #if tier 2 on ancient forest, forest and woods
			limit = {
				NOT = { 31 = { has_great_project = { type = grave_forest_of_ilvandet tier = 3 } } } 
				OR = { region = lencenor_region region = west_dameshead_region }
			}
			add_province_modifier = {
				name = grave_forest_expanded_infrastructure
				duration = -1
				hidden = yes
			}
		}
		else_if = { #if tier 3 on ancient forest, forest and woods
			limit = {
				OR = { region = lencenor_region region = west_dameshead_region }
			}
			add_province_modifier = {
				name = grave_forest_expanded_infrastructure
				duration = -1
				hidden = yes
			}
		}
	}
	if = {
		limit = {
			owner = { owns = 31 }
			31 = {
				has_great_project = { type = grave_forest_of_ilvandet tier = 3 }
				grave_forest_of_ilvandet_is_active = yes
			}
			has_terrain = ancient_forest
		}
		add_province_modifier = {
				name = grave_forest_ancient_forest
				duration = -1
				hidden = yes
		}
	}
	if = {
		limit = {
			owner = { owns = 31 }
			31 = {
				has_great_project = { type = grave_forest_of_ilvandet tier = 3 }
				grave_forest_of_ilvandet_is_active = yes
			}
			has_terrain = woods
		}
		add_province_modifier = {
				name = grave_forest_wood
				duration = -1
				hidden = yes
		}
	}
	if = {
		limit = {
			owner = { owns = 31 }
			31 = {
				has_great_project = { type = grave_forest_of_ilvandet tier = 3 }
				grave_forest_of_ilvandet_is_active = yes
			}
			has_terrain = forest
		}
		add_province_modifier = {
				name = grave_forest_forest
				duration = -1
				hidden = yes
		}
	}
	if = { #Refuge of the Glasslords
		limit = { trade_goods = wine }
		if = {
			limit = {
				owner = { owns = 86 }
				86 = {
					has_great_project = { type = refuge_of_the_glasslords tier = 2 }
					refuge_of_the_glasslords_is_active = yes
				}
			}
			if = { #exactly tier 3
				limit = {
					86 = {
						has_great_project = { type = refuge_of_the_glasslords tier = 3 }
						refuge_of_the_glasslords_is_active = yes
					} 
				}
				add_province_modifier = {
					name = generic_production_50
					duration = -1
				}
				if = {
					limit = {
						province_has_center_of_trade_of_level = 1
					}
					add_dwarven_minority_size_effect = yes
					86 = {
						clear_glasslord_network = yes
						change_variable = {
							which = glasslord_wine_CoTs
							value = 1
						}
						add_glasslord_network = yes
					}
				}
			}
			else = { #exactly tier 2
				add_province_modifier = {
					name = generic_production_25
					duration = -1
				}
			}
		}
		else_if = {
			limit = {
				province_has_center_of_trade_of_level = 1
				FROM = { owns = 86 }
				86 = {
					has_great_project = { type = refuge_of_the_glasslords tier = 3 }
					refuge_of_the_glasslords_is_active = yes
				}
			}
			remove_dwarven_minority_size_effect = yes
			86 = {
				clear_glasslord_network = yes
				change_variable = {
					which = glasslord_wine_CoTs
					value = -1
				}
				add_glasslord_network = yes
			}
		}
	}
	if = { #Baths Of Verinus
		limit = { 
			owner = { 
				owns = 394 #Eastbright
				has_country_flag = pashaine_bathhouse 
			}
			region = east_dameshead_region 
		}
		if = {
			limit = {
				394 = { #Eastbright
					has_great_project = {
						type = baths_of_verinus
						tier = 3
					}
				}
			}
			add_province_modifier = {
				name = pashaine_baths_of_verinus_tier_3_mod
				duration = -1
			}
		}
		else_if = {
			limit = {
				394 = { #Eastbright
					has_great_project = {
						type = baths_of_verinus
						tier = 2
					}
				}
			}
			add_province_modifier = {
				name = pashaine_baths_of_verinus_tier_2_mod
				duration = -1
			}
		}
	}
}

on_production_manufactory_built_effect = { #Farm Estate, Wharf, Plantation but not Ramparts
	owner = { accretive_path_gain_chi = { aspect = tea_ceremonies category = dip amount = 25 } }
}

on_production_manufactory_destroyed_effect = { #Farm Estate, Wharf, Plantation but not Ramparts

}

on_idea_taken_effect = { #Any basic idea e.g. "War Council" in Mercenary ideas or "Global Empire" in Exploration
	accretive_path_gain_chi = { aspect = peacock_emissaries category = dip amount = 40 }
}

on_idea_removed_effect = { #When any basic idea is removed

}

on_idea_group_finished_effect = { #Taking the final idea in an idea group i.e. the seventh idea
	increase_legitimacy_equivalent_absolutism_from_idea_groups_mod = yes
}

on_idea_group_unfinished_effect = { #Removing the final idea in a group whereas it had previously been completed
	decrease_legitimacy_equivalent_absolutism_from_idea_groups_mod = yes
}