halves_parliament_bribe_costs = {
    if = {
        limit = {
			OR = {
				has_dlc = "Common Sense"
				has_dlc = "Domination"
			}
		}
        custom_tooltip = halves_parliament_bribe_costs_tt
    }
    set_country_flag = halved_parliament_bribe_costs
}

set_expensive_debates = {
	if = {
        limit = {
			OR = {
				has_dlc = "Common Sense"
				has_dlc = "Domination"
			}
		}
        custom_tooltip = expensive_bribe_costs_tt
    }
    set_country_flag = expensive_debates
}

unlock_new_issues = {
	if = {
        limit = {
			OR = {
				has_dlc = "Common Sense"
				has_dlc = "Domination"
			}
		}
		custom_tooltip = pol_unlock_new_issues_tt 
	}
	set_country_flag = pol_new_issues_tt
}

# Country scope
# Supports the following estates
################################
# estate_brahmins
# estate_church
# estate_maratha
# estate_nobles
# estate_burghers
# estate_vaisyas
# estate_cossacks
# estate_nomadic_tribes
# estate_dhimmi
# estate_jains
# estate_rajput
# estate_janissaries
# estate_eunuchs
issue_effect_scaling_with_estate_influence = {
	if = {
		limit = { 
			OR = {
				has_government_attribute = english_parliament 
				has_government_attribute = estates_influenced_parliament #Anbennar
			}
		}
		if = {
			limit = {
				has_estate = $estate$
			}
			custom_tooltip = issue_effects_with_$estate$_influence_tt
			if = {
				limit = {
					NOT = {
						estate_influence = {
							influence = 20
							estate = $estate$
						}
					}
				}
				[[effect1]$effect1$]
			}
			if = {
				limit = {
					estate_influence = {
						influence = 20
						estate = $estate$
					}
					NOT = {
						estate_influence = {
							influence = 40
							estate = $estate$
						}
					}
				}
				$effect2$
			}
			if = {
				limit = {
					estate_influence = {
						influence = 40
						estate = $estate$
					}
					NOT = {
						estate_influence = {
							influence = 60
							estate = $estate$
						}
					}
				}
				$effect3$
			}
			if = {
				limit = {
					estate_influence = {
						influence = 60
						estate = $estate$
					}
					NOT = {
						estate_influence = {
							influence = 80
							estate = $estate$
						}
					}
				}
				$effect4$
			}
			if = {
				limit = {
					estate_influence = {
						influence = 80
						estate = $estate$
					}
				}
				$effect5$
			}
		}
		else = {
			$fallback_effect$
		}
	}
	else = {
		$fallback_effect$
	}
}

bribe_effect_scaling_with_estate_loyalty = {
	if = {
		limit = { 
			OR = {
				has_government_attribute = english_parliament 
				has_government_attribute = estates_influenced_parliament #Anbennar
			}
		}
		if = {
			limit = {
				has_estate = $estate$
			}
			custom_tooltip = bribe_effect_scales_with_$estate$_tt
			if = {
				limit = {
					NOT = {
						estate_loyalty = {
							estate = $estate$
							loyalty = 30
						}
					}
				}
				$effect_angry$
			}
			if = {
				limit = {
					estate_loyalty = {
						estate = $estate$
						loyalty = 30
					}
					NOT = {
						estate_loyalty = {
							estate = $estate$
							loyalty = 60
						}
					}
				}
				$effect_neutral$
			}
			if = {
				limit = {
					estate_loyalty = {
						loyalty = 60
						estate = $estate$
					}
				}
				$effect_happy$
			}
		}
		else = {
			$effect_neutral$
		}
	}
	else = {
		[[default_effect]$default_effect$]
	}
}

increase_issue_passed_counter = {
	hidden_effect = {
		change_variable = {
			which = issues_passed
			value = 1
		}
	}
}

# Supports the following issues
###############################
# Loc in style of: unlock_issue_$issue$_tt: "Unlock the ยงYยง! Parliament Issue."
# acts_of_high_admiralty
# acts_of_maritime_courage
# acts_of_maritime_professionalism
# english_scottish_act_of_union
# british_ideas_laws
# angevin_ideas_laws
# english_ideas_laws
# cultural_unity_act
# colonial_venture_act
# crown_of_iberia_act
# act_of_exploration
# acts_of_impressment
# acts_of_taxation
# act_of_representation
# english_french_act_of_union
# crown_of_italy_act
# the_gold_act
# the_spice_act
# the_sugar_act
# establish_the_imperial_diet_act
# appointment_of_state_minister
# enact_mercantilism
# promote_free_trade
# military_reform_acts
unlock_issue = {
	if = {
		limit = { has_parliament = yes }
		custom_tooltip = unlock_issue_$issue$_tt
	}
	else = {
		add_adm_power = 25
		add_dip_power = 25
		add_mil_power = 25
	}
	hidden_effect = {
		set_country_flag = unlocked_issue_$issue$
	}
}

back_seats_of_bribe_type = {
	every_owned_province = {
		limit = { 
			has_seat_in_parliament = yes
			OR = {
				current_bribe = $bribe$
				current_bribe = national_$bribe$
			}
			NOT = { province_id = FROM }
		}
		back_current_issue = yes
	}
}

bribe_estate_effect = {
	if = {
		limit = {
			has_expensive_debate = yes
			NOT = { halved_parliament_bribes = yes }
		}
		add_estate_influence_modifier = {
			estate = $estate$
			desc = EST_VAL_SEAT_BRIBED
			influence = 4
			duration = 9125
			add = yes
		}
	}
	else_if = {
		limit = {
			OR = {
				AND = {
					has_expensive_debate = yes
					halved_parliament_bribes = yes
				}
				AND = {
					NOT = { has_expensive_debate = yes }
					NOT = { halved_parliament_bribes = yes }
				}
			}
		}
		add_estate_influence_modifier = {
			estate = $estate$
			desc = EST_VAL_SEAT_BRIBED
			influence = 2
			duration = 9125
			add = yes
		}
	}
	else = {
		add_estate_influence_modifier = {
			estate = $estate$
			desc = EST_VAL_SEAT_BRIBED
			influence = 1
			duration = 9125
			add = yes
		}
	}
}

national_bribe_estate_effect = {
	if = {
		limit = {
			has_expensive_debate = yes
			NOT = { halved_parliament_bribes = yes }
		}
		add_estate_influence_modifier = {
			estate = $estate$
			desc = EST_VAL_SEAT_BRIBED
			influence = 20
			duration = 9125
			add = yes
		}
	}
	else_if = {
		limit = {
			OR = {
				AND = {
					has_expensive_debate = yes
					halved_parliament_bribes = yes
				}
				AND = {
					NOT = { has_expensive_debate = yes }
					NOT = { halved_parliament_bribes = yes }
				}
			}
		}
		add_estate_influence_modifier = {
			estate = $estate$
			desc = EST_VAL_SEAT_BRIBED
			influence = 10
			duration = 9125
			add = yes
		}
	}
	else = {
		add_estate_influence_modifier = {
			estate = $estate$
			desc = EST_VAL_SEAT_BRIBED
			influence = 5
			duration = 9125
			add = yes
		}
	}
}

parlaments_rotten_events = {
	if = {
		limit = {
			OR = {
				has_dlc = "Common Sense"
				has_dlc = "Domination"
			}
			has_parliament = yes
			NOT = { has_government_attribute = anb_special_seats }
			NOT = { has_country_flag = G54_no_rotten_borough_flag }
			NOT = { has_reform = argordstun_stubborn_reformists } #Unsure why this is here
			NOT = { has_estate_privilege = estate_church_J52_consecrate_industry }

			any_owned_province = { #We have a rotten province
				has_seat_in_parliament = yes
				is_capital = no
				NOT = { has_province_modifier = rotten_borough }
				NOT = { development = 10 }
			}

			any_owned_province = { #We have a better province
				development = 10
				is_core = owner
				has_seat_in_parliament = no
				is_overseas = no
				is_state = yes
				OR = {
					has_owner_accepted_culture = yes
					has_owner_culture = yes
				}
			}
		}
		random_list = {
			4 = {} #Baseline chance of nothing ~16 years or 192 months
			1 = {
				modifier = { #Mimics parlaments.3
					factor = 2
					is_year = 1500
				}
				country_event = { id = parlaments.2 random = 365 } #Rotten seat
			}
		}
	}
}

parlaments_representation_events = {
	if = {
		limit = {
			adm_tech = 22
			OR = {
				has_dlc = "Common Sense"
				has_dlc = "Domination"
			}
			num_of_cities = 2

			OR = { #The two government types that can get parliamentary reform
				government = monarchy
				government = republic
			}

			NOT = { has_parliament = yes } #We don't already have representation

			NOT = { has_reform = elective_monarchy }
			NOT = { has_reform = free_city }
			NOT = { is_revolutionary_republic_trigger = yes }
			NOT = { has_reform = presidential_despot_reform }
			NOT = { has_reform = ambrosian_republic }
			NOT = { is_emperor_of_china = yes }
			NOT = { has_government_attribute = is_peasants_republic }
			NOT = { has_reform = colonial_government }
			NOT = { is_revolutionary_monarchy_trigger = yes }

			#Anbennar
			NOT = { has_reform = damescrown_republic_reform }	#dutch republic
			NOT = { has_reform = free_slave_reform }	#mamluk
			NOT = { has_government_attribute = is_raja  }	#shogunates
			NOT = { has_reform = prabhi_reform }
			NOT = { has_reform = indep_prabhi_reform }
		}
		random_list = {
			10 = {} #Baseline chance of nothing ~ 50 years or 600 months
			2 = {
				trigger = {
					NOT = { has_reform = parliamentary_reform }
					num_of_cities = 4
				}
				country_event = { id = parlaments.23 random = 365 } #Country wants parliament
			}
			1 = {
				trigger = {
					num_of_loans = 5
					NOT = { treasury = 50 }
					NOT = { has_country_modifier = yearning_for_representation }
					NOT = { has_ruler_flag = cities_offered_to_help }
				}
				modifier = {
					factor = 2
					NOT = { has_reform = parliamentary_reform }
				}
				country_event = { id = parlaments.24 random = 365 } #Loans, cities want seats
			}
			2 = { #loss of precision to avoid scaling with the square of owned provinces
				trigger = {
					NOT = { stability = 2 }
					NOT = { has_ruler_flag = minorities_denied_representation }
					num_of_owned_provinces_with = {
						value = 2
						has_owner_accepted_culture = no
						is_overseas = no
					}
				}
				country_event = { id = parlaments.25 random = 365 } #Minorities want parliament
			}
		}
	}
}
