namespace = flavour_celmaldor


#I use this one to guarantee the explorer becomes OP, I want to keep the event specifically so if Stern plays the tree I can tell him to fire it in console
country_event = {
	id = flavour_celmaldor.0
	title = flavour_celmaldor.0.t
	desc = flavour_celmaldor.0.d
	picture = NORTH_SEA_MAPS_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
	}

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.0.a
		set_country_flag = z22_celmaldor_debug
	}
}

#Urvion Wavedancer
country_event = {
	id = flavour_celmaldor.1
	title = flavour_celmaldor.1.t
	desc = flavour_celmaldor.1.d
	picture = SHIP_SAILING_eventPicture

	is_triggered_only = yes

	fire_only_once = yes

	trigger = {
		is_or_was_tag = { tag = Z22 }
		navy_tradition = 40
		storm_isles_area = {
			owned_by = ROOT
		}
	}

	immediate = {
		set_country_flag = z22_urvion_event_1
	}

	option = {
		name = flavour_celmaldor.1.a
		ai_chance = {
			factor = 1
		}
		small_increase_of_troll_tolerance_effect = yes
		define_explorer = {
			shock = 2
			fire = 2
			manuever = 5
			siege = 0
			name = "Urvion Wavedancer"
		}
		reaversea_area = {
			discover_country = ROOT
		}
		lonely_sea_area = {
			discover_country = ROOT
		}
		1001 = {
			discover_country = ROOT
			if = {
				limit = {
					NOT = {
						owned_by = ROOT
					}
				}
				add_permanent_claim = ROOT
			}
		}
		190 = {
			light_ship = ROOT
		}
	}
}

#Urvion disappears
country_event = {
	id = flavour_celmaldor.2
	title = flavour_celmaldor.2.t
	desc = flavour_celmaldor.2.d
	picture = NORTH_SEA_MAPS_eventPicture

	is_triggered_only = yes

	fire_only_once = yes 

	trigger = {
		is_or_was_tag = { tag = Z22 }
		bloodgroves_region = {
			type = all
			OR = {
				has_port = no
				has_discovered = ROOT
			}
		}
		trollsbay_region = {
			type = all
			OR = {
				has_port = no
				has_discovered = ROOT
			}
		}
		has_leader = "Urvion Wavedancer"
	}

	immediate = {
		set_country_flag = z22_urvion_event_2
	}

	option = {
		name = flavour_celmaldor.2.a
		ai_chance = {
			factor = 1
		}
		kill_leader = {
			type = "Urvion Wavedancer"
		}
		hidden_effect = {
			random_list = {
				5 = {
					modifier = {
						factor = 10000000
						has_country_flag = z22_celmaldor_debug
					}
					country_event = {
						id = flavour_celmaldor.3
						days = 30
						random = 335
					}
				}
				95 = {

				}
			}
		}
	}
}

#Urvion returns
country_event = {
	id = flavour_celmaldor.3
	title = flavour_celmaldor.3.t
	desc = flavour_celmaldor.3.d
	picture = THE_HEROINE_eventPicture

	trigger = {
		is_or_was_tag = { tag = Z22 }
	}

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.3.a
		ai_chance = {
			factor = 1
		}
		define_explorer = {
			shock = 5
			fire = 5
			manuever = 10
			siege = 5
			name = "Urvion 'Deep Eyes' Wavedancer"
			trait = great_explorer_personality
		}
	}
}

#Soldiers of the Reach
country_event = {
	id = flavour_celmaldor.4
	title = flavour_celmaldor.4.t
	desc = flavour_celmaldor.4.d
	picture = DISCIPLINED_SOLDIERS_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
	}

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.4.a
		ai_chance = {
			factor = 1
		}
		clear_racial_military = yes
		tooltip = {
			add_country_modifier = {
				name = human_military
				duration = -1
			}
		}
		add_country_modifier = {
			name = human_military
			duration = -1
			hidden = yes
		}
		hidden_effect = {
			change_unit_type = tech_gerudian
		}
		z22_niche_mil_effects_check = yes
		add_country_modifier = {
			name = z22_men_elves
			duration = -1
		}
	}

	option = {
		name = flavour_celmaldor.4.b
		ai_chance = {
			factor = 1
		}
		add_country_modifier = {
			name = z22_elves_men
			duration = -1
		}
	}
}

#elves of the old world
country_event = {
	id = flavour_celmaldor.5
	title = flavour_celmaldor.5.t
	desc = flavour_celmaldor.5.d
	picture = NATIVE_AMERICANS_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
	}

	fire_only_once = yes
	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.5.a
		ai_chance = {
			factor = 1
		}
		largest_increase_of_ruinborn_tolerance_effect = yes
	}
}

#specialised snowy shipyards
country_event = {
	id = flavour_celmaldor.6
	title = flavour_celmaldor.6.t
	desc = flavour_celmaldor.6.d
	picture = NORTH_SEA_MAPS_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
	}

	fire_only_once = yes
	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.6.a
		ai_chance = {
			factor = 1
		}
		add_country_modifier = {
			name = z22_specialised_light
			duration = -1
		}
	}

	option = {
		name = flavour_celmaldor.6.b
		ai_chance = {
			factor = 1
		}
		add_country_modifier = {
			name = z22_specialised_heavy
			duration = -1 
		}
	}
}

#purpose without conflict
country_event = {
	id = flavour_celmaldor.7
	title = flavour_celmaldor.7.t
	desc = flavour_celmaldor.7.d
	picture = NORTH_SEA_MAPS_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
	}

	fire_only_once = yes
	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.7.a
		ai_chance = {
			factor = 1
		}
		1001 = {
			add_province_modifier = {
				name = z22_whitespear_expedition_society
				duration = -1
			}
		}
		every_country = {
			limit = {
				culture_is_ruinborn = yes
			}
			add_opinion = {
				who = ROOT
				modifier = z22_whitespear_society_relations
			}
		}
		gerudia_superregion = {
			limit = {
				province_has_center_of_trade_of_level = 1
				OR = {
					country_or_non_sovereign_subject_holds = ROOT
					owner = {
						is_giesadh = yes
					}
				}
			}
			add_province_modifier = {
				name = z22_icewind_commerce_house
				duration = -1
			}
		}
		add_country_modifier = {
			name = z22_frozentide_anticorruption
			duration = -1
		}
	}
}

#aspiring towards migrant ships
country_event = {
	id = flavour_celmaldor.8
	title = flavour_celmaldor.8.t
	desc = flavour_celmaldor.8.d
	picture = CITY_DEVELOPMENT_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.8.a
		ai_chance = {
			factor = 5
		}
		hidden_effect = {
			set_variable = {
				which = CelmaldorShipProgress
				value = 1
			}
		}
	}
}

#expertise of the sea elves
country_event = {
	id = flavour_celmaldor.9
	title = flavour_celmaldor.9.t
	desc = flavour_celmaldor.9.d
	picture = SHIP_SAILING_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavour_celmaldor.9.a
		ai_chance = {
			factor = 5
		}
		add_treasury = -1000
		define_advisor = {
			type = trader
			culture = sea_elf
			skill = 5
			cost_multiplier = 0.25
		}
		hidden_effect = {
			change_variable = {
				which = CelmaldorShipProgress
				value = 1
			}
		}
	}

	option = {
		name = flavour_celmaldor.9.b
		ai_chance = {
			factor = 5
		}
		add_prestige = -10
	}
}

#scourge of decent elvenkind
country_event = {
	id = flavour_celmaldor.10
	title = flavour_celmaldor.10.t
	desc = flavour_celmaldor.10.d
	picture = ACCUSATION_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavour_celmaldor.10.a
		ai_chance = {
			factor = 5
		}
		add_treasury = -1000
		add_republican_tradition = -10
		add_prestige = -25
		hidden_effect = {
			change_variable = {
				which = CelmaldorShipProgress
				value = 1
			}
		}
	}

	option = {
		name = flavour_celmaldor.10.b
		ai_chance = {
			factor = 5
		}
		add_republican_tradition = 10
		add_prestige = 20
	}
}

#records and study of diranhria
country_event = {
	id = flavour_celmaldor.11
	title = flavour_celmaldor.11.t
	desc = flavour_celmaldor.11.d
	picture = HARBOUR_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavour_celmaldor.11.a
		ai_chance = {
			factor = 5
		}
		add_treasury = -1000
		add_dip_power = -50
		496 = {
			owner = {
				add_opinion = {
					who = ROOT
					modifier = z22_collaborative_shipbuilding
				}
			}
		}
		hidden_effect = {
			change_variable = {
				which = CelmaldorShipProgress
				value = 1
			}
		}
	}

	option = {
		name = flavour_celmaldor.11.b
		ai_chance = {
			factor = 5
		}
		add_prestige = -25
		add_dip_power = 50
		496 = {
			owner = {
				add_opinion = {
					who = ROOT
					modifier = z22_turned_away
				}
			}
		}
	}
}

#migrant ship building tick
country_event = {
	id = flavour_celmaldor.12
	title = flavour_celmaldor.12.t
	desc = flavour_celmaldor.12.d
	picture = CITY_DEVELOPMENT_eventPicture

	is_triggered_only = yes
	hidden = yes

	trigger = {
		is_or_was_tag = { tag = Z22 }
		mission_completed = z22_galsheah_dream
		NOT = {
			mission_completed = z22_it_sails
		}
	}

	option = {
		name = flavour_celmaldor.12.a
		ai_chance = {
			factor = 5
		}
		hidden_effect = {
			random_list = {
				10 = {
					modifier = {
						factor = 1.1
						trading_part = {
							trade_goods = precursor_relics
							value = 0.01
						}
					}
					modifier = {
						factor = 1.1
						trading_part = {
							trade_goods = precursor_relics
							value = 0.02
						}
					}
					modifier = {
						factor = 1.1
						trading_part = {
							trade_goods = precursor_relics
							value = 0.03
						}
					}
					modifier = {
						factor = 1.1
						trading_part = {
							trade_goods = precursor_relics
							value = 0.04
						}
					}
					modifier = {
						factor = 1.1
						trading_part = {
							trade_goods = precursor_relics
							value = 0.05
						}
					}
					modifier = {
						factor = 1.1
						trading_part = {
							trade_goods = precursor_relics
							value = 0.06
						}
					}
					modifier = {
						factor = 1.1
						trading_part = {
							trade_goods = precursor_relics
							value = 0.07
						}
					}
					modifier = {
						factor = 1.1
						trading_part = {
							trade_goods = precursor_relics
							value = 0.08
						}
					}
					modifier = {
						factor = 1.1
						trading_part = {
							trade_goods = precursor_relics
							value = 0.09
						}
					}
					modifier = {
						factor = 1.1
						trading_part = {
							trade_goods = precursor_relics
							value = 0.1
						}
					}
					modifier = {
						factor = 1.1
						trade_goods_produced_amount = {
							trade_goods = naval_supplies
							amount = 15
						}
					}
					modifier = {
						factor = 1.1
						trade_goods_produced_amount = {
							trade_goods = naval_supplies
							amount = 20
						}
					}
					modifier = {
						factor = 1.1
						trade_goods_produced_amount = {
							trade_goods = naval_supplies
							amount = 25
						}
					}
					modifier = {
						factor = 1.1
						trade_goods_produced_amount = {
							trade_goods = naval_supplies
							amount = 30
						}
					}
					modifier = {
						factor = 1.1
						trade_goods_produced_amount = {
							trade_goods = naval_supplies
							amount = 35
						}
					}
					modifier = {
						factor = 1.1
						trade_goods_produced_amount = {
							trade_goods = naval_supplies
							amount = 40
						}
					}
					modifier = {
						factor = 1.1
						trade_goods_produced_amount = {
							trade_goods = naval_supplies
							amount = 45
						}
					}
					modifier = {
						factor = 1.1
						trade_goods_produced_amount = {
							trade_goods = naval_supplies
							amount = 50
						}
					}
					change_variable = {
						which = CelmaldorShipProgress
						value = 1
					}
					random = {
						chance = 50
						random_list = {
							1 = {
								country_event = {
									id = flavour_celmaldor.9
									days = 30
									random = 30
								}
							}
							1 = {
								country_event = {
									id = flavour_celmaldor.10
									days = 30
									random = 30
								}
							}
							1 = {
								country_event = {
									id = flavour_celmaldor.11
									days = 30
									random = 30
								}
							}
						}
					}
				}
				10 = {
					random = {
						chance = 50
						random_list = {
							1 = {
								country_event = {
									id = flavour_celmaldor.9
									days = 30
									random = 30
								}
							}
							1 = {
								country_event = {
									id = flavour_celmaldor.10
									days = 30
									random = 30
								}
							}
							1 = {
								country_event = {
									id = flavour_celmaldor.11
									days = 30
									random = 30
								}
							}
						}
					}
				}
			}
		}
	}
}

country_event = {
	id = flavour_celmaldor.13
	title = flavour_celmaldor.13.t
	desc = flavour_celmaldor.13.d
	picture = NAVAL_MILITARY_eventPicture

	is_triggered_only = yes 
	fire_only_once = yes

	option = {
		name = flavour_celmaldor.13.a
		ai_chance = {
			factor = 1
		}
		set_country_flag = z22_flagship_mods
		add_country_modifier = {
			name = z22_flagships
			duration = -1
		}
		create_flagship_with_modifications = {
			name = "Nur Galsheáh"
			type = heavy_ship
		}
		clr_country_flag = z22_flagship_mods
	}
}

country_event = {
	id = flavour_celmaldor.14
	title = flavour_celmaldor.14.t
	desc = flavour_celmaldor.14.d
	picture = DIPLOMACY_eventPicture

	is_triggered_only = yes

	major = yes 

	option = {
		name = flavour_celmaldor.14.a
		ai_chance = {
			factor = 9
		}
		remove_rival = Z22
		remove_historical_rival = Z22
		add_opinion = {
			who = Z22
			modifier = z22_storvic_returned
		}
		if = {
			limit = {
				has_opinion_modifier = {
					who = FROM
					modifier = scornfully_insulted
				}
			}
			remove_opinion = {
				who = FROM
				modifier = scornfully_insulted
			}
		}
		if = {
			limit = {
				has_opinion_modifier = {
					who = FROM
					modifier = insulted
				}
			}
			remove_opinion = {
				who = FROM
				modifier = insulted
			}
		}
		Z22 = {
			remove_rival = PREV
			remove_historical_rival = PREV
			add_opinion = {
				who = PREV
				modifier = z22_storvic_returned
			}
			if = {
				limit = {
					has_opinion_modifier = {
						who = ROOT
						modifier = scornfully_insulted
					}
				}
				remove_opinion = {
					who = ROOT
					modifier = scornfully_insulted
				}
			}
			if = {
				limit = {
					has_opinion_modifier = {
						who = ROOT
						modifier = insulted
					}
				}
				remove_opinion = {
					who = ROOT
					modifier = insulted
				}
			}
			add_trust = {
				who = ROOT
				value = 40
				mutual = yes
			}
		}
		create_alliance = Z22
		set_country_flag = z22_is_permanent_giesadh
		z22_make_giesadh_effect = yes
	}

	option = {
		name = flavour_celmaldor.14.b
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				is_rival = Z22
			}
			modifier = {
				factor = 2
				NOT = {
					has_opinion = {
						who = Z22
						value = 100
					}
				}
			}
		}
		capital_scope = {
			add_permanent_claim = Z22
		}
		every_known_country = {
			limit = {
				culture = blue_reachman
			}
			add_opinion = {
				who = ROOT
				modifier = z22_denied_league_unification
			}
		}
	}
}

#Welcome to the Reach
country_event = {
	id = flavour_celmaldor.15
	title = flavour_celmaldor.15.t
	desc = flavour_celmaldor.15.d
	picture = CITY_VIEW_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.15.a
		ai_chance = {
			factor = 1
		}
		add_country_modifier = {
			name = z22_welcome_reach
			duration = -1
		}
	}
}


#investments in freedom
country_event = {
	id = flavour_celmaldor.16
	title = flavour_celmaldor.16.t
	desc = flavour_celmaldor.16.d
	picture = SCOTTISH_MERCENARIES_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			capital_scope = {
				spawn_rebels = {
					size = 5
					type = westmoors_clans
					should_take_capital = yes
					friend = FROM 
				}
				spawn_rebels = {
					size = 5
					type = westmoors_clans
					should_take_capital = yes
					friend = FROM 
				}
			}
			if = {
				limit = {
					any_owned_province = {
						has_fort_building_trigger = yes
					}
				}
				random_owned_province = {
					limit = {
						has_fort_building_trigger = yes
					}
					spawn_rebels = {
						size = 5
						type = westmoors_clans
						should_take_capital = yes
						friend = FROM 
						win = yes
					}
					spawn_rebels = {
						size = 5
						type = westmoors_clans
						should_take_capital = yes
						friend = FROM 
						win = yes
					}
				}
			}
			else = {
				random_owned_province = {
					spawn_rebels = {
						size = 5
						type = westmoors_clans
						should_take_capital = yes
						friend = FROM 
						win = yes
					}
					spawn_rebels = {
						size = 5
						type = westmoors_clans
						should_take_capital = yes
						friend = FROM 
						win = yes
					}
				}
			}
			random_owned_province = {
				spawn_rebels = {
					size = 5
					type = westmoors_clans
					should_take_capital = yes
					friend = FROM 
					win = yes
				}
				spawn_rebels = {
					size = 5
					type = westmoors_clans
					should_take_capital = yes
					friend = FROM 
					win = yes
				}
			}
			
			set_country_flag = westmoors_pretender_rebels
			add_country_modifier = {
				name = z22_westmoor_rebel_consort
				duration = 7300
			}
		}
	}

	option = {
		name = flavour_celmaldor.16.a
		ai_chance = {
			factor = 1
		}
		tooltip = {
			capital_scope = {
				spawn_rebels = {
					size = 5
					type = westmoors_clans
					should_take_capital = yes
					friend = FROM 
				}
			}
			set_country_flag = westmoors_pretender_rebels
			add_country_modifier = {
				name = z22_westmoor_rebel_consort
				duration = 7300
			}
		}
		A13 = {
			add_spy_network_from = {
				who = FROM
				value = 30
			}
		}
		FROM = {
			add_country_modifier = {
				name = z22_westmoors_rebel_support
				duration = 3650
			}
		}
	}
}

#northern cities develop
country_event = {
	id = flavour_celmaldor.17
	title = flavour_celmaldor.17.t
	desc = flavour_celmaldor.17.d
	picture = CITY_DEVELOPMENT_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.17.a
		ai_chance = {
			factor = 1
		}
		965 = {
			add_province_modifier = {
				name = z22_northern_city_development
				duration = -1
			}
		}
		959 = {
			add_province_modifier = {
				name = z22_northern_city_development
				duration = -1
			}
		}
		995 = {
			add_province_modifier = {
				name = z22_northern_city_development
				duration = -1
			}
		}
		975 = {
			add_province_modifier = {
				name = z22_northern_city_development
				duration = -1
			}
		}
		978 = {
			add_province_modifier = {
				name = z22_northern_city_development
				duration = -1
			}
		}
		982 = {
			add_province_modifier = {
				name = z22_northern_city_development
				duration = -1
			}
		}
		6271 = {
			add_province_modifier = {
				name = z22_northern_city_development
				duration = -1
			}
		}
		984 = {
			add_province_modifier = {
				name = z22_northern_city_development
				duration = -1
			}
		}
		966 = {
			add_province_modifier = {
				name = z22_northern_city_development
				duration = -1
			}
		}
	}
}

#The Model Modern Elf
country_event = {
	id = flavour_celmaldor.18
	title = flavour_celmaldor.18.t
	desc = flavour_celmaldor.18.d
	picture = wihgfx_FEMALE_SCHOLAR_eventPicture

	is_triggered_only = yes 

	option = {
		name = flavour_celmaldor.18.a
		ai_chance = {
			factor = 1
		}
		define_advisor = {
			type = natural_scientist
			female = yes
			culture = moon_elf
			religion = ROOT
			skill = 3
			cost_multiplier = 0.25
			name = "Elanaria 'Scopes' Brightanchor"
			location = 696
		}
		custom_tooltip = z22_unlock_random_tier2_eco_invention_tt
		hidden_effect = {
			random_list = {
				1 = {
					trigger = {
						NOT = {
							OR = {
								has_country_flag = research_artifice_invention_growth_beans
								has_country_flag = unlocked_artifice_invention_growth_beans
							}
						}
					}
					set_country_flag = unlocked_artifice_invention_growth_beans
				}
				1 = {
					trigger = {
						NOT = {
							OR = {
								has_country_flag = research_artifice_invention_vendorless_stall
								has_country_flag = unlocked_artifice_invention_vendorless_stall
							}
						}
					}
					set_country_flag = unlocked_artifice_invention_vendorless_stall
				}
				1 = {
					trigger = {
						NOT = {
							OR = {
								has_country_flag = research_artifice_invention_brass_prosthesis
								has_country_flag = unlocked_artifice_invention_brass_prosthesis
							}
						}
					}
					set_country_flag = unlocked_artifice_invention_brass_prosthesis
				}
				1 = {
					trigger = {
						NOT = {
							OR = {
								has_country_flag = research_artifice_invention_gene_food_cultivation
								has_country_flag = unlocked_artifice_invention_gene_food_cultivation
							}
						}
					}
					set_country_flag = unlocked_artifice_invention_gene_food_cultivation
				}
				1 = {
					trigger = {
						NOT = {
							OR = {
								has_country_flag = research_artifice_invention_subterrenes
								has_country_flag = unlocked_artifice_invention_subterrenes
							}
						}
					}
					set_country_flag = unlocked_artifice_invention_subterrenes
				}
			}
		}
	}
}

#Crovis invasion
country_event = {
	id = flavour_celmaldor.19
	title = flavour_celmaldor.19.t
	desc = flavour_celmaldor.19.d
	picture = BATTLE_VISTULA_LAGOON_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.19.a
		ai_chance = {
			factor = 1
		}
		Z18 = {
			add_opinion = {
				who = ROOT
				modifier = z22_against_adshaws
			}
			reverse_add_opinion = {
				who = ROOT
				modifier = z22_against_adshaws
			}
			remove_rival = ROOT
			ROOT = {
				remove_rival = PREV
			}
			add_trust = {
				who = ROOT
				value = 15
				mutual = yes
			}
			create_alliance = ROOT
			add_country_modifier = {
				name = z22_gray_alliance
				duration = -1
			}
		}
		add_country_modifier = {
			name = z22_gray_alliance
			duration = -1
		}
		every_known_country = {
			limit = {
				OR = {
					culture = blue_reachman
					culture = white_reachman
				}
			}
			add_opinion = {
				who = ROOT
				modifier = z22_orcish_aligned
			}
		}
		join_all_offensive_wars_of = Z18
	}

	option = {
		name = flavour_celmaldor.19.b
		ai_chance = {
			factor = 1
		}
		717 = {
			add_permanent_claim = ROOT
		}
		718 = {
			add_permanent_claim = ROOT
		}
	}
}

country_event = {
	id = flavour_celmaldor.20
	title = flavour_celmaldor.20.t
	desc = flavour_celmaldor.20.d
	picture = HARBOUR_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			717 = {
				cede_province = Z27 
			}
		}
	}

	option = {
		name = flavour_celmaldor.20.a
		ai_chance = {
			factor = 1
		}
		Z27 = {
			add_opinion = {
				who = ROOT
				modifier = z22_cedevik_deal
			}
			reverse_add_opinion = {
				who = ROOT
				modifier = z22_cedevik_deal
			}
			add_trust = {
				who = ROOT
				value = 25
				mutual = yes
			}
		}
	}
}

#whitespear whaling
country_event = {
	id = flavour_celmaldor.21
	title = flavour_celmaldor.21.t
	desc = flavour_celmaldor.21.d
	picture = HARBOUR_eventPicture

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.21.a
		ai_chance = {
			factor = 1
		}
		custom_tooltip = z22_whitespear_whaling_unlock_tt
		set_country_flag = z22_whitespear_whaling_flag
	}
}

#the aging rudder
country_event = {
	id = flavour_celmaldor.22
	title = flavour_celmaldor.22.t
	desc = flavour_celmaldor.22.d
	picture = RUNESTONE_eventPicture

	is_triggered_only = yes

	trigger = {
		has_ruler_flag = ruler_is_taelar_icewind
	}

	option = {
		name = flavour_celmaldor.22.a
		ai_chance = {
			factor = 1
		}
		change_mil = 1
		define_general = {
			shock = 4
			fire = 0
			manuever = 3
			siege = 2
		}
	}
	
	option = {
		name = flavour_celmaldor.22.b
		ai_chance = {
			factor = 1
		}
		add_ruler_modifier = {
			name = z22_caution_of_taelar
		}
	}
}


#random artificer invention unlock
country_event = {
	id = flavour_celmaldor.69
	title = flavour_celmaldor.69.t
	desc = flavour_celmaldor.69.d
	picture = NORTH_SEA_MAPS_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		has_estate_privilege = z22_steady_iteration_privilege
	}

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.69.a
		ai_chance = {
			factor = 10
		}
		artifice_unlock_random_invention_effect = yes
	}
}

#check thing for random unlock
country_event = {
	id = flavour_celmaldor.70
	title = flavour_celmaldor.70.t
	desc = flavour_celmaldor.70.d
	picture = NORTH_SEA_MAPS_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		has_estate_privilege = z22_steady_iteration_privilege
	}

	is_triggered_only = yes
	hidden = yes

	option = {
		name = flavour_celmaldor.70.a
		ai_chance = {
			factor = 3
			modifier = {
				factor = 1.1
				check_variable = {
					MaldorPassiveResearch = 1
				}
			}
			modifier = {
				factor = 1.1
				check_variable = {
					MaldorPassiveResearch = 2
				}
			}
			modifier = {
				factor = 1.1
				check_variable = {
					MaldorPassiveResearch = 3
				}
			}
			modifier = {
				factor = 1.1
				check_variable = {
					MaldorPassiveResearch = 4
				}
			}
			modifier = {
				factor = 1.1
				check_variable = {
					MaldorPassiveResearch = 5
				}
			}
		}
		country_event = {
			id = flavour_celmaldor.69
			days = 50
			random = 50
		}
		set_variable = {
			which = MaldorPassiveResearch
			value = 0
		}
	}

	option = {
		name = flavour_celmaldor.70.b
		ai_chance = {
			factor = 9
		}
		change_variable = {
			which = MaldorPassiveResearch
			value = 1
		}
	}
}

#trade league investment event
country_event = {
	id = flavour_celmaldor.71
	title = flavour_celmaldor.71.t
	desc = flavour_celmaldor.71.d
	picture = CITY_DEVELOPMENT_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
	}

	# immediate = {
	# 	random_known_country = {
	# 		limit = {
	# 			any_owned_province = {
	# 				has_province_flag = z22_investment_province_chosen
	# 			}
	# 		}
	# 		random_owned_province = {
	# 			limit = {
	# 				has_province_flag = z22_investment_province_chosen
	# 			}
	# 			save_event_target_as = z22_investment_province_target
	# 		}
	# 	}
	# }

	is_triggered_only = yes

	option = {	#trade building
		name = flavour_celmaldor.71.a
		trigger = {
			event_target:z22_investment_province_target = {
				NOT = {
					has_trade_building_trigger = yes
				}
			}
		}
		ai_chance = {
			factor = 70
		}
		if = {
			limit = {
				mission_completed = z22_greatwoods_timber
				has_cast_aid_construction = yes
			}
			add_treasury = -50
			event_target:z22_investment_province_target = {
				add_latest_building_construction = {
					trade = yes 
					builder = PREV
					speed = 0.3
					cost = 0
				}
				owner = {
					add_opinion = {
						who = ROOT
						modifier = z22_invested_in_league
					}
				}
			}
		}
		else_if = {
			limit = {
				mission_completed = z22_greatwoods_timber
			}
			add_treasury = -75
			event_target:z22_investment_province_target = {
				add_latest_building_construction = {
					trade = yes 
					builder = PREV
					speed = 0.5
					cost = 0
				}
				owner = {
					add_opinion = {
						who = ROOT
						modifier = z22_invested_in_league
					}
				}
			}
		}
		else = {
			add_treasury = -100
			event_target:z22_investment_province_target = {
				add_latest_building_construction = {
					trade = yes 
					builder = PREV
					speed = 0.5
					cost = 0
				}
				owner = {
					add_opinion = {
						who = ROOT
						modifier = z22_invested_in_league
					}
				}
			}
		}
	}

	option = {	#production building
		name = flavour_celmaldor.71.b
		trigger = {
			event_target:z22_investment_province_target = {
				NOT = {
					has_production_building_trigger = yes
				}
			}
		}
		ai_chance = {
			factor = 70
		}
		if = {
			limit = {
				mission_completed = z22_greatwoods_timber
				has_cast_aid_construction = yes
			}
			add_treasury = -50
			event_target:z22_investment_province_target = {
				add_latest_building_construction = {
					production = yes 
					builder = PREV
					speed = 0.3
					cost = 0
				}
				owner = {
					add_opinion = {
						who = ROOT
						modifier = z22_invested_in_league
					}
				}
			}
		}
		else_if = {
			limit = {
				mission_completed = z22_greatwoods_timber
			}
			add_treasury = -75
			event_target:z22_investment_province_target = {
				add_latest_building_construction = {
					production = yes 
					builder = PREV
					speed = 0.5
					cost = 0
				}
				owner = {
					add_opinion = {
						who = ROOT
						modifier = z22_invested_in_league
					}
				}
			}
		}
		else = {
			add_treasury = -100
			event_target:z22_investment_province_target = {
				add_latest_building_construction = {
					production = yes 
					builder = PREV
					speed = 0.5
					cost = 0
				}
				owner = {
					add_opinion = {
						who = ROOT
						modifier = z22_invested_in_league
					}
				}
			}
		}
	}

	option = {	#coastal defense building
		name = flavour_celmaldor.71.c
		trigger = {
			event_target:z22_investment_province_target = {
				NOT = {
					has_coast_defense_building_trigger = yes
				}
			}
		}
		ai_chance = {
			factor = 70
		}
		if = {
			limit = {
				mission_completed = z22_greatwoods_timber
				has_cast_aid_construction = yes
			}
			add_treasury = -25
			event_target:z22_investment_province_target = {
				add_latest_building_construction = {
					coastal = yes 
					builder = PREV
					speed = 0.3
					cost = 0
				}
				owner = {
					add_opinion = {
						who = ROOT
						modifier = z22_invested_in_league
					}
				}
			}
		}
		else_if = {
			limit = {
				mission_completed = z22_greatwoods_timber
			}
			add_treasury = -50
			event_target:z22_investment_province_target = {
				add_latest_building_construction = {
					coastal = yes 
					builder = PREV
					speed = 0.5
					cost = 0
				}
				owner = {
					add_opinion = {
						who = ROOT
						modifier = z22_invested_in_league
					}
				}
			}
		}
		else = {
			add_treasury = -75
			event_target:z22_investment_province_target = {
				add_latest_building_construction = {
					coastal = yes 
					builder = PREV
					speed = 0.5
					cost = 0
				}
				owner = {
					add_opinion = {
						who = ROOT
						modifier = z22_invested_in_league
					}
				}
			}
		}
	}

	option = {
		name = flavour_celmaldor.71.e
		ai_chance = {
			factor = 0
		}
	}

	after = {
		clr_global_flag = z22_in_investment_screen
	}
}

#####

#Clan flavour events

#controller
country_event = {
	id = flavour_celmaldor.100
	title = flavour_celmaldor.100.t
	desc = flavour_celmaldor.100.d
	picture = NORTH_SEA_MAPS_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
	}

	hidden = yes

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.100.a
		ai_chance = {
			factor = 1
		}

		country_event = {
			id = flavour_celmaldor.70	#random invention check pulse event
		}

		random_list = {
			10 = {
				country_event = {
					id = flavour_celmaldor.101
					days = 10
				}
			}
			10 = {
				trigger = {
					has_idea_group = exploration_ideas
				}
				country_event = {
					id = flavour_celmaldor.102
					days = 10
				}
			}
			10 = {
				trigger = {
					mission_completed = z22_curtail_clans
				}
				country_event = {
					id = flavour_celmaldor.103
					days = 10
				}
			}
			10 = {
				country_event = {
					id = flavour_celmaldor.104
					days = 10
				}
			}
			10 = {
				country_event = {
					id = flavour_celmaldor.105
					days = 10
				}
			}
			10 = {
				country_event = {
					id = flavour_celmaldor.106
					days = 10
				}
			}
			10 = {
				trigger = {
					mission_completed = z22_silver_league
				}
				country_event = {
					id = flavour_celmaldor.107
					days = 10
				}
			}
			10 = {
				trigger = {
					has_reform = z22_skaldol_treaty_of_faiths
				}
				country_event = {
					id = flavour_celmaldor.108
					days = 10
				}
			}
			10 = {
				trigger = {
					NOT = {
						mission_completed = z22_amend_act
					}
				}
				country_event = {
					id = flavour_celmaldor.109
					days = 10
				}
			}
			10 = {
				trigger = {
					mission_completed = z22_amend_act
				}
				country_event = {
					id = flavour_celmaldor.110
					days = 10
				}
			}
			10 = {
				modifier = {
					factor = 3
					NOT = {
						has_estate_privilege = z22_commercial_tongue_privilege
					}
				}
				trigger = {
					mission_completed = z22_amend_act
				}
				country_event = {
					id = flavour_celmaldor.111
					days = 10
				}
			}
			10 = {
				trigger = {
					has_estate_privilege = z22_commercial_tongue_privilege
				}
				country_event = {
					id = flavour_celmaldor.112
					days = 10
				}
			}
			10 = {
				trigger = {
					mission_completed = z22_united_magnates
				}
				country_event = {
					id = flavour_celmaldor.113
					days = 10
				}
			}
			10 = {
				trigger = {
					any_owned_province = {
						is_colony = yes
					}
				}
				country_event = {
					id = flavour_celmaldor.114
					days = 10
				}
			}
			10 = {
				country_event = {
					id = flavour_celmaldor.115
					days = 10
				}
			}
			10 = {
				trigger = {
					OR = {
						has_ruler_flag = ruler_is_non_clan
						mission_completed = z22_rights_of_man
					}
				}
				country_event = {
					id = flavour_celmaldor.116
					days = 10
				}
			}
			10 = {
				trigger = {
					mission_completed = z22_third_act
				}
				country_event = {
					id = flavour_celmaldor.117
					days = 10
				}
			}
			10 = {
				trigger = {
					had_country_flag = {
						flag = z22_commercial_tongue_flag
						days = 10950
					}
				}
				country_event = {
					id = flavour_celmaldor.118
					days = 10
				}
			}
			10 = {
				country_event = {
					id = flavour_celmaldor.119
					days = 10
				}
			}
			10 = {
				trigger = {
					has_estate = estate_artificers
				}
				country_event = {
					id = flavour_celmaldor.120
					days = 10
				}
			}
			10 = {
				
			}
		}
	}
}

#The Reckless Family
country_event = {
	id = flavour_celmaldor.101
	title = flavour_celmaldor.101.t
	desc = flavour_celmaldor.101.d
	picture = NOBLE_ESTATE_DEMANDS_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
	}

	immediate = {
		hidden_effect = {
			random_neighbor_country = {
				save_event_target_as = z22_offended_neighbour
			}
		}
	}

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.101.a
		ai_chance = {
			factor = 1
		}
		add_prestige = 10
		event_target:z22_offended_neighbour = {
			add_opinion = {
				who = ROOT
				modifier = z22_whitespear_offended_neighbour
			}
		}
		add_faction_influence = {
			faction = whitespear_clan
			influence = 10
		}
	}

	option = {
		name = flavour_celmaldor.101.b
		ai_chance = {
			factor = 1
		}
		add_prestige = -10
		event_target:z22_offended_neighbour = {
			add_opinion = {
				who = ROOT
				modifier = z22_whitespear_appeased_neighbour
			}
		}
		add_faction_influence = {
			faction = whitespear_clan
			influence = -10
		}
	}
}

#calls to adventure
country_event = {
	id = flavour_celmaldor.102
	title = flavour_celmaldor.102.t
	desc = flavour_celmaldor.102.d
	picture = EXPLORERS_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		has_idea_group = exploration_ideas
	}

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.102.a
		ai_chance = {
			factor = 1
		}
		create_explorer = {
			tradition = 40
		}
		add_faction_influence = {
			faction = whitespear_clan
			influence = 10
		}
	}

	option = {
		name = flavour_celmaldor.102.b
		ai_chance = {
			factor = 1
		}
		create_conquistador = {
			tradition = 40
		}
		add_faction_influence = {
			faction = whitespear_clan
			influence = 10
		}
	}

	option = {
		name = flavour_celmaldor.102.c
		ai_chance = {
			factor = 1
		}
		add_faction_influence = {
			faction = whitespear_clan
			influence = -5
		}
		add_prestige = -5
	}
}

#inspiring leaders
country_event = {
	id = flavour_celmaldor.103
	title = flavour_celmaldor.103.t
	desc = flavour_celmaldor.103.d
	picture = DISCIPLINED_SOLDIERS_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		mission_completed = z22_curtail_clans
	}

	is_triggered_only = yes

	immediate = {
		z22_define_acting_clan = yes
	}

	option = {
		name = flavour_celmaldor.103.a
		ai_chance = {
			factor = 1
		}
		add_yearly_manpower = 1
		z22_give_clan_influence = yes
	}

	option = {
		name = flavour_celmaldor.103.b
		ai_chance = {
			factor = 1
		}
		add_prestige = 5
	}

	after = {
		z22_clr_event_flags = yes
	}
}

#silver tongued ice
country_event = {
	id = flavour_celmaldor.104
	title = flavour_celmaldor.104.t
	desc = flavour_celmaldor.104.d
	picture = DIPLOMACY_SIGNING_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
	}

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.104.a
		ai_chance = {
			factor = 1
		}
		random_active_trade_node = {
			add_trade_modifier = {
				who = ROOT
				duration = 7300
				power = 10
				key = z22_icewind_connection
			}
		}
		add_faction_influence = {
			faction = icewind_clan
			influence = 10
		}
	}

	option = {
		name = flavour_celmaldor.104.b
		ai_chance = {
			factor = 1
		}
		add_faction_influence = {
			faction = icewind_clan
			influence = -10
		}
	}
}

#discerning eye
country_event = {
	id = flavour_celmaldor.105
	title = flavour_celmaldor.105.t
	desc = flavour_celmaldor.105.d
	picture = CORRUPTION_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
	}

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.105.a
		ai_chance = {
			factor = 1
		}
		add_corruption = -1
		add_faction_influence = {
			faction = frozentide_clan
			influence = 10
		}
	}

	option = {
		name = flavour_celmaldor.105.b
		ai_chance = {
			factor = 1
		}
		add_corruption = 0.5
		random_owned_province = {
			add_province_modifier = {
				name = z22_ignored_corruption
				duration = 3650
			}
		}
	}
}

#wealth of centuries
country_event = {
	id = flavour_celmaldor.106
	title = flavour_celmaldor.106.t
	desc = flavour_celmaldor.106.d
	picture = FEAST_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
	}

	is_triggered_only = yes

	immediate = {
		z22_define_acting_clan = yes
	}

	option = {
		name = flavour_celmaldor.106.a
		ai_chance = {
			factor = 1
		}
		if = {
			limit = {
				monthly_income = 8
			}
			add_years_of_income = 5
		}
		else = {
			add_treasury = 100
		}
		z22_give_clan_influence = yes
	}

	option = {
		name = flavour_celmaldor.106.b
		ai_chance = {
			factor = 1
		}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -10
		}
	}

	after = {
		z22_clr_event_flags = yes
	}
}

#eager investors
country_event = {
	id = flavour_celmaldor.107
	title = flavour_celmaldor.107.t
	desc = flavour_celmaldor.107.d
	picture = HARBOUR_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		mission_completed = z22_silver_league
	}

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.107.a
		ai_chance = {
			factor = 1
		}
		random_known_country = {
			limit = {
				OR = {
					is_subject_of = ROOT
					is_giesadh = yes
				}
				any_owned_province = {
					NOT = {
						has_trade_building_trigger = yes
					}
					num_free_building_slots = 1
				}
			}
			random_owned_province = {
				limit = {
					NOT = {
						has_trade_building_trigger = yes
					}
					num_free_building_slots = 1
				}
				add_building = marketplace
			}
			add_opinion = {
				who = ROOT
				modifier = z22_invested_in_league
			}
		}
		add_faction_influence = {
			faction = icewind_clan
			influence = 10
		}
	}

	option = {
		name = flavour_celmaldor.107.b
		ai_chance = {
			factor = 1
		}
		add_country_modifier = {
			name = z22_icewinds_upset
			duration = 3650
		}
		add_faction_influence = {
			faction = icewind_clan
			influence = -10
		}
	}
}

#scandalous conversion
country_event = {
	id = flavour_celmaldor.108
	title = flavour_celmaldor.108.t
	desc = flavour_celmaldor.108.d
	picture = PRAYING_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		has_reform = z22_skaldol_treaty_of_faiths
	}

	is_triggered_only = yes

	immediate = {
		z22_define_acting_clan = yes
	}

	option = {
		name = flavour_celmaldor.108.a
		ai_chance = {
			factor = 1
		}
		add_adm_power = -20
		z22_take_clan_influence = yes
		add_country_modifier = {
			name = z22_denied_conversion
			duration = 3650
		}
	}

	option = {
		name = flavour_celmaldor.108.b
		ai_chance = {
			factor = 1
		}
		add_estate_loyalty = {
			estate = estate_church
			loyalty = -10
		}
	}

	after = {
		z22_clr_event_flags = yes
	}
}

#worries of supremacism
country_event = {
	id = flavour_celmaldor.109
	title = flavour_celmaldor.109.t
	desc = flavour_celmaldor.109.d
	picture = BURGHER_ESTATE_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		NOT = {
			mission_completed = z22_amend_act
		}
	}

	is_triggered_only = yes

	immediate = {
		z22_define_acting_clan = yes
	}

	option = {
		name = flavour_celmaldor.109.a
		ai_chance = {
			factor = 1
		}
		random_owned_province = {
			spawn_rebels = {
				size = 1
				type = noble_rebels
			}
		}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -10
		}
	}

	option = {
		name = flavour_celmaldor.109.b
		ai_chance = {
			factor = 1
		}
		add_country_modifier = {
			name = z22_elf_supremacist_fears
			duration = 10950
		}
	}

	after = {
		z22_clr_event_flags = yes
	}
}

#language of trade
country_event = {
	id = flavour_celmaldor.110
	title = flavour_celmaldor.110.t
	desc = flavour_celmaldor.110.d
	picture = MERCHANTS_TALKING_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		mission_completed = z22_amend_act
	}

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.110.a
		ai_chance = {
			factor = 1
		}
		add_stability_or_adm_power = yes
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = 10
		}
	}

	option = {
		name = flavour_celmaldor.110.b
		ai_chance = {
			factor = 1
		}
		reduce_stability_or_adm_power = yes
		add_estate_loyalty = {
			estate = estate_burghers
			loyalty = 15
		}
		every_owned_province = {
			limit = {
				NOT = {
					culture_is_elven = yes
				}
			}
			add_unrest = -10
		}
	}
}

#the language barrier
country_event = {
	id = flavour_celmaldor.111
	title = flavour_celmaldor.111.t
	desc = flavour_celmaldor.111.d
	picture = DIPLOMAT_INTERROGATION_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		mission_completed = z22_amend_act
	}

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.111.a
		ai_chance = {
			factor = 1
		}
		every_owned_province = {
			limit = {
				culture = blue_reachman
			}
			add_province_modifier = {
				name = z22_more_elven_lessons
				duration = 3650
			}
		}
	}

	option = {
		name = flavour_celmaldor.111.b
		ai_chance = {
			factor = 1
		}
		set_country_flag = z22_commercial_tongue_flag
		custom_tooltip = z22_unlock_commercial_tongue_privilege_tt
		set_estate_privilege = z22_commercial_tongue_privilege
	}
}

#alfrbrut
country_event = {
	id = flavour_celmaldor.112
	title = flavour_celmaldor.112.t
	desc = flavour_celmaldor.112.d
	picture = BURGHER_ESTATE_UPSET_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		has_estate_privilege = z22_commercial_tongue_privilege
	}

	is_triggered_only = yes

	option = {
		name = flavour_celmaldor.112.a
		ai_chance = {
			factor = 1
		}
		add_country_modifier = {
			name = z22_complaints_about_language
			duration = 3650
		}
	}

	option = {
		name = flavour_celmaldor.112.b
		ai_chance = {
			factor = 1
		}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -10
		}
		add_country_modifier = {
			name = z22_lowered_elven_standards
			duration = 3650
		}
	}
}

#magnate absorbtion
country_event = {
	id = flavour_celmaldor.113
	title = flavour_celmaldor.113.t
	desc = flavour_celmaldor.113.d
	picture = TRADE_GOODS_FURS_FISH_AND_SALT_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		mission_completed = z22_united_magnates
	}

	is_triggered_only = yes

	immediate = {
		z22_define_acting_clan = yes
	}

	option = {
		name = flavour_celmaldor.113.a
		ai_chance = {
			factor = 1
		}
		random_owned_province = {
			limit = {
				culture_group = alenic
			}
			add_base_production = 1
			add_province_modifier = {
				name = z22_magnates_and_clans
				duration = 3650
			}
		}
		z22_give_clan_influence = yes
	}

	option = {
		name = flavour_celmaldor.113.b
		ai_chance = {
			factor = 1
		}
		small_decrease_of_human_tolerance_effect = yes
		z22_take_clan_influence = yes
		add_prestige = -10
	}

	after = {
		z22_clr_event_flags = yes
	}
}

#clan colonial conflict
country_event = {
	id = flavour_celmaldor.114
	title = flavour_celmaldor.114.t
	desc = flavour_celmaldor.114.d
	picture = COLONIZATION_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		any_owned_province = {
			is_colony = yes
		}
	}

	is_triggered_only = yes

	immediate = {
		z22_define_acting_clan = yes

		z22_define_second_acting_clan = yes
		hidden_effect = {
			random_owned_province = {
				limit = {
					is_colony = yes
				}
				save_event_target_as = z22_clan_interaction_province
			}
		}
	}

	option = {
		name = flavour_celmaldor.114.a
		ai_chance = {
			factor = 1
		}
		z22_take_clan_influence = yes
		event_target:z22_clan_interaction_province = {
			add_colonysize = -100
			remove_random_development = yes 
		}
	}

	option = {
		name = flavour_celmaldor.114.b
		ai_chance = {
			factor = 1
		}
		z22_take_clan_influence2 = yes
		event_target:z22_clan_interaction_province = {
			add_colonysize = -100
			remove_random_development = yes 
		}
	}

	after = {
		z22_clr_event_flags = yes
	}
}

#pricely favouritism
country_event = {
	id = flavour_celmaldor.115
	title = flavour_celmaldor.115.t
	desc = flavour_celmaldor.115.d
	picture = GOOD_WITH_MONARCH_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		if = {
			limit = {
				has_ruler_flag = ruler_is_frozentide
			}
			faction_influence = {
				faction = frozentide_clan
				influence = 66
			}
		}
		else_if = {
			limit = {
				has_ruler_flag = ruler_is_icewind
			}
			faction_influence = {
				faction = icewind_clan
				influence = 66
			}
		}
		else_if = {
			limit = {
				has_ruler_flag = ruler_is_whitespear
			}
			faction_influence = {
				faction = whitespear_clan
				influence = 66
			}
		}
	}

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				faction_influence = {
					faction = frozentide_clan
					influence = 66
				}
			}
			set_country_flag = z22_frozentide_events
		}
		if = {
			limit = {
				faction_influence = {
					faction = whitespear_clan
					influence = 66
				}
			}
			set_country_flag = z22_icewind_events
		}
		if = {
			limit = {
				faction_influence = {
					faction = whitespear_clan
					influence = 66
				}
			}
			set_country_flag = z22_whitespear_events
		}
	}

	option = {
		name = flavour_celmaldor.115.a
		ai_chance = {
			factor = 1
		}
		z22_take_clan_influence = yes
		add_prestige = -10
		add_country_modifier = {
			name = z22_clan_favouritism_denied
			duration = 3650
		}
	}

	option = {
		name = flavour_celmaldor.115.b
		ai_chance = {
			factor = 1
		}
		z22_give_clan_influence = yes
		add_prestige = 10
		add_country_modifier = {
			name = z22_clan_favouritism
			duration = 3650
		}
	}

	after = {
		z22_clr_event_flags = yes
	}
}

#am I not your favourite
country_event = {
	id = flavour_celmaldor.116
	title = flavour_celmaldor.116.t
	desc = flavour_celmaldor.116.d
	picture = DIPLOMACY_SIGNING_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		OR = {
			has_ruler_flag = ruler_is_non_clan
			mission_completed = z22_rights_of_man
		}
	}

	is_triggered_only = yes

	immediate = {
		z22_define_acting_clan = yes
	}

	option = {
		name = flavour_celmaldor.116.a
		ai_chance = {
			factor = 1
		}
		add_prestige = 10
		add_dip_power = -30
		z22_take_clan_influence = yes
	}

	option = {
		name = flavour_celmaldor.116.b
		ai_chance = {
			factor = 1
		}
		add_prestige = -10
		add_dip_power = 30
		z22_give_clan_influence = yes
	}

	after = {
		z22_clr_event_flags = yes
	}
}

#clannish multiculturalism
country_event = {
	id = flavour_celmaldor.117
	title = flavour_celmaldor.117.t
	desc = flavour_celmaldor.117.d
	picture = CULTURE_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		mission_completed = z22_third_act
		z22_num_of_races_in_acts = {
			VAL = 5
		}
	}

	is_triggered_only = yes

	immediate = {
		z22_define_acting_clan = yes
	}

	option = {
		name = flavour_celmaldor.117.a
		ai_chance = {
			factor = 1
		}
		increase_all_tolerances = {
			size = small
		}
		z22_give_clan_influence = yes
	}

	option = {
		name = flavour_celmaldor.117.b
		ai_chance = {
			factor = 1
		}
		z22_take_clan_influence = yes
		add_adm_power = 100
	}

	after = {
		z22_clr_event_flags = yes
	}
}

#elventongued finefolks
country_event = {
	id = flavour_celmaldor.118
	title = flavour_celmaldor.118.t
	desc = flavour_celmaldor.118.d
	picture = NOBLE_ESTATE_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		had_country_flag = {
			flag = z22_commercial_tongue_flag
			days = 10950
		}
	}

	is_triggered_only = yes
	fire_only_once = yes

	immediate = {
		z22_define_acting_clan = yes
	}

	option = {
		name = flavour_celmaldor.118.a
		ai_chance = {
			factor = 1
		}
		add_prestige = 15
		add_country_modifier = {
			name = z22_elventongued_finefolks
			duration = 7300
		}
	}

	option = {
		name = flavour_celmaldor.118.b
		ai_chance = {
			factor = 1
		}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -10
		}
		add_country_modifier = {
			name = z22_lowered_elven_standards
			duration = 7300
		}
	}

	after = {
		z22_clr_event_flags = yes
	}
}

#clan magic patronage
country_event = {
	id = flavour_celmaldor.119
	title = flavour_celmaldor.119.t
	desc = flavour_celmaldor.119.d
	picture = MAGES_ESTATE_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
	}

	is_triggered_only = yes

	immediate = {
		z22_define_acting_clan = yes
	}

	option = {
		name = flavour_celmaldor.119.a
		ai_chance = {
			factor = 1
		}
		define_advisor = {
			type = court_mage
			cost_multiplier = 0.25
		}
		z22_give_clan_influence = yes
	}

	option = {
		name = flavour_celmaldor.119.b
		ai_chance = {
			factor = 1
		}
		add_country_modifier = {
			name = z22_declined_advisors
			duration = 3650
		}
		z22_take_clan_influence = yes
	}

	after = {
		z22_clr_event_flags = yes
	}
}

#tinkers and tinkerers
country_event = {
	id = flavour_celmaldor.120
	title = flavour_celmaldor.120.t
	desc = flavour_celmaldor.120.d
	picture = ARTIFICE_GEAR_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		has_estate = estate_artificers
	}

	is_triggered_only = yes

	immediate = {
		z22_define_acting_clan = yes
	}

	option = {
		name = flavour_celmaldor.120.a
		ai_chance = {
			factor = 1
		}
		z22_give_clan_influence = yes
		add_estate_loyalty = {
			estate = estate_artificers
			loyalty = 10
		}
	}

	option = {
		name = flavour_celmaldor.120.b
		ai_chance = {
			factor = 1
		}
		z22_take_clan_influence = yes
		add_estate_loyalty = {
			estate = estate_artificers
			loyalty = -10
		}
	}

	after = {
		z22_clr_event_flags = yes
	}
}


####


#Election 1
country_event = {
	id = flavour_celmaldor.700
	title = flavour_celmaldor.700.t
	desc = flavour_celmaldor.700.d
	picture = ELECTION_REPUBLICAN_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		NOT = {
			mission_completed = z22_rights_of_man
		}
	}
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			pre_select_possible_ruler_focus = yes
			if = {
				limit = { has_government_attribute = has_limited_terms }
				export_to_variable = {
					which = max_election_term
					value = modifier:max_terms
				}
			}

			z22_prince_elect_set_random_character = yes
		}
	}

	after = {
		post_ruler_focus_clearance = yes
	}

	option = {
		name = flavour_celmaldor.700.a # Current ruler stays
		trigger = {
			has_regency = no
			NOT = { 
				has_ruler_flag = leader_has_been_pushed_out
			}
			OR = {
				NOT = { has_government_attribute = has_limited_terms }
				check_variable = {
					which = max_election_term
					which = election_term
				}
			}
		}
		ai_chance = { 
			factor = 60
			modifier = {
				factor = 0
				NOT = { republican_tradition = 25 }
			}	
			modifier = {
				factor = 0.5
				NOT = { republican_tradition = 50 }
			}				
			modifier = {
				factor = 0.5
				NOT = { republican_tradition = 75 }
			}	
			modifier = {
				factor = 2.0
				republican_tradition = 90
			}		
			
			#Anbennar
			modifier = {
				factor = 2.0
				ruler_is_powerful_mage = yes
			}	
			modifier = {
				factor = 100.0
				OR = {
					ruler_has_personality = great_conqueror_personality
					ruler_has_personality = mythical_conqueror_personality
				}
			}
		}
		custom_tooltip = remains_ruler
		if = {
			limit = { has_government_attribute = has_limited_terms }
			custom_tooltip = current_term_tt
		}
		change_adm = 1
		change_dip = 1
		change_mil = 1
		if = {
			limit = {
				NOT = { republican_tradition = 20 }
				has_dlc = "Res Publica"
			}
			add_government_reform = presidential_despot_reform	
		}
		if = {
			limit = {
				NOT = { republican_tradition = 20 }
				NOT = { has_dlc = "Res Publica" }
			}
			change_government = monarchy
			#set_legacy_government = despotic_monarchy
		}
		else = {
			if = {
				limit = {
					has_country_flag = increased_election_cost
				}
				add_scaled_republican_tradition = -10
				clr_country_flag = increased_election_cost
			}
			else = {
				add_scaled_republican_tradition = -6
			}
		}
		random_list = {
			10 = {
				add_adm_power = 50
			}
			10 = {
				add_dip_power = 50
			}
			10 = {
				add_mil_power = 50
			}
		}
		if = {
			limit = {
				has_government_attribute = reelection_depowers_estates
			}
			add_estate_influence_modifier = {
				estate = all
				influence = -10
				duration = 1460
				desc = REELCTION_DEPOWER_ESTATES
			}
		}
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_estate_loyalty = {
				estate = all
				loyalty = 5
			}
		}
		if = {
			limit = { has_government_attribute = reelection_increases_absolutism }
			tooltip = {
				add_absolutism = 10
			}
			custom_tooltip = ADD_ABSOLUTISM_BASED_ON_ELECTION_TERM
			hidden_effect = {
				for_variable_amount = {
					variable = election_term
					effect = "
						add_absolutism = 10
					"
				}
			}
			hidden_effect = {
				change_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_random_faction = {
				influence = 20
			}
		}
		add_karma = -5
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				change_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = {
				has_country_flag = z22_influence_from_reelection
			}
			if = {
				limit = { has_ruler_flag = ruler_is_frozentide NOT = { has_estate_influence_modifier = { estate = estate_nobles modifier = EST_VAL_Z22_RECENT_REELECTION } } }
				add_faction_influence = {
					faction = frozentide_clan
					influence = 10
				}
				add_estate_influence_modifier = {
					estate = estate_nobles
					desc = EST_VAL_Z22_RECENT_REELECTION
					influence = -10
					duration = 3650
				}
			}
			else_if = {
				limit = { has_ruler_flag = ruler_is_icewind NOT = { has_estate_influence_modifier = { estate = estate_nobles modifier = EST_VAL_Z22_RECENT_REELECTION } } }
				add_faction_influence = {
					faction = icewind_clan
					influence = 10
				}
				add_estate_influence_modifier = {
					estate = estate_nobles
					desc = EST_VAL_Z22_RECENT_REELECTION
					influence = -10
					duration = 3650
				}
			}
			else_if = {
				limit = { has_ruler_flag = ruler_is_whitespear NOT = { has_estate_influence_modifier = { estate = estate_nobles modifier = EST_VAL_Z22_RECENT_REELECTION } } }
				add_faction_influence = {
					faction = whitespear_clan
					influence = 10
				}
				add_estate_influence_modifier = {
					estate = estate_nobles
					desc = EST_VAL_Z22_RECENT_REELECTION
					influence = -10
					duration = 3650
				}
			}
		}
	}
	option = {
		name = flavour_celmaldor.700.b #The candidate of Clan Frozentide
		ai_chance = { factor = 20 }
		trigger = {
			NOT = {
				AND = {
					ai = yes
					OR = {
						ruler_has_personality = mythical_conqueror_personality
						ruler_has_personality = great_conqueror_personality
					}
				}
				z22_ruler_is_frozentide = yes
			}
		}
		define_ruler = {
			min_age = 250
			max_age = 400
			change_adm = 2
			change_dip = -1
			change_mil = -1
			dynasty = "Frozentide"
		}
		hidden_effect = {
			set_ruler_flag = ruler_is_frozentide
			set_ruler_flag = long_lived_ruler
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_adm_faction = {
				influence = 20
			}
		}
		add_karma = 10
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_estate_loyalty_by_class_adm = {
				loyalty = 10
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = adm
			}
		}
	}
	option = {
		name = flavour_celmaldor.700.c #an Icewind candidate
		trigger = {
			NOT = {
				AND = {
					ai = yes
					OR = {
						ruler_has_personality = mythical_conqueror_personality
						ruler_has_personality = great_conqueror_personality
					}
				}
				z22_ruler_is_icewind = yes
			}
		}
		ai_chance = { factor = 20 }
		define_ruler = {
			min_age = 250
			max_age = 400
			change_adm = -1
			change_dip = 2
			change_mil = -1
			dynasty = "Icewind"
			random_gender = yes
		}
		hidden_effect = {
			set_ruler_flag = ruler_is_icewind
			set_ruler_flag = long_lived_ruler
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_dip_faction = {
				influence = 20
			}
		}
		add_karma = 10
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_estate_loyalty_by_class_dip = {
				loyalty = 10
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = dip
			}
		}
	}
	option = {
		name = flavour_celmaldor.700.e	#a whitespear candidate
		ai_chance = { factor = 20 }
		trigger = {
			NOT = {
				AND = {
					ai = yes
					OR = {
						ruler_has_personality = mythical_conqueror_personality
						ruler_has_personality = great_conqueror_personality
					}
				}
				z22_ruler_is_whitespear = yes
			}
		}
		define_ruler = {
			min_age = 250
			max_age = 400
			change_adm = -1
			change_dip = -1
			change_mil = 2
			dynasty = "Whitespear"
			random_gender = yes
		}
		hidden_effect = {
			set_ruler_flag = ruler_is_whitespear
			set_ruler_flag = long_lived_ruler
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_mil_faction = {
				influence = 20
			}
		}
		add_karma = 10
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_estate_loyalty_by_class_mil = {
				loyalty = 10
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = mil
			}
		}
	}
	option = {
		name = flavour_celmaldor.700.f #random non clan candidate
		ai_chance = { factor = 20 }
		trigger = {
			NOT = {
				AND = {
					ai = yes
					OR = {
						ruler_has_personality = mythical_conqueror_personality
						ruler_has_personality = great_conqueror_personality
					}
				}
			}
		}
		
		custom_tooltip = z22_random_candidate
		if = {
			limit = {
				has_country_flag = z22_adm_candidate
			}
			define_ruler = {
				change_adm = 1
				random_gender = yes
				culture = event_target:z22_candidate_origin_province
				religion = event_target:z22_candidate_origin_province
			}
		}
		else_if = {
			limit = {
				has_country_flag = z22_dip_candidate
			}
			define_ruler = {
				change_dip = 1
				random_gender = yes
				culture = event_target:z22_candidate_origin_province
				religion = event_target:z22_candidate_origin_province
			}
		}
		else = {
			define_ruler = {
				change_mil = 1
				random_gender = yes
				culture = event_target:z22_candidate_origin_province
				religion = event_target:z22_candidate_origin_province
			}
		}

		hidden_effect = {
			set_ruler_flag = ruler_is_non_clan
			clr_country_flag = z22_adm_candidate
			clr_country_flag = z22_dip_candidate
			clr_country_flag = z22_mil_candidate
		}
		add_karma = 10
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_random_estate_loyalty = {
				amount = 10
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			random_list = {
				1 = {
					assign_ruler_focus = {
						type = mil
					}
				}
				1 = {
					assign_ruler_focus = {
						type = dip
					}
				}
				1 = {
					assign_ruler_focus = {
						type = adm
					}
				}
			}
		}
	}
}


# death Election 1
country_event = {
	id = flavour_celmaldor.701
	title = flavour_celmaldor.701.t
	desc = flavour_celmaldor.701.d
	picture = ELECTION_REPUBLICAN_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		NOT = {
			mission_completed = z22_rights_of_man
		}
	}
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			pre_select_possible_ruler_focus = yes
			if = {
				limit = { has_government_attribute = has_limited_terms }
				export_to_variable = {
					which = max_election_term
					value = modifier:max_terms
				}
			}

			z22_prince_elect_set_random_character = yes
		}
	}

	after = {
		post_ruler_focus_clearance = yes
	}
	option = {
		name = flavour_celmaldor.700.b #The candidate of Clan Frozentide
		ai_chance = { factor = 20 }
		trigger = {
			NOT = {
				AND = {
					ai = yes
					OR = {
						ruler_has_personality = mythical_conqueror_personality
						ruler_has_personality = great_conqueror_personality
					}
				}
			}
		}
		define_ruler = {
			min_age = 250
			max_age = 400
			change_adm = 2
			change_dip = -1
			change_mil = -1
			dynasty = "Frozentide"
		}
		hidden_effect = {
			set_ruler_flag = ruler_is_frozentide
			set_ruler_flag = long_lived_ruler
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_adm_faction = {
				influence = 20
			}
		}
		add_karma = 10
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_estate_loyalty_by_class_adm = {
				loyalty = 10
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = adm
			}
		}
	}
	option = {
		name = flavour_celmaldor.700.c #an Icewind candidate
		trigger = {
			NOT = {
				AND = {
					ai = yes
					OR = {
						ruler_has_personality = mythical_conqueror_personality
						ruler_has_personality = great_conqueror_personality
					}
				}
			}
		}
		ai_chance = { factor = 20 }
		define_ruler = {
			min_age = 250
			max_age = 400
			change_adm = -1
			change_dip = 2
			change_mil = -1
			dynasty = "Icewind"
			random_gender = yes
		}
		hidden_effect = {
			set_ruler_flag = ruler_is_icewind
			set_ruler_flag = long_lived_ruler
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_dip_faction = {
				influence = 20
			}
		}
		add_karma = 10
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_estate_loyalty_by_class_dip = {
				loyalty = 10
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = dip
			}
		}
	}
	option = {
		name = flavour_celmaldor.700.e	#a whitespear candidate
		ai_chance = { factor = 20 }
		trigger = {
			NOT = {
				AND = {
					ai = yes
					OR = {
						ruler_has_personality = mythical_conqueror_personality
						ruler_has_personality = great_conqueror_personality
					}
				}
			}
		}
		define_ruler = {
			min_age = 250
			max_age = 400
			change_adm = -1
			change_dip = -1
			change_mil = 2
			dynasty = "Whitespear"
			random_gender = yes
		}
		hidden_effect = {
			set_ruler_flag = ruler_is_whitespear
			set_ruler_flag = long_lived_ruler
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_mil_faction = {
				influence = 20
			}
		}
		add_karma = 10
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_estate_loyalty_by_class_mil = {
				loyalty = 10
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = mil
			}
		}
	}
	option = {
		name = flavour_celmaldor.700.f #random non clan candidate
		ai_chance = { factor = 20 }
		trigger = {
			NOT = {
				AND = {
					ai = yes
					OR = {
						ruler_has_personality = mythical_conqueror_personality
						ruler_has_personality = great_conqueror_personality
					}
				}
			}
		}
		
		custom_tooltip = z22_random_candidate
		if = {
			limit = {
				has_country_flag = z22_adm_candidate
			}
			define_ruler = {
				change_adm = 1
				random_gender = yes
				culture = event_target:z22_candidate_origin_province
				religion = event_target:z22_candidate_origin_province
			}
		}
		else_if = {
			limit = {
				has_country_flag = z22_dip_candidate
			}
			define_ruler = {
				change_dip = 1
				random_gender = yes
				culture = event_target:z22_candidate_origin_province
				religion = event_target:z22_candidate_origin_province
			}
		}
		else = {
			define_ruler = {
				change_mil = 1
				random_gender = yes
				culture = event_target:z22_candidate_origin_province
				religion = event_target:z22_candidate_origin_province
			}
		}

		hidden_effect = {
			set_ruler_flag = ruler_is_non_clan
			clr_country_flag = z22_adm_candidate
			clr_country_flag = z22_dip_candidate
			clr_country_flag = z22_mil_candidate
		}
		add_karma = 10
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_random_estate_loyalty = {
				amount = 10
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			random_list = {
				1 = {
					assign_ruler_focus = {
						type = mil
					}
				}
				1 = {
					assign_ruler_focus = {
						type = dip
					}
				}
				1 = {
					assign_ruler_focus = {
						type = adm
					}
				}
			}
		}
	}
}

#Election 2
country_event = {
	id = flavour_celmaldor.702
	title = flavour_celmaldor.702.t
	desc = flavour_celmaldor.702.d
	picture = ELECTION_REPUBLICAN_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		mission_completed = z22_rights_of_man
	}
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			pre_select_possible_ruler_focus = yes
			if = {
				limit = { has_government_attribute = has_limited_terms }
				export_to_variable = {
					which = max_election_term
					value = modifier:max_terms
				}
			}

			random_list = {
				75 = {
					z22_prince_elect_improved_set_random_character_1 = yes
				}
				25 = {
					set_country_flag = z22_frozentide_candidate
				}
			}

			random_list = {
				75 = {
					z22_prince_elect_improved_set_random_character_2 = yes
				}
				25 = {
					set_country_flag = z22_icewind_candidate
				}
			}

			random_list = {
				75 = {
					z22_prince_elect_improved_set_random_character_3 = yes
				}
				25 = {
					set_country_flag = z22_whitespear_candidate
				}
			}
		}
	}

	after = {
		post_ruler_focus_clearance = yes
		clr_country_flag = z22_frozentide_candidate
		clr_country_flag = z22_icewind_candidate
		clr_country_flag = z22_whitespear_candidate
	}

	option = {
		name = flavour_celmaldor.702.a # Current ruler stays
		trigger = {
			has_regency = no
			NOT = { 
				has_ruler_flag = leader_has_been_pushed_out
			}
			OR = {
				NOT = { has_government_attribute = has_limited_terms }
				check_variable = {
					which = max_election_term
					which = election_term
				}
			}
		}
		ai_chance = { 
			factor = 60
			modifier = {
				factor = 0
				NOT = { republican_tradition = 25 }
			}	
			modifier = {
				factor = 0.5
				NOT = { republican_tradition = 50 }
			}				
			modifier = {
				factor = 0.5
				NOT = { republican_tradition = 75 }
			}	
			modifier = {
				factor = 2.0
				republican_tradition = 90
			}		
			
			#Anbennar
			modifier = {
				factor = 2.0
				ruler_is_powerful_mage = yes
			}	
			modifier = {
				factor = 100.0
				OR = {
					ruler_has_personality = great_conqueror_personality
					ruler_has_personality = mythical_conqueror_personality
				}
			}
		}
		custom_tooltip = remains_ruler
		if = {
			limit = { has_government_attribute = has_limited_terms }
			custom_tooltip = current_term_tt
		}
		change_adm = 1
		change_dip = 1
		change_mil = 1
		if = {
			limit = {
				NOT = { republican_tradition = 20 }
				has_dlc = "Res Publica"
			}
			add_government_reform = presidential_despot_reform	
		}
		if = {
			limit = {
				NOT = { republican_tradition = 20 }
				NOT = { has_dlc = "Res Publica" }
			}
			change_government = monarchy
			#set_legacy_government = despotic_monarchy
		}
		else = {
			if = {
				limit = {
					has_country_flag = increased_election_cost
				}
				add_scaled_republican_tradition = -10
				clr_country_flag = increased_election_cost
			}
			else = {
				add_scaled_republican_tradition = -6
			}
		}
		random_list = {
			10 = {
				add_adm_power = 50
			}
			10 = {
				add_dip_power = 50
			}
			10 = {
				add_mil_power = 50
			}
		}
		if = {
			limit = {
				has_government_attribute = reelection_depowers_estates
			}
			add_estate_influence_modifier = {
				estate = all
				influence = -10
				duration = 1460
				desc = REELCTION_DEPOWER_ESTATES
			}
		}
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_estate_loyalty = {
				estate = all
				loyalty = 5
			}
		}
		if = {
			limit = { has_government_attribute = reelection_increases_absolutism }
			tooltip = {
				add_absolutism = 10
			}
			custom_tooltip = ADD_ABSOLUTISM_BASED_ON_ELECTION_TERM
			hidden_effect = {
				for_variable_amount = {
					variable = election_term
					effect = "
						add_absolutism = 10
					"
				}
			}
			hidden_effect = {
				change_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_random_faction = {
				influence = 20
			}
		}
		add_karma = -5
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				change_variable = {
					which = election_term
					value = 1
				}
			}
		}
	}
	option = {
		name = flavour_celmaldor.702.b #The candidate of Clan Frozentide
		ai_chance = { factor = 20 }
		trigger = {
			NOT = {
				AND = {
					ai = yes
					OR = {
						ruler_has_personality = mythical_conqueror_personality
						ruler_has_personality = great_conqueror_personality
					}
				}
				z22_ruler_is_frozentide = yes
			}
		}
		if = {
			limit = {
				has_country_flag = z22_frozentide_candidate
			}
			define_ruler = {
				min_age = 100
				max_age = 300
				culture = moon_elf
				religion = ROOT
				change_adm = 2
				random_gender = yes
			}
		}
		else = {
			define_ruler = {
				change_adm = 2
				culture = event_target:z22_candidate_1_origin
				religion = event_target:z22_candidate_1_origin
				random_gender = yes
			}
		}
		hidden_effect = {
			set_ruler_flag = ruler_is_frozentide
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_adm_faction = {
				influence = 20
			}
		}
		add_karma = 10
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_estate_loyalty_by_class_adm = {
				loyalty = 10
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = adm
			}
		}
	}
	option = {
		name = flavour_celmaldor.702.c #an Icewind candidate
		trigger = {
			NOT = {
				AND = {
					ai = yes
					OR = {
						ruler_has_personality = mythical_conqueror_personality
						ruler_has_personality = great_conqueror_personality
					}
				}
				z22_ruler_is_icewind = yes
			}
		}
		ai_chance = { factor = 20 }
		if = {
			limit = {
				has_country_flag = z22_icewind_candidate
			}
			define_ruler = {
				min_age = 100
				max_age = 300
				culture = moon_elf
				religion = ROOT
				change_dip = 2
				random_gender = yes
			}
		}
		else = {
			define_ruler = {
				change_dip = 2
				culture = event_target:z22_candidate_1_origin
				religion = event_target:z22_candidate_1_origin
				random_gender = yes
			}
		}
		hidden_effect = {
			set_ruler_flag = ruler_is_icewind
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_dip_faction = {
				influence = 20
			}
		}
		add_karma = 10
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_estate_loyalty_by_class_dip = {
				loyalty = 10
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = dip
			}
		}
	}
	option = {
		name = flavour_celmaldor.702.e	#a whitespear candidate
		ai_chance = { factor = 20 }
		trigger = {
			NOT = {
				AND = {
					ai = yes
					OR = {
						ruler_has_personality = mythical_conqueror_personality
						ruler_has_personality = great_conqueror_personality
					}
				}
				z22_ruler_is_whitespear = yes
			}
		}
		if = {
			limit = {
				has_country_flag = z22_whitespear_candidate
			}
			define_ruler = {
				min_age = 100
				max_age = 300
				culture = moon_elf
				religion = ROOT
				change_mil = 2
				random_gender = yes
			}
		}
		else = {
			define_ruler = {
				change_mil = 2
				culture = event_target:z22_candidate_1_origin
				religion = event_target:z22_candidate_1_origin
				random_gender = yes
			}
		}
		hidden_effect = {
			set_ruler_flag = ruler_is_whitespear
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_mil_faction = {
				influence = 20
			}
		}
		add_karma = 10
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_estate_loyalty_by_class_mil = {
				loyalty = 10
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = mil
			}
		}
	}
}

#death Election 2
country_event = {
	id = flavour_celmaldor.703
	title = flavour_celmaldor.703.t
	desc = flavour_celmaldor.703.d
	picture = ELECTION_REPUBLICAN_eventPicture

	trigger = {
		OR = {
			tag = Z22
			was_tag = Z22
		}
		mission_completed = z22_rights_of_man
	}
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			pre_select_possible_ruler_focus = yes
			if = {
				limit = { has_government_attribute = has_limited_terms }
				export_to_variable = {
					which = max_election_term
					value = modifier:max_terms
				}
			}

			random_list = {
				75 = {
					z22_prince_elect_improved_set_random_character_1 = yes
				}
				25 = {
					set_country_flag = z22_frozentide_candidate
				}
			}

			random_list = {
				75 = {
					z22_prince_elect_improved_set_random_character_2 = yes
				}
				25 = {
					set_country_flag = z22_icewind_candidate
				}
			}

			random_list = {
				75 = {
					z22_prince_elect_improved_set_random_character_3 = yes
				}
				25 = {
					set_country_flag = z22_whitespear_candidate
				}
			}
		}
	}

	after = {
		post_ruler_focus_clearance = yes
		clr_country_flag = z22_frozentide_candidate
		clr_country_flag = z22_icewind_candidate
		clr_country_flag = z22_whitespear_candidate
	}
	option = {
		name = flavour_celmaldor.702.b #The candidate of Clan Frozentide
		ai_chance = { factor = 20 }
		trigger = {
			NOT = {
				AND = {
					ai = yes
					OR = {
						ruler_has_personality = mythical_conqueror_personality
						ruler_has_personality = great_conqueror_personality
					}
				}
			}
		}
		if = {
			limit = {
				has_country_flag = z22_frozentide_candidate
			}
			define_ruler = {
				min_age = 100
				max_age = 300
				culture = moon_elf
				religion = ROOT
				change_adm = 2
				random_gender = yes
			}
		}
		else = {
			define_ruler = {
				change_adm = 2
				culture = event_target:z22_candidate_1_origin
				religion = event_target:z22_candidate_1_origin
				random_gender = yes
			}
		}
		hidden_effect = {
			set_ruler_flag = ruler_is_frozentide
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_adm_faction = {
				influence = 20
			}
		}
		add_karma = 10
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_estate_loyalty_by_class_adm = {
				loyalty = 10
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = adm
			}
		}

	}
	option = {
		name = flavour_celmaldor.702.c #an Icewind candidate
		trigger = {
			NOT = {
				AND = {
					ai = yes
					OR = {
						ruler_has_personality = mythical_conqueror_personality
						ruler_has_personality = great_conqueror_personality
					}
				}
			}
		}
		ai_chance = { factor = 20 }
		if = {
			limit = {
				has_country_flag = z22_icewind_candidate
			}
			define_ruler = {
				min_age = 100
				max_age = 300
				culture = moon_elf
				religion = ROOT
				change_dip = 2
				random_gender = yes
			}
		}
		else = {
			define_ruler = {
				change_dip = 2
				culture = event_target:z22_candidate_1_origin
				religion = event_target:z22_candidate_1_origin
				random_gender = yes
			}
		}
		hidden_effect = {
			set_ruler_flag = ruler_is_icewind
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_dip_faction = {
				influence = 20
			}
		}
		add_karma = 10
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_estate_loyalty_by_class_dip = {
				loyalty = 10
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = dip
			}
		}
	}
	option = {
		name = flavour_celmaldor.702.e	#a whitespear candidate
		ai_chance = { factor = 20 }
		trigger = {
			NOT = {
				AND = {
					ai = yes
					OR = {
						ruler_has_personality = mythical_conqueror_personality
						ruler_has_personality = great_conqueror_personality
					}
				}
			}
		}
		if = {
			limit = {
				has_country_flag = z22_whitespear_candidate
			}
			define_ruler = {
				min_age = 100
				max_age = 300
				culture = moon_elf
				religion = ROOT
				change_mil = 2
				random_gender = yes
			}
		}
		else = {
			define_ruler = {
				change_mil = 2
				culture = event_target:z22_candidate_1_origin
				religion = event_target:z22_candidate_1_origin
				random_gender = yes
			}
		}
		hidden_effect = {
			set_ruler_flag = ruler_is_whitespear
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_mil_faction = {
				influence = 20
			}
		}
		add_karma = 10
		if = {
			limit = { has_government_attribute = elections_influence_estates }
			add_estate_loyalty_by_class_mil = {
				loyalty = 10
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = mil
			}
		}
	}
}

#events potential
country_event = {
	id = flavour_celmaldor.995
	title = flavour_celmaldor.1.t
	desc = flavour_celmaldor.1.d
	picture = FEAST_eventPicture

	is_triggered_only = yes
	hidden = yes

	trigger = {
		is_or_was_tag = { tag = Z22 }
		NOT = {
			has_country_flag = z22_urvion_event_2
		}
	}

	option = {
		name = flavour_celmaldor.1.a
		trigger = {
			NOT = {
				has_country_flag = z22_urvion_event_1
			}
		}
		ai_chance = {
			factor = 10
			modifier = {
				factor = 2
				dip_tech = 5
			}
			modifier = {
				factor = 2
				dip_tech = 7
			}
			modifier = {
				factor = 2
				num_of_explorers = 1
			}
			modifier = {
				factor = 2
				has_discovered = 1001
			}
		}
		country_event = {
			id = flavour_celmaldor.1
			days = 300
			random = 100
		}
	}

	option = {
		name = flavour_celmaldor.1.b
		trigger = {
			has_country_flag = z22_urvion_event_1
		}
		ai_chance = {
			factor = 10
			modifier = {
				factor = 2
				had_country_flag = {
					flag = z22_urvion_event_1
					days = 3650
				}
			}
			modifier = {
				factor = 2
				had_country_flag = {
					flag = z22_urvion_event_1
					days = 7300
				}
			}
			modifier = {
				factor = 2
				had_country_flag = {
					flag = z22_urvion_event_1
					days = 10950
				}
			}
			modifier = {
				factor = 2
				had_country_flag = {
					flag = z22_urvion_event_1
					days = 14600
				}
			}
		}
		country_event = {
			id = flavour_celmaldor.2
			days = 300
			random = 100
		}
	}

	option = {
		name = flavour_celmaldor.1.b
		ai_chance = {
			factor = 10
		}
		
	}
}

#event so the game doesn't crash
country_event = {
	id = flavour_celmaldor.996
	title = flavour_celmaldor.1.t
	desc = flavour_celmaldor.1.d
	picture = FEAST_eventPicture

	is_triggered_only = yes
	hidden = yes

	option = {
		name = flavour_celmaldor.1.a
		ai_chance = {
			factor = 1
		}
		z22_free_colony_and_make_giesadh_effect = yes 
	}
}

#give the iteration privilege
country_event = {
	id = flavour_celmaldor.997
	title = flavour_celmaldor.1.t
	desc = flavour_celmaldor.1.d
	picture = FEAST_eventPicture

	is_triggered_only = yes
	hidden = yes

	option = {
		name = flavour_celmaldor.1.a
		ai_chance = {
			factor = 1
		}
		set_estate_privilege = z22_steady_iteration_privilege
	}
}

#debug stuff on startup
country_event = {
	id = flavour_celmaldor.998
	title = flavour_celmaldor.0.a
	desc = flavour_celmaldor.0.a
	picture = DIET_eventPicture

	is_triggered_only = yes
	fire_only_once = yes
	hidden = yes

	trigger = {
		is_or_was_tag = { tag = Z22 }
		ai = no
	}

	option = {
		name = flavour_celmaldor.0.a

		ai_chance = {
			factor = 1
		}

		if = {
			limit = {
				NOT = {
					has_country_modifier = z22_election_cycle_modifier	#this modifier exists to offset elves having +20 election cycle since Celmaldor has a 12 year election cycle
				}
			}
			add_country_modifier = {
				name = z22_election_cycle_modifier
				hidden = yes
				duration = -1
			}
		}

		if = {
			limit = {
				NOT = {
					is_year = 1445
				}
			}
			country_event = {
				id = flavour_celmaldor.22
				days = 300
				random = 100
			}
		}
	}
}

#debug check so people don't get stuck as giesadh
country_event = {
	id = flavour_celmaldor.999
	title = flavour_celmaldor.999.t
	desc = flavour_celmaldor.999.d
	picture = COURT_INTRIGUE_eventPicture

	is_triggered_only = yes
	hidden = yes

	trigger = {
		has_global_flag = z22_can_have_giesadh
		OR = {
			AND = {
				has_country_flag = z22_tag_is_giesadh
				NOT = {
					transfers_trade_power_to = Z22
					alliance_with = Z22
					transfers_trade_power_to = B98
					alliance_with = B98
				}
			}
			AND = {
				OR = {
					AND = {
						transfers_trade_power_to = Z22
						alliance_with = Z22
					}
					AND = {
						transfers_trade_power_to = B98
						alliance_with = B98
					}
				}
				NOT = {
					has_country_flag = z22_tag_is_giesadh
				}
			}
		}
	}

	option = {
		name = flavour_celmaldor.999.a
		ai_chance = {
			factor = 1
		}

		z22_giesadh_check_effect = yes

	}
}

#unlock innate windshaping
country_event = {
	id = flavour_celmaldor.1001
	title = flavour_celmaldor.1001.t
	desc = flavour_celmaldor.1001.d
	picture = INVENTION_eventPicture

	is_triggered_only = yes

	option = {
		name = artifice_inventions.69.a
		custom_tooltip = new_artifice_invention_tooltip
		hidden_effect = {
			set_country_flag = unlocked_artifice_invention_innate_windshaping
		}
	}
}


#unlock icestorm cannon
country_event = {
	id = flavour_celmaldor.1002
	title = flavour_celmaldor.1002.t
	desc = flavour_celmaldor.1002.d
	picture = INVENTION_eventPicture

	is_triggered_only = yes

	option = {
		name = artifice_inventions.69.a
		custom_tooltip = new_artifice_invention_tooltip
		hidden_effect = {
			set_country_flag = unlocked_artifice_invention_icestorm_cannons
		}
	}
}


#unlock sustaining ark
country_event = {
	id = flavour_celmaldor.1003
	title = flavour_celmaldor.1003.t
	desc = flavour_celmaldor.1003.d
	picture = INVENTION_eventPicture

	is_triggered_only = yes

	option = {
		name = artifice_inventions.69.a
		custom_tooltip = new_artifice_invention_tooltip
		hidden_effect = {
			set_country_flag = unlocked_artifice_invention_sustaining_arks
		}
	}
}
