namespace = flavour_karassk

#startevent 
country_event = {
	id = flavour_karassk.1
	title = flavour_karassk.1.t
	desc = flavour_karassk.1.desc
	picture = SWORD_OF_OSMAN_eventPicture

	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
		tag = L68
	}

	immediate = {
		hidden_effect = {
			set_country_flag = L68_mechanic_check_flag
			set_country_flag = L68_dont_form_till_done
			set_country_flag = L68_track_merc_wins
			set_country_flag = L68_track_naval_wins
			set_variable = {
				which = L68_battles_with_merc_won
				value = 0 
			}
			set_variable = {
				which = L68_battles_with_naval_won
				value = 0 
			}
		}
	}

	option = {
		name = flavour_karassk.1.a
		L96 = {
				every_owned_province = {
					add_claim = ROOT
				}
			}
		S15 = {
			every_owned_province = {
				add_claim = ROOT
			}
		}
	}
}

country_event = {
	id = flavour_karassk.2
	title = flavour_karassk.2.t
	desc = flavour_karassk.2.desc
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					L96 = {
						is_subject_of = ROOT
					}
				}
				L96 = {
					kill_ruler = yes
				}
			}
		}
	}

	option = {
		name = flavour_karassk.2.a
		5902 = {
			set_base_manpower = 1
			set_base_tax = 1
			set_base_production = 1
		}
		set_country_flag = L68_choose_sack
		hidden_effect = {
			if = {
				limit = {
					L96 = {
						is_subject_of = ROOT
					}
				}
				L96 = {
					add_liberty_desire = 20
				}
			}
		}
	}

	option = {
		name = flavour_karassk.2.b
		5834 = {
			set_base_manpower = 2
			set_base_tax = 2
			set_base_production = 1
		}
		set_country_flag = L68_choose_sack
		hidden_effect = {
			if = {
				limit = {
					S15 = {
						is_subject_of = ROOT
					}
				}
				S15 = {
					add_liberty_desire = 20
				}
			}
		}
	}

	option = {
		name = flavour_karassk.2.c
	}

	after = {
		hidden_effect = {
			country_event = {
				id = flavour_karassk.3
				days = 183 
			}
		}
	}
}

country_event = {
	id = flavour_karassk.3
	title = flavour_karassk.3.t
	desc = flavour_karassk.3.desc
	picture = AFRICAN_ARTWORK_eventPicture

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
	}

	option = {
		name = flavour_karassk.3.a
		add_prestige = 30
		add_historical_rival = L95
		add_historical_rival = L97
		L95 = {
			add_historical_rival = L68
			add_country_modifier = {
				name = L68_killed_brother
				duration = 7300
			}
		}
		L97 = {
			add_historical_rival = L68
			add_country_modifier = {
				name = L68_killed_brother
				duration = 7300
			}
		}
	}

	option = {
		name = flavour_karassk.3.b
		add_prestige = 10
		add_truce_with = L95
		L95 = {
			add_truce_with = L68
		}
	}

	option = {
		trigger = {
			L97 = { exists = yes }
		}
		name = flavour_karassk.3.c
		add_prestige = 10
		if = {
			limit = {
				L97 = {
					is_subject_of = L95
				}
			}
			L97 = {
				add_liberty_desire = 200
			}
		}
	}

	after = { }
}

country_event = {
	id = flavour_karassk.4
	title = flavour_karassk.4.t
	desc = flavour_karassk.4.desc
	picture = 18_Trade_Company_eventPicture

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
	}

	option = {
		name = flavour_karassk.4.a
		tebajik_area = {
			add_permanent_claim = ROOT
		}
		ibibakely_area = {
			add_permanent_claim = ROOT
		}
		tebolelmasi_area = {
			add_permanent_claim = ROOT
		}
		zohejirofo_area = {
			add_permanent_claim = ROOT
		} 
		add_country_modifier = {
			name = L68_were_back 
			duration = 5475
		}
	}

	after = { }
}

country_event = {
	id = flavour_karassk.5
	title = flavour_karassk.5.t
	desc = flavour_karassk.5.desc
	picture = DHOW_AT_SEA_eventPicture

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
	}

	option = {
		name = flavour_karassk.5.a
		khugra_tara_area = {
			add_permanent_claim = ROOT
		}
		nepa_tressik_area = {
			add_permanent_claim = ROOT
		}
		naga_ra_atsla_area = {
			add_permanent_claim = ROOT
		}
		nazhni_tara_area = {
			add_permanent_claim = ROOT
		}
		nazhni_tressik_area = {
			add_permanent_claim = ROOT
		}
		tressik_isles_area = {
			add_permanent_claim = ROOT
		}
		5914 = {
			add_core = ROOT
		}
		5941 = {
			add_core = ROOT
		}
	}

	after = { }
}

country_event = {
	id = flavour_karassk.6
	title = flavour_karassk.6.t
	desc = flavour_karassk.6.desc
	picture = LIZARDFOLK_NAGA_eventPicture

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
	}

	option = {
		name = flavour_karassk.6.a
		zuvaziva_area = {
			add_permanent_claim = ROOT
		}
		zenavuma_area = {
			add_permanent_claim = ROOT
		}
		kumashet_area = {
			add_permanent_claim = ROOT
		}
		gomuvuri_area = {
			add_permanent_claim = ROOT
		}
		imdrashid_area = {
			add_province_modifier = {
				name = L68_true_rulers_return 
				duration = 10950
			}
		}
		set_country_flag = L68_give_true_ruler_return_on_take
		if = {
			limit = {
				any_owned_province = {
					OR = {
						area = zuvaziva_area
						area = zenavuma_area
						area = kumashet_area
						area = gomuvuri_area 
					}
				}
			}
			every_owned_province = {
				limit = {
					OR = {
						area = zuvaziva_area
						area = zenavuma_area
						area = kumashet_area
						area = gomuvuri_area 
					}
				}
				add_province_modifier = {
					name = L68_true_rulers_return 
					duration = 10950
				}

			}
		}
	}

	after = { }
}

country_event = {
	id = flavour_karassk.7
	title = flavour_karassk.7.t
	desc = flavour_karassk.7.desc
	picture = TREASURE_FLEET_SHIP_eventPicture

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
	}

	option = {
		name = flavour_karassk.7.a
		add_government_reform = karassk_laushan_city
	}
}

country_event = {
	id = flavour_karassk.8
	title = flavour_karassk.8.t
	desc = flavour_karassk.8.desc
	picture = BARBARY_PIRATES_eventPicture
	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
	}

	immediate = {
	}

	option = {
		name = flavour_karassk.8.a
		add_country_modifier = {
			name = L68_to_move_like_one
			duration = 12045
		}
	}
}

country_event = {
	id = flavour_karassk.9
	title = flavour_karassk.9.t
	desc = flavour_karassk.9.desc
	picture = GREAT_SPIRIT_CINULAU_eventPicture
	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
	}

	immediate = {
	}

	option = {
		name = flavour_karassk.9.a 
		add_country_modifier = {
			name = L68_grasp_and_crush
			duration = 12045
		}
	}
}

country_event = {
	id = flavour_karassk.10
	title = flavour_karassk.10.t
	desc = flavour_karassk.10.desc
	picture = LIZARDFOLK_NAGA_eventPicture

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
	}

	option = {
		name = flavour_karassk.10.a 
		add_country_modifier = {
			name = L68_khair_of_kunolo
			duration = -1
		}
		fangaula_superregion = {
			discover_country = ROOT
		}
		dao_nako_region = {
			limit = {
				has_port = yes
			}
			add_permanent_claim = ROOT
		}
	}
}

country_event = {
	id = flavour_karassk.11
	title = flavour_karassk.11.t
	desc = flavour_karassk.11.desc
	picture = ARTILLERY_eventPicture

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
		set_country_flag = L68_merfolk_cannal_merchant
		6000 = {
			add_province_modifier = {
				name = L68_merfolk_slaves
				duration = -1
			}
			add_province_modifier = {
				name = L68_blood_in_the_water
				duration = -1
			}
			kill_units = {
				who = ROOT
				type = artillery
				amount = 30 
			}	
		}
	}

	option = {
		name = flavour_karassk.11.a
		custom_tooltip = flavour_karassk.11.tt
		hidden_effect = {
			every_owned_province = {
				if = {
					limit = { has_province_modifier = L68_merfolk_slaves }
					add_province_modifier = {
						name = L68_shipped_out
						duration = 5475
					}
				}
				if = {
					limit = { has_province_modifier = L68_emperors_of_arskite }
					add_province_modifier = {
						name = L68_by_emperors_decree
						duration = 5475
					}
				}
			}
		}
		jasiir_jadid_region = {
			add_permanent_claim = ROOT 
		}
	}
}

country_event = {
	id = flavour_karassk.12
	title = flavour_karassk.12.t
	desc = flavour_karassk.12.desc
	picture = MAGE_MOON_ALTER_eventPicture

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
	}

	option = {
		hidden_effect = {
			every_subject_country = {
				limit = {
					culture_is_lizardfolk = yes
					religion = anzalkatsa
					NOT = { total_development = 151}
					is_subject_of_type = karassk_idzarshin_trib_subject
				}
				ROOT = {
					set_variable = { which = totalkaratribDev value = 0 }
					export_to_variable = { which = tempkaratriDev value = total_development who = PREV }
					change_variable = { which = totalkaratribDev which = tempkaratriDev }
				}
				ROOT = {
					while = { limit = { check_variable = { which = totalkaratribDev value = 1 } }
						add_dip_power = -1
						change_variable = { which = totalkaratribDev value = -1 }
					}
				}
				ROOT = {
					create_subject = {
						subject_type = vassal
						who = PREV
					}
				}
			}
			every_subject_country = {
				limit = {
					culture_is_lizardfolk = yes
					religion = anzalkatsa
					total_development = 151
					is_subject_of_type = karassk_idzarshin_trib_subject
				}
				ROOT = {
					set_variable = { which = totalkaratribDev value = 0 }
					export_to_variable = { which = tempkaratriDev value = total_development who = PREV }
					change_variable = { which = totalkaratribDev which = tempkaratriDev }
				}
				ROOT = {
					while = { limit = { check_variable = { which = totalkaratribDev value = 1 } }
						add_dip_power = -2
						change_variable = { which = totalkaratribDev value = -1 }
					}
				}
				ROOT = {
					create_subject = {
						subject_type = vassal
						who = PREV
					}
				}
			}
		}
		name = flavour_karassk.12.a 
		add_country_modifier = {
			name = L68_go_beyond
			duration = -1
		}
		custom_tooltip = flavour_karassk.12.tt
		set_country_flag = L68_trib_sarhal_sans_north
		set_country_flag = L68_unlock_missions
		ardimya_region = {
			add_permanent_claim = ROOT
		}
		swap_non_generic_missions = yes
	}
}

country_event = {
	id = flavour_karassk.13
	title = flavour_karassk.13.t
	desc = flavour_karassk.13.desc
	picture = AFRICAN_DISCIPLINE_eventPicture

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
	}

	option = {
		name = flavour_karassk.13.a 
		add_country_modifier = {
			name = L68_our_right
			duration = -1
		}
	}
}

country_event = {
	id = flavour_karassk.14
	title = flavour_karassk.14.t
	desc = flavour_karassk.14.desc
	picture = TREASURE_FLEET_SHIP_eventPicture

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
	}

	option = {
		name = flavour_karassk.14.a 
		6678 = {
			custom_tooltip = flavour_karassk.14.tt
			hidden_effect = {
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				add_province_modifier = {
					name = L68_merfolk_slaves
					duration = -1
				}
				if = {
					limit = {
						ROOT = {
							any_owned_province = {
								has_great_project = {
									type = arskitse
									tier = 2
								}
							}
						}
					}
					add_province_modifier = {
						name = L68_emperors_of_arskite
						duration = -1
					}
				}
			}
		}
		6675 = {
			custom_tooltip = flavour_karassk.14.tt
			hidden_effect = {
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				galleon_heavy = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				add_province_modifier = {
					name = L68_merfolk_slaves
					duration = -1
				}
				if = {
					limit = {
						ROOT = {
							any_owned_province = {
								has_great_project = {
									type = arskitse
									tier = 2
								}
							}
						}
					}
					add_province_modifier = {
						name = L68_emperors_of_arskite
						duration = -1
					}
				}
			}
		}	
		6127 = {
			custom_tooltip = flavour_karassk.14.tt
			hidden_effect = {
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				marine_infantry = ROOT
				add_province_modifier = {
					name = L68_merfolk_slaves
					duration = -1
				}
				if = {
					limit = {
						ROOT = {
							any_owned_province = {
								has_great_project = {
									type = arskitse
									tier = 2
								}
							}
						}
					}
					add_province_modifier = {
						name = L68_emperors_of_arskite
						duration = -1
					}
				}
			}
		}
		6569 = {
			custom_tooltip = flavour_karassk.14.tt
			change_trade_goods = slaves
			hidden_effect = {
				add_province_modifier = {
					name = L68_merfolk_slaves
					duration = -1
				}
				if = {
					limit = {
						ROOT = {
							any_owned_province = {
								has_great_project = {
									type = arskitse
									tier = 2
								}
							}
						}
					}
					add_province_modifier = {
						name = L68_emperors_of_arskite
						duration = -1
					}
				}
			}
		}
		3226 = {
			custom_tooltip = flavour_karassk.14.tt
			change_trade_goods = slaves
			hidden_effect = {
				add_province_modifier = {
					name = L68_merfolk_slaves
					duration = -1
				}
				if = {
					limit = {
						ROOT = {
							any_owned_province = {
								has_great_project = {
									type = arskitse
									tier = 2
								}
							}
						}
					}
					add_province_modifier = {
						name = L68_emperors_of_arskite
						duration = -1
					}
				}
			}
		}
		custom_tooltip = flavour_karassk.14.tt2
		set_country_flag = L68_merfolk_move_with_cap
		ringlet_isles_region = {
			add_permanent_claim = ROOT
		}
		5896 = {
			custom_tooltip = flavour_karassk.14.tt
			hidden_effect = {
				add_province_modifier = {
					name = L68_merfolk_slaves
					duration = -1
				}
				if = {
					limit = {
						ROOT = {
							any_owned_province = {
								has_great_project = {
									type = arskitse
									tier = 2
								}
							}
						}
					}
					add_province_modifier = {
						name = L68_emperors_of_arskite
						duration = -1
					}
				}
			}
		}
		custom_tooltip = flavour_karassk.14.tt3
		hidden_effect = {
			dynamic_merfolk_region = {
				remove_province_modifier = offcoast_merfolk_isolated
				remove_province_modifier = offcoast_merfolk_neutral
				remove_province_modifier = offcoast_merfolk_allied
				clr_province_flag = merfolk_settlement
			}
		}
		hidden_effect = {
			add_country_modifier = {
				name = L68_merfolk_slave_capital_move_dummy_mod
				duration = -1
			}
		}
	}
}

country_event = {
	id = flavour_karassk.15
	title = flavour_karassk.15.t
	desc = flavour_karassk.15.desc
	picture = MAGE_MOON_eventPicture

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
	}

	option = {
		name = flavour_karassk.15.a 
		add_splendor = 1000
		add_prestige = 1000
		add_country_modifier = {
			name = L68_the_true_empire
			duration = -1
		}
	}
}

country_event = {
	id = flavour_karassk.16
	title = flavour_karassk.16.t
	desc = flavour_karassk.16.desc
	picture = FAR_AND_WIDE_eventPicture

	is_triggered_only = yes

	trigger = {
	}

	immediate = {
	}

	option = {
		name = flavour_karassk.16.a 
		set_country_flag = L68_unlock_tribs_to_vassals
		clr_country_flag = L68_dont_form_till_done
		custom_tooltip = flavour_karassk.16.tt
		custom_tooltip = flavour_karassk.16.tt2
		add_country_modifier = {
			name = L68_the_only_empire
			duration = -1
		}
	}
}

country_event = { #Tributary Selection Event , mostly copy of sri baginda 
	id = flavour_karassk.101
	title = flavour_karassk.101.t
	desc = flavour_karassk.101.desc
	picture = NUSANTARA_THRONE_eventPicture

	is_triggered_only = yes

	trigger = {
		has_country_flag = L68_unlock_tribs_to_vassals
	}

	immediate = { #Top 3 by dev, rest is random
		hidden_effect = {
			special_tribs_to_vassals_dev_order  = { tributary = 1 }
			special_tribs_to_vassals_dev_order  = { tributary = 2 }
			special_tribs_to_vassals_dev_order  = { tributary = 3 }
			special_tribs_to_vassals_random_order  = { tributary = 4 }
			special_tribs_to_vassals_random_order  = { tributary = 5 }
			special_tribs_to_vassals_random_order  = { tributary = 6 }
			#precalcs for dip values
			if = {
				limit = { has_saved_event_target = idzarshin_trib_1 }
				event_target:idzarshin_trib_1 = {
					ROOT = {
						set_variable = { which = totalkaratribDev1 value = 0 }
						export_to_variable = { which = tempkaratriDev1 value = total_development who = PREV }
						change_variable = { which = totalkaratribDev1 which = tempkaratriDev1 }
						multiply_variable = { which = totalkaratribDev1 value = 2 }
					}
				}
			}
			if = {
				limit = { has_saved_event_target = idzarshin_trib_2 }
				event_target:idzarshin_trib_2 = {
					ROOT = {
						set_variable = { which = totalkaratribDev2 value = 0 }
						export_to_variable = { which = tempkaratriDev2 value = total_development who = PREV }
						change_variable = { which = totalkaratribDev2 which = tempkaratriDev2 }
						multiply_variable = { which = totalkaratribDev2 value = 2 }
					}
				}
			}
			if = {
				limit = { has_saved_event_target = idzarshin_trib_3 }
				event_target:idzarshin_trib_3 = {
					ROOT = {
						set_variable = { which = totalkaratribDev3 value = 0 }
						export_to_variable = { which = tempkaratriDev3 value = total_development who = PREV }
						change_variable = { which = totalkaratribDev3 which = tempkaratriDev3 }
						multiply_variable = { which = totalkaratribDev3 value = 2 }
					}
				}
			}
			if = {
				limit = { has_saved_event_target = idzarshin_trib_4 }
				event_target:idzarshin_trib_4 = {
					ROOT = {
						set_variable = { which = totalkaratribDev4 value = 0 }
						export_to_variable = { which = tempkaratriDev4 value = total_development who = PREV }
						change_variable = { which = totalkaratribDev4 which = tempkaratriDev4 }
						multiply_variable = { which = totalkaratribDev4 value = 2 }
					}
				}
			}
			if = {
				limit = { has_saved_event_target = idzarshin_trib_5 }
				event_target:idzarshin_trib_5 = {
					ROOT = {
						set_variable = { which = totalkaratribDev5 value = 0 }
						export_to_variable = { which = tempkaratriDev5 value = total_development who = PREV }
						change_variable = { which = totalkaratribDev5 which = tempkaratriDev5 }
						multiply_variable = { which = totalkaratribDev5 value = 2 }
					}
				}
			}
			if = {
				limit = { has_saved_event_target = idzarshin_trib_6 }
				event_target:idzarshin_trib_6 = {
					ROOT = {
						set_variable = { which = totalkaratribDev6 value = 0 }
						export_to_variable = { which = tempkaratriDev6 value = total_development who = PREV }
						change_variable = { which = totalkaratribDev6 which = tempkaratriDev6 }
						multiply_variable = { which = totalkaratribDev6 value = 2 }
					}
				}
			}
			set_country_flag = L68_tribs_to_vass_menu
		}
	}

	option = { #Tributary 1
		name = flavour_karassk.101.a
		trigger = {
			dip_power = 600
			has_saved_event_target = idzarshin_trib_1
			event_target:idzarshin_trib_1 = {
				NOT = { liberty_desire = 50 }
			}
		}
		custom_tooltip = flavour_karassk.101.a.tooltip
		hidden_effect = {
			event_target:idzarshin_trib_1 = {
				ROOT = {
					while = { limit = { check_variable = { which = totalkaratribDev1 value = 1 } }
						add_dip_power = -1
						change_variable = { which = totalkaratribDev1 value = -1 }
					}
				}
			}
		}
		vassalize = event_target:idzarshin_trib_1
	}

	option = { #Tributary 2
		name = flavour_karassk.101.b
		trigger = {
			dip_power = 600
			has_saved_event_target = idzarshin_trib_2 
			event_target:idzarshin_trib_2 = {
				NOT = { liberty_desire = 50 }
			}
		}
		custom_tooltip = flavour_karassk.101.b.tooltip
		hidden_effect = {
			event_target:idzarshin_trib_2 = {
				ROOT = {
					while = { limit = { check_variable = { which = totalkaratribDev2 value = 1 } }
						add_dip_power = -1
						change_variable = { which = totalkaratribDev2 value = -1 }
					}
				}
			}
		}
		vassalize = event_target:idzarshin_trib_2
	}

	option = { #Tributary 3
		name = flavour_karassk.101.c
		trigger = {
			dip_power = 600
			has_saved_event_target = idzarshin_trib_3
			event_target:idzarshin_trib_3 = {
				NOT = { liberty_desire = 50 }
			}
		}
		custom_tooltip = flavour_karassk.101.c.tooltip
		hidden_effect = {
			event_target:idzarshin_trib_3 = {
				ROOT = {
					while = { limit = { check_variable = { which = totalkaratribDev3 value = 1 } }
						add_dip_power = -1
						change_variable = { which = totalkaratribDev3 value = -1 }
					}
				}
			}
		}
		vassalize = event_target:idzarshin_trib_3
	}

	option = { #Tributary 4
		name = flavour_karassk.101.d
		trigger = {
			dip_power = 600 
			has_saved_event_target = idzarshin_trib_4
			event_target:idzarshin_trib_4 = {
				NOT = { liberty_desire = 50 }
			}
		}
		custom_tooltip = flavour_karassk.101.d.tooltip
		hidden_effect = {
			event_target:idzarshin_trib_4 = {
				ROOT = {
					while = { limit = { check_variable = { which = totalkaratribDev4 value = 1 } }
						add_dip_power = -1
						change_variable = { which = totalkaratribDev4 value = -1 }
					}
				}
			}
		}
		vassalize = event_target:idzarshin_trib_4
	}

	option = { #Tributary 5
		name = flavour_karassk.101.e
		trigger = {
			dip_power = 600
			has_saved_event_target = idzarshin_trib_5
			event_target:idzarshin_trib_5 = {
				NOT = { liberty_desire = 50 }
			}
		}
		custom_tooltip = flavour_karassk.101.e.tooltip
		hidden_effect = {
			event_target:idzarshin_trib_5 = {
				ROOT = {
					while = { limit = { check_variable = { which = totalkaratribDev5 value = 1 } }
						add_dip_power = -1
						change_variable = { which = totalkaratribDev5 value = -1 }
					}
				}
			}
		}
		vassalize = event_target:idzarshin_trib_5
	}

	option = { #Tributary 6
		name = flavour_karassk.101.f
		trigger = {
			dip_power = 600
			has_saved_event_target = idzarshin_trib_6
			event_target:idzarshin_trib_6 = {
				NOT = { liberty_desire = 50 }
			}
		}
		custom_tooltip = flavour_karassk.101.f.tooltip
		hidden_effect = {
			event_target:idzarshin_trib_6 = {
				ROOT = {
					while = { limit = { check_variable = { which = totalkaratribDev6 value = 1 } }
						add_dip_power = -1
						change_variable = { which = totalkaratribDev6 value = -1 }
					}
				}
			}
		}
		vassalize = event_target:idzarshin_trib_6
	}

	option = { #Go back
		name = flavour_karassk.101.goback
		highlight = yes
	}

	after = {
		clr_country_flag = L68_tribs_to_vass_menu
	}
}

country_event = { #racism system biyearly check hidden event 
	id = flavour_karassk.1001
	title = flavour_karassk.101.t
	desc = flavour_karassk.101.desc
	picture = NUSANTARA_THRONE_eventPicture

	is_triggered_only = yes

	hidden = yes
	immediate = {
		#stuff for checking if human tolerance changes
		if = {
			limit = { 
				NOT = {
					medium_tolerance_human_race_trigger = yes
				}
				NOT = { has_country_flag = L68_was_not_coexisting }
			}
			set_country_flag = L68_was_not_coexisting
			clr_country_flag = L68_was_coexisting
			# downgrade the buffs
			every_owned_province = {
				limit = { 
					fast_has_pop_of_race = { race = human } 
				}
				#our land goods
				if = {
					limit = { 
						has_province_modifier = L68_khair_families_our_land_goods_co
					}
					remove_province_modifier = L68_khair_families_our_land_goods_co
					add_province_modifier = { name = L68_khair_families_our_land_goods_notco duration = -1 }
				}
				#our land cult
				if = {
					limit = { 
						has_province_modifier = L68_khair_families_our_land_cult_co
					}
					remove_province_modifier = L68_khair_families_our_land_cult_co
					add_province_modifier = { name = L68_khair_families_our_land_cult_notco duration = -1 }
				}
				#right to teach
				if = {
					limit = { 
						has_province_modifier = L68_khair_families_right_to_teach_co
					}
					remove_province_modifier = L68_khair_families_right_to_teach_co
					add_province_modifier = { name = L68_khair_families_right_to_teach_notco duration = -1 }
				}
				#management 
				if = {
					limit = { 
						has_province_modifier = L68_khair_families_iysashlagila_management_lanforce_co
					}
					remove_province_modifier = L68_khair_families_iysashlagila_management_lanforce_co
					add_province_modifier = { name = L68_khair_families_iysashlagila_management_lanforce_notco duration = -1 }
				}
				#halflingships
				if = {
					limit = { 
						has_province_modifier = L68_human_ships_halfling_sailors_ships_co
					}
					remove_province_modifier = L68_human_ships_halfling_sailors_ships_co
					add_province_modifier = { name = L68_human_ships_halfling_sailors_ships_notco duration = -1 }
				}
			}
		}
		else_if = {
			limit = {
				medium_tolerance_human_race_trigger = yes
				NOT = { has_country_flag = L68_was_coexisting }
			}
			set_country_flag = L68_was_coexisting
			clr_country_flag = L68_was_not_coexisting
			# upgrade the buffs
			every_owned_province = {
				limit = { 
					fast_has_pop_of_race = { race = human } 
				}
				#our land goods co
				if = {
					limit = { 
						has_province_modifier = L68_khair_families_our_land_goods_notco
					}
					remove_province_modifier = L68_khair_families_our_land_goods_notco
					add_province_modifier = { name = L68_khair_families_our_land_goods_co duration = -1 }
				}
				#our land cult co
				if = {
					limit = { 
						has_province_modifier = L68_khair_families_our_land_cult_notco
					}
					remove_province_modifier = L68_khair_families_our_land_cult_notco
					add_province_modifier = { name = L68_khair_families_our_land_cult_co duration = -1 }
				}
				#right to teach co
				if = {
					limit = { 
						has_province_modifier = L68_khair_families_right_to_teach_notco
					}
					remove_province_modifier = L68_khair_families_right_to_teach_notco
					add_province_modifier = { name = L68_khair_families_right_to_teach_co duration = -1 }
				}
				#managment co
				if = {
					limit = { 
						has_province_modifier = L68_khair_families_iysashlagila_management_lanforce_notco
					}
					remove_province_modifier = L68_khair_families_iysashlagila_management_lanforce_notco
					add_province_modifier = { name = L68_khair_families_iysashlagila_management_lanforce_co duration = -1 }
				}
				#halflingshipsco
				if = {
					limit = { 
						has_province_modifier = L68_human_ships_halfling_sailors_ships_notco
					}
					remove_province_modifier = L68_human_ships_halfling_sailors_ships_notco
					add_province_modifier = { name = L68_human_ships_halfling_sailors_ships_co duration = -1 }
				}
			}
		}
		#when human minority is created
		if = {
			limit = { 
				medium_tolerance_human_race_trigger = yes
			}
			every_owned_province = {
				limit = {
					has_human_minority_trigger = yes
				}
				#our land good co
				if = {
					limit = {
						NOT = {
							has_province_modifier = L68_khair_families_our_land_goods_notco
							has_province_modifier = L68_khair_families_our_land_goods_co
						}
						owner = { 
							has_estate_privilege = estate_burghers_khair_families_our_land
						}
						has_port = yes
					}	
					add_province_modifier = { name = L68_khair_families_our_land_goods_co duration = -1 }
				}
				#right to teach co
				if = {
					limit = {
						NOT = {
							has_province_modifier = L68_khair_families_right_to_teach_co
							has_province_modifier = L68_khair_families_right_to_teach_notco
						}
						owner = { 
							has_estate_privilege = estate_burghers_khair_families_the_right_to_teach
						}
					}
					add_province_modifier = { name = L68_khair_families_right_to_teach_co duration = -1 }
				}
				#managment co
				if = {
					limit = {
						NOT = {
							has_province_modifier = L68_khair_families_iysashlagila_management_lanforce_notco
							has_province_modifier = L68_khair_families_iysashlagila_management_lanforce_co
						}
						owner = { 
							has_estate_privilege = estate_burghers_khair_families_iysashlagila_management
						}
					}
					add_province_modifier = { name = L68_khair_families_iysashlagila_management_lanforce_co duration = -1 }
				}
				#halfship co
				if = {
					limit = {
						NOT = {
							has_province_modifier = L68_human_ships_halfling_sailors_ships_notco
							has_province_modifier = L68_human_ships_halfling_sailors_ships_co
						}
						owner = { 
							has_estate_privilege = estate_burghers_khair_families_human_ships_halfling_sailors
						}
						has_port = yes 
					}
					add_province_modifier = { name = L68_human_ships_halfling_sailors_ships_co duration = -1 }
				}
			}
		}
		else = {
			every_owned_province = {
				limit = {
					has_human_minority_trigger = yes
				}
				#our land good
				if = {
					limit = {
						NOT = {
							has_province_modifier = L68_khair_families_our_land_goods_notco
							has_province_modifier = L68_khair_families_our_land_goods_co
						}
						owner = { 
							has_estate_privilege = estate_burghers_khair_families_our_land
						}
						has_port = yes
					}
					add_province_modifier = { name = L68_khair_families_our_land_goods_notco duration = -1 }
				}
				#right to teach
				if = {
					limit = {
						NOT = {
							has_province_modifier = L68_khair_families_right_to_teach_co
							has_province_modifier = L68_khair_families_right_to_teach_notco
						}
						owner = { 
							has_estate_privilege = estate_burghers_khair_families_the_right_to_teach
						}
					}
					add_province_modifier = { name = L68_khair_families_right_to_teach_notco duration = -1 }
				}
				#managment
				if = {
					limit = {
						NOT = {
							has_province_modifier = L68_khair_families_iysashlagila_management_lanforce_notco
							has_province_modifier = L68_khair_families_iysashlagila_management_lanforce_co
						}
						owner = { 
							has_estate_privilege = estate_burghers_khair_families_iysashlagila_management
						}
					}
					add_province_modifier = { name = L68_khair_families_iysashlagila_management_lanforce_notco duration = -1 }
				}
				#halfship
				if = {
					limit = {
						NOT = {
							has_province_modifier = L68_human_ships_halfling_sailors_ships_notco
							has_province_modifier = L68_human_ships_halfling_sailors_ships_co
						}
						owner = { 
							has_estate_privilege = estate_burghers_khair_families_human_ships_halfling_sailors
						}
						has_port = yes 
					}
					add_province_modifier = { name = L68_human_ships_halfling_sailors_ships_notco duration = -1 }
				}
			}
		}

		# handle minorities that have disappeared
		# (majorities and minority->majority are covered by on_province_culture_changed)
		every_owned_province = {
			limit = {
				NOT = { fast_has_pop_of_race = { race = human } }
				OR = {
					# any human pop
					has_province_modifier = L68_khair_families_right_to_teach_co
					has_province_modifier = L68_khair_families_right_to_teach_notco

					has_province_modifier = L68_khair_families_iysashlagila_management_lanforce_co
					has_province_modifier = L68_khair_families_iysashlagila_management_lanforce_notco
						
					# specifically minority pops
					has_province_modifier = L68_human_ships_halfling_sailors_ships_co
					has_province_modifier = L68_human_ships_halfling_sailors_ships_notco

					has_province_modifier = L68_khair_families_our_land_goods_co
					has_province_modifier = L68_khair_families_our_land_goods_notco
				}		
			}

			remove_province_modifier = L68_khair_families_right_to_teach_co
			remove_province_modifier = L68_khair_families_right_to_teach_notco

			remove_province_modifier = L68_khair_families_iysashlagila_management_lanforce_co
			remove_province_modifier = L68_khair_families_iysashlagila_management_lanforce_notco

			remove_province_modifier = L68_human_ships_halfling_sailors_ships_co
			remove_province_modifier = L68_human_ships_halfling_sailors_ships_notco

			remove_province_modifier = L68_khair_families_our_land_goods_co
			remove_province_modifier = L68_khair_families_our_land_goods_notco

		}
	}
	option = { #ai eyes only 

	}
}
