
namespace = transmutative_path

province_event = { #province level interaction stage 1
	id = transmutative_path.1
	title = transmutative_path.1.t
	desc = transmutative_path.1.d
	picture = BIG_STAR_IN_SKY_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = { owner = { set_country_flag = transmutative_path_infuse_chi_menu_open save_event_target_as = province_owner_target } }
	}
	option = { #back out
		name = transmutative_path.1.a
		highlight = yes
		hidden_effect = {
			owner = { clr_country_flag = transmutative_path_infuse_chi_menu_open }
		}
	}
	option = { #Build Chi Wellspring
		name = transmutative_path.1.b
		custom_tooltip = build_chi_wellspring_tt
		if = {
			limit = {
				province_has_no_chi_wellspring_trigger = yes
				NOT = {
					any_neighbor_province = {
						owned_by = event_target:province_owner_target
						province_has_chi_wellspring_trigger = yes
					}
				}
				NOT = { transmutative_path_infuse_province_trigger = yes }
				NOT = { is_capital = yes }
				development = 10
				owner = {
					treasury = 100
					adm_power = 25
					dip_power = 25
					mil_power = 25
				}
			}
			custom_tooltip = " " #Linebreak
			owner = {
				add_treasury = -100
				add_adm_power = -25
				add_dip_power = -25
				add_mil_power = -25
			}
			add_chi_wellspring_to_size = yes
		}
	}
	option = { #Change Trade Goods
		name = transmutative_path.1.c
		trigger = {
			owner = {
				OR = {
					culture_group = kai
					culture = naamjyut
					culture = antmvura
					is_or_was_tag = { tag = Y86 }
				}
			}
		}
		custom_tooltip = transmutative_path_change_trade_good_tt
		if = {
			limit = {
				transmutative_path_change_trade_good_trigger = yes
				transmutative_path_owner_has_chi_trigger = yes
				owner = { NOT = { has_country_modifier = trade_good_change_cd } }
			}
			custom_tooltip = " " #Linebreak
			transmutative_path_pay_chi_effect = yes
			transmutative_path_change_trade_good_effect = yes
			transmutative_path_destroy_chi_wellspring_to_size_effect = yes #edge case
			hidden_effect = {
				owner = {
					add_country_modifier = {
						name = trade_good_change_cd
						duration = 9125
						hidden = yes
					}
				}
			}
		}
	}

	option = { #Infuse Province
		name = transmutative_path.1.1
		custom_tooltip = infuse_province_tt
		if = {
			limit = {
				transmutative_path_infuse_province_trigger = yes
				transmutative_path_owner_has_chi_trigger = yes
			}
			province_event = { id = transmutative_path.2 }
		}
	}
	
	option = {
		name = transmutative_path_temples_for_warriors
		trigger = {
			owner = { has_church_aspect = transmutative_path_temples_for_warriors }
			has_province_flag = is_xia_origin
		}
		if = {
			limit = {
				owner = {
					church_power = 200
					NOT = {
						has_country_flag = xia_path_empowered_@ROOT
						has_country_flag = xia_path_enlightened_@ROOT
					}
				}
			}
			owner = { add_church_power = -200 }
			cultivate_province_xia_path = yes
		}
		else = {
			custom_tooltip = transmutative_path_200_chi_check_province_tt
			if = {
				limit = {
					owner = {
						NOT = {
							has_country_flag = xia_path_empowered_@ROOT
							has_country_flag = xia_path_enlightened_@ROOT
						}
					}
				}
				custom_tooltip = transmutative_path_empowered_yes_tt
			}
			else = { custom_tooltip = transmutative_path_empowered_no_tt }
		}
	}
	option = { #back out
		name = transmutative_path.1.a
		highlight = yes
		hidden_effect = {
			owner = { clr_country_flag = transmutative_path_infuse_chi_menu_open }
		}
	}
	after = {
		hidden_effect = { owner = { clr_country_flag = transmutative_path_infuse_chi_menu_open } }
	}
}

province_event = { #province level interaction stage 2
	id = transmutative_path.2
	title = transmutative_path.2.t
	desc = transmutative_path.2.d
	picture = BIG_STAR_IN_SKY_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = { owner = { set_country_flag = transmutative_path_infuse_trade_goods_menu_open } }
	}

	option = { #back out
		name = transmutative_path.2.a
		province_event = { id = transmutative_path.1 }
	}
	option = { #acts of hermitage
		name = transmutative_path_acts_of_hermitage
		trigger = {
			owner = {
				has_church_aspect = transmutative_path_acts_of_hermitage
			}
		}
		custom_tooltip = transmutative_path_pay_for_chi_preview
		hidden_effect = { transmutative_path_pay_chi_effect = yes }
		add_base_tax = 1
	}
	option = { #rememberance festival
		name = transmutative_path_rememberance_festival
		trigger = {
			owner = {
				has_church_aspect = transmutative_path_rememberance_festival
			}
		}
		custom_tooltip = transmutative_path_pay_for_chi_preview
		hidden_effect = { transmutative_path_pay_chi_effect = yes }
		add_unrest = -10
	}
	option = { #sponsor travelling libraries
		name = transmutative_path_sponsor_travelling_libraries
		trigger = {
			owner = {
				has_church_aspect = transmutative_path_sponsor_travelling_libraries
			}
		}
		custom_tooltip = transmutative_path_pay_for_chi_preview
		hidden_effect = { transmutative_path_pay_chi_effect = yes }
		add_next_institution_embracement = 15
	}
	option = { #meditation through labour
		name = transmutative_path_meditation_through_labour
		trigger = {
			owner = {
				has_church_aspect = transmutative_path_meditation_through_labour
			}
		}
		custom_tooltip = transmutative_path_pay_for_chi_preview
		hidden_effect = { transmutative_path_pay_chi_effect = yes }
		add_base_production = 1
	}
	option = { #fill the begging bowls
		name = transmutative_path_fill_the_begging_bowls
		trigger = {
			owner = {
				has_church_aspect = transmutative_path_fill_the_begging_bowls
			}
		}
		custom_tooltip = transmutative_path_pay_for_chi_preview
		hidden_effect = { transmutative_path_pay_chi_effect = yes }
		add_prosperity = 25
	}
	option = { #relive past lives
		name = transmutative_path_relive_past_lives
		trigger = {
			owner = {
				has_church_aspect = transmutative_path_relive_past_lives
			}
		}
		custom_tooltip = transmutative_path_pay_for_chi_preview
		hidden_effect = { transmutative_path_pay_chi_effect = yes }
		add_nationalism = -10
	}
	option = { #universal martial education
		name = transmutative_path_universal_martial_education
		trigger = {
			owner = {
				has_church_aspect = transmutative_path_universal_martial_education
			}
		}
		custom_tooltip = transmutative_path_pay_for_chi_preview
		hidden_effect = { transmutative_path_pay_chi_effect = yes }
		add_base_manpower = 1
	}
	option = { #leadership of hero-monks
		name = transmutative_path_leadership_of_hero_monks
		trigger = {
			owner = {
				has_church_aspect = transmutative_path_leadership_of_hero_monks
			}
			NOT = { has_province_modifier = transmutative_path_leadership_of_hero_monks_mod }
		}
		custom_tooltip = transmutative_path_pay_for_chi_preview
		hidden_effect = { transmutative_path_pay_chi_effect = yes }
		add_province_modifier = { name = transmutative_path_leadership_of_hero_monks_mod duration = 3650 }
	}
	option = { #hire sellsword monks
		name = transmutative_path_hire_sellsword_monks
		trigger = {
			owner = {
				has_church_aspect = transmutative_path_hire_sellsword_monks
			}
			NOT = { has_province_modifier = transmutative_path_hire_sellsword_monks_mod }
		}
		custom_tooltip = transmutative_path_pay_for_chi_preview
		hidden_effect = { transmutative_path_pay_chi_effect = yes }
		add_province_modifier = { name = transmutative_path_hire_sellsword_monks_mod duration = 3650 }
	}
	option = { #everything under heaven
		name = transmutative_path_everything_under_heaven
		trigger = {
			owner = {
				has_church_aspect = transmutative_path_everything_under_heaven
			}
			NOT = { has_province_modifier = transmutative_path_everything_under_heaven_mod }
		}
		custom_tooltip = transmutative_path_pay_for_chi_preview
		hidden_effect = { transmutative_path_pay_chi_effect = yes }
		add_province_modifier = { name = transmutative_path_everything_under_heaven_mod duration = 3650 }
	}
	option = { #through inaction, action
		name = transmutative_path_through_inaction_action
		trigger = {
			owner = {
				has_church_aspect = transmutative_path_through_inaction_action
			}
			NOT = { has_province_modifier = transmutative_path_through_inaction_action_mod }
		}
		custom_tooltip = transmutative_path_pay_for_chi_preview
		hidden_effect = { transmutative_path_pay_chi_effect = yes }
		add_province_modifier = { name = transmutative_path_through_inaction_action_mod duration = 3650 }
	}
	option = { #we all lift together
		name = transmutative_path_we_all_lift_together
		trigger = {
			owner = {
				has_church_aspect = transmutative_path_we_all_lift_together
			}
			NOT = { has_province_modifier = transmutative_path_we_all_lift_together_mod }
		}
		custom_tooltip = transmutative_path_pay_for_chi_preview
		hidden_effect = { transmutative_path_pay_chi_effect = yes }
		add_province_modifier = { name = transmutative_path_we_all_lift_together_mod duration = 3650 }
	}	
	option = { #the second ascension
		name = transmutative_path_the_second_ascension
		trigger = {
			owner = {
				has_church_aspect = transmutative_path_the_second_ascension
			}
		}
		add_prosperity = 10
		custom_tooltip = transmutative_path_pay_for_chi_preview
		hidden_effect = { transmutative_path_pay_chi_effect = yes }
		owner = { add_splendor = 5 }
	}
	option = { #sages of the misty mountains
		name = transmutative_path_sages_of_the_misty_mountains
		trigger = {
			owner = {
				has_church_aspect = transmutative_path_sages_of_the_misty_mountains
			}
			NOT = { has_province_modifier = transmutative_path_sages_of_the_misty_mountains_mod }
		}
		custom_tooltip = transmutative_path_pay_for_chi_preview
		hidden_effect = { transmutative_path_pay_chi_effect = yes }
		add_province_modifier = { name = transmutative_path_sages_of_the_misty_mountains_mod duration = 3650 }
	}
	option = { #back out
		name = transmutative_path.2.a
		province_event = { id = transmutative_path.1 }
	}
	after = {
		hidden_effect = { owner = { clr_country_flag = transmutative_path_infuse_trade_goods_menu_open } }
	}
}

province_event = { #For conquering a Chi Wellspring, destroy it unless conditions are right
	id = transmutative_path.3
	title = transmutative_path.3.t
	desc = transmutative_path.3.d
	picture = BIG_STAR_IN_SKY_eventPicture

	is_triggered_only = yes
	hidden = yes

	trigger = { province_has_chi_wellspring_trigger = yes }

	immediate = {
		owner = { save_event_target_as = province_owner_target }
		if = {
			limit = { owner = { mission_completed = tp_xiaken_bathed_chi } }
			add_province_modifier = { name = xiaken_bathed_chi_mod duration = -1 }
		}

		if = {
			limit = {
				OR = {
					owner = { NOT = { religion = transmutative_path } }
					any_neighbor_province = {
						owned_by = event_target:province_owner_target
						province_has_chi_wellspring_trigger = yes
					}
				}
			}
			transmutative_path_destroy_chi_wellspring_effect = { owner_scope = event_target:province_owner_target }
			owner = { country_event = { id = transmutative_path.4 } }
		}
	}

	option = {
		name = transmutative_path.3.a
	}
}

country_event = { #Chi Overload
	id = transmutative_path.4
	title = transmutative_path.4.t
	desc = transmutative_path.4.d
	picture = BIG_STAR_IN_SKY_eventPicture

	is_triggered_only = yes

	trigger = { religion = transmutative_path }

	option = {
		name = transmutative_path.4.a
		custom_tooltip = chi_overload_tt
	}
}

country_event = { #Minor Chi Overload
	id = transmutative_path.5
	title = transmutative_path.5.t
	desc = transmutative_path.5.d
	picture = BIG_STAR_IN_SKY_eventPicture

	is_triggered_only = yes

	trigger = { religion = transmutative_path }

	option = {
		name = transmutative_path.5.a
		custom_tooltip = minor_chi_overload_tt
	}
}